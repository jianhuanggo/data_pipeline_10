with
    experiment_byuser as (

        select `_last_updated`,
  `first_exposure_ts`,
  `device_id`,
  `experiment__name`,
  `experiment__namespace`,
  `experiment__salt`,
  `experiment__parameter_value`,
  `_id`
        from `hive_metastore`.`tubidw_dev`.`experiment_byuser`
        where 

    

        experiment__name
        in (
            select experiment__name
            from `hive_metastore`.`tubidw_dev`.`experiment_byuser`
            group by experiment__name
            having max(first_exposure_ts) >= '2024-01-01'

         and max(first_exposure_ts) < '2023-12-01')

        

    



    ),

    experiment_device_metric_daily as (

        select `_id`,
  `_last_updated`,
  `ds`,
  `device_id`,
  `platform`,
  `device_first_seen_ts`,
  `device_first_view_ts`,
  `segment_all`,
  `segment_viewers`,
  `segment_viewers_vod`,
  `segment_viewers_linear`,
  `segment_visitors_us`,
  `segment_visitors_mx`,
  `segment_visitors_ca`,
  `segment_new_viewers`,
  `segment_new_visitors`,
  `metric_sum__tvt`,
  `metric_sum__tvt__capped`,
  `metric_sum__tvt__capped_us`,
  `metric_sum__tvt__capped_mx`,
  `metric_sum__tvt__capped_ca`,
  `metric_sum__tvt__vod`,
  `metric_sum__tvt__vod_capped`,
  `metric_sum__tvt__vod_nap`,
  `metric_sum__tvt__vod_nap_capped`,
  `metric_sum__tvt__vod_movie`,
  `metric_sum__tvt__vod_series`,
  `metric_sum__tvt__vod_capped_series`,
  `metric_sum__tvt__vod_nap_movie`,
  `metric_sum__tvt__vod_nap_series`,
  `metric_sum__tvt__vod_ap_movie`,
  `metric_sum__tvt__vod_ap_capped_movie`,
  `metric_sum__tvt__vod_ap_series`,
  `metric_sum__tvt__linear`,
  `metric_sum__tvt__linear_capped`,
  `metric_sum__ad_breaks__vod`,
  `metric_sum__search`,
  `metric_sum__search__click_through`,
  `metric_sum__cast__sessions`,
  `metric_sum__visit`,
  `metric_sum__view__vod_completion_70p`,
  `metric_sum__view__vod_daily_active`,
  `metric_sum__revenue__gross`,
  `metric_sum__ad_impressions`,
  `metric_sum__tvt__vod_featured`,
  `metric_sum__tvt__vod_capped_featured`,
  `metric_sum__tvt__vod_movie_featured`,
  `metric_sum__tvt__vod_series_featured`,
  `metric_sum__tvt__vod_cast`,
  `metric_sum__tvt__vod_spanish`,
  `metric_sum__tvt__vod_capped_spanish`,
  `metric_sum__tvt__vod_search`,
  `metric_max__conversion`,
  `metric_max__conversion__5min`,
  `metric_max__conversion__vod`,
  `metric_max__conversion__vod_5min`,
  `metric_max__conversion__linear`,
  `metric_max__conversion__linear_5min`,
  `metric_max__registration__did_signup`,
  `metric_max__registration__did_activate`,
  `metric_max__registration__did_authenticate`,
  `metric_max__search__did_search`,
  `metric_max__cast__did_cast`,
  `metric_sumgreaterthan__retention`,
  `metric_sumgreaterthan__retention__vod`,
  `metric_sumgreaterthan__retention__linear`,
  `metric_sumgreaterthan__aha_moment_conversion`,
  `metric_sum__player__exits`,
  `metric_sum__player__seeks`,
  `metric_max__power_viewers`,
  `metric_sum__tvt__vod_ymal`,
  `metric_max__conversion__20min`,
  `segment_new_visitors_d1`,
  `metric_sum__tvt__vod_ap`,
  `metric_sum__tvt__vod_ap_capped`,
  `segment_visitors_non_us`,
  `segment_new_visitors_non_us`,
  `metric_sum__tvt__capped_non_us`,
  `metric_sum__tvt__vod_cw`,
  `metric_sum__tvt__vod_capped_cw`,
  `metric_sum__tvt__vod_movie_cw`,
  `metric_sum__tvt__vod_series_cw`,
  `metric_sum__revenue__gross_unbudgeted`,
  `metric_sum__revenue__gross_budgeted`,
  `segment_new_visitors_d2`,
  `metric_sum__tvt__vod_cast_total`,
  `metric_sum__qualified_view_days`,
  `metric_sum__visit_days`,
  `metric_sum__add_to_queue`,
  `metric_sum__device_reactions`,
  `metric_max__conversion__series_5min`,
  `metric_max__conversion__movie_5min`,
  `metric_sum__revenue__gross_unclassified`,
  `metric_max__conversion__homepage_5min`,
  `metric_max__conversion__search_5min`,
  `metric_sum__tvt__scenes`,
  `metric_sum__tvt__scenes_capped`
        from `hive_metastore`.`tubidw_dev`.`experiment_device_metric_daily`
        where
            ds >= (select min(first_exposure_ts) - interval '14 day' from experiment_byuser)
            and ds < (select max(_last_updated) + interval '1 day' from experiment_byuser)

    ),

    experiment_byuser_audit as (

        select
            device_id,
            experiment__name,
            experiment__parameter_value,
            min(first_exposure_ts) as first_exposure_ts,
            max(_last_updated) as _last_updated
        from experiment_byuser
        group by 1, 2, 3

    ),

    valid_experiment_days as (

        select
            experiment__name,
            date_trunc('day', first_exposure_ts) as ds,
            count(distinct device_id) as per_day_new_device_count
        from experiment_byuser_audit
        group by 1, 2

    ),

    experiment_byuser_audit_filtered as (

        select distinct
            e.device_id,
            e.experiment__name,
            e.experiment__parameter_value,
            date_trunc('day', e.first_exposure_ts) as first_exposure_ds,
            min(e.first_exposure_ts) over (partition by e.experiment__name) as experiment_begin,
            max(e.first_exposure_ts) over (partition by e.experiment__name) as experiment_last_value,
            max(e._last_updated) over (partition by e.experiment__name) as _last_updated
        from experiment_byuser_audit as e
        where
            exists (
                -- only keep experiments days with more than 50 unique devices
                select 1
                from valid_experiment_days as d
                where
                    e.experiment__name = d.experiment__name
                    and date_trunc('day', e.first_exposure_ts) = d.ds
                    and d.per_day_new_device_count > 50
            )

    ),

    experiment_user_metrics as (

        select
            e.experiment__name,
            e.experiment__parameter_value,
            e.device_id,
            d.platform as platform_original,
            min(e.experiment_begin) as experiment_begin,
            max(e.experiment_last_value) as experiment_last_value,
            max(e._last_updated) as _last_date,
            -- [[ TABLE: experiment_metrics_wide; CTE: experiment_user_metrics; LOOP:
            -- segments; BEGIN ]]
            max(d.segment_all) as segment_all,
            max(CASE WHEN d.ds >=  e.first_exposure_ds THEN d.segment_new_viewers ELSE NULL END) as segment_new_viewers,  
            max(CASE WHEN d.ds >=  e.first_exposure_ds THEN d.segment_new_visitors ELSE NULL END)  as segment_new_visitors,  
            max(CASE WHEN d.ds >=  e.first_exposure_ds THEN d.segment_new_visitors_d1 ELSE NULL END) as segment_new_visitors_d1,  
            max(CASE WHEN d.ds >=  e.first_exposure_ds THEN d.segment_new_visitors_d2 ELSE NULL END) as segment_new_visitors_d2,  
            max(CASE WHEN d.ds >=  e.first_exposure_ds THEN d.segment_new_visitors_non_us ELSE NULL END) as segment_new_visitors_non_us,  
            max(CASE WHEN d.ds >=  e.first_exposure_ds THEN d.segment_viewers ELSE NULL END)as segment_viewers,  
            max(CASE WHEN d.ds >=  e.first_exposure_ds THEN d.segment_viewers_linear ELSE NULL END) as segment_viewers_linear,  
            max(CASE WHEN d.ds >=  e.first_exposure_ds THEN d.segment_viewers_vod ELSE NULL END)as segment_viewers_vod,  
            max(CASE WHEN d.ds >=  e.first_exposure_ds THEN d.segment_visitors_ca ELSE NULL END) as segment_visitors_ca,  
            max(CASE WHEN d.ds >=  e.first_exposure_ds THEN d.segment_visitors_mx ELSE NULL END)as segment_visitors_mx,  
            max(CASE WHEN d.ds >=  e.first_exposure_ds THEN d.segment_visitors_non_us ELSE NULL END)as segment_visitors_non_us,  
            max(CASE WHEN d.ds >=  e.first_exposure_ds THEN d.segment_visitors_us ELSE NULL END)as segment_visitors_us,
            -- [[ TABLE: experiment_metrics_wide; CTE: experiment_user_metrics; LOOP:
            -- segments; END ]]
            -- [[ TABLE: experiment_metrics_wide; CTE: experiment_user_metrics; LOOP:
            -- metrics; BEGIN ]]
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__tvt
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__tvt__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt else NULL end)::double
            as metric_sum__tvt__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__tvt__capped
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__tvt__capped__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__capped else NULL end)::double
            as metric_sum__tvt__capped__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__tvt__capped_us
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__tvt__capped_us__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__capped_us else NULL end)::double
            as metric_sum__tvt__capped_us__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__tvt__capped_mx
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__tvt__capped_mx__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__capped_mx else NULL end)::double
            as metric_sum__tvt__capped_mx__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__tvt__capped_ca
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__tvt__capped_ca__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__capped_ca else NULL end)::double
            as metric_sum__tvt__capped_ca__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__tvt__capped_non_us
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__tvt__capped_non_us__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__capped_non_us else NULL end)::double
            as metric_sum__tvt__capped_non_us__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__tvt__vod
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__tvt__vod__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__vod else NULL end)::double
            as metric_sum__tvt__vod__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__tvt__vod_capped
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__tvt__vod_capped__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__vod_capped else NULL end)::double
            as metric_sum__tvt__vod_capped__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__tvt__vod_nap
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__tvt__vod_nap__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__vod_nap else NULL end)::double
            as metric_sum__tvt__vod_nap__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__tvt__vod_nap_capped
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__tvt__vod_nap_capped__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__vod_nap_capped else NULL end)::double
            as metric_sum__tvt__vod_nap_capped__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__tvt__vod_movie
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__tvt__vod_movie__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__vod_movie else NULL end)::double
            as metric_sum__tvt__vod_movie__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__tvt__vod_series
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__tvt__vod_series__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__vod_series else NULL end)::double
            as metric_sum__tvt__vod_series__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__tvt__vod_capped_series
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__tvt__vod_capped_series__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__vod_capped_series else NULL end)::double
            as metric_sum__tvt__vod_capped_series__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__tvt__vod_nap_movie
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__tvt__vod_nap_movie__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__vod_nap_movie else NULL end)::double
            as metric_sum__tvt__vod_nap_movie__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__tvt__vod_nap_series
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__tvt__vod_nap_series__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__vod_nap_series else NULL end)::double
            as metric_sum__tvt__vod_nap_series__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__tvt__vod_ap_movie
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__tvt__vod_ap_movie__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__vod_ap_movie else NULL end)::double
            as metric_sum__tvt__vod_ap_movie__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__tvt__vod_ap_capped_movie
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__tvt__vod_ap_capped_movie__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__vod_ap_capped_movie else NULL end)::double
            as metric_sum__tvt__vod_ap_capped_movie__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__tvt__vod_ap_series
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__tvt__vod_ap_series__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__vod_ap_series else NULL end)::double
            as metric_sum__tvt__vod_ap_series__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__tvt__vod_ap
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__tvt__vod_ap__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__vod_ap else NULL end)::double
            as metric_sum__tvt__vod_ap__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__tvt__vod_ap_capped
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__tvt__vod_ap_capped__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__vod_ap_capped else NULL end)::double
            as metric_sum__tvt__vod_ap_capped__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__tvt__linear
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__tvt__linear__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__linear else NULL end)::double
            as metric_sum__tvt__linear__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__tvt__linear_capped
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__tvt__linear_capped__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__linear_capped else NULL end)::double
            as metric_sum__tvt__linear_capped__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__tvt__scenes
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__tvt__scenes__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__scenes else NULL end)::double
            as metric_sum__tvt__scenes__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__tvt__scenes_capped
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__tvt__scenes_capped__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__scenes_capped else NULL end)::double
            as metric_sum__tvt__scenes_capped__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__ad_breaks__vod
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__ad_breaks__vod__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__ad_breaks__vod else NULL end)::double
            as metric_sum__ad_breaks__vod__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__search
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__search__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__search else NULL end)::double
            as metric_sum__search__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__search__click_through
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__search__click_through__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__search__click_through else NULL end)::double
            as metric_sum__search__click_through__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__cast__sessions
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__cast__sessions__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__cast__sessions else NULL end)::double
            as metric_sum__cast__sessions__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__visit
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__visit__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__visit else NULL end)::double
            as metric_sum__visit__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__view__vod_completion_70p
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__view__vod_completion_70p__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__view__vod_completion_70p else NULL end)::double
            as metric_sum__view__vod_completion_70p__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__view__vod_daily_active
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__view__vod_daily_active__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__view__vod_daily_active else NULL end)::double
            as metric_sum__view__vod_daily_active__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__qualified_view_days
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__qualified_view_days__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__qualified_view_days else NULL end)::double
            as metric_sum__qualified_view_days__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__visit_days
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__visit_days__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__visit_days else NULL end)::double
            as metric_sum__visit_days__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__add_to_queue
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__add_to_queue__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__add_to_queue else NULL end)::double
            as metric_sum__add_to_queue__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__revenue__gross
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__revenue__gross__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__revenue__gross else NULL end)::double
            as metric_sum__revenue__gross__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__revenue__gross_unbudgeted
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__revenue__gross_unbudgeted__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__revenue__gross_unbudgeted else NULL end)::double
            as metric_sum__revenue__gross_unbudgeted__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__revenue__gross_budgeted
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__revenue__gross_budgeted__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__revenue__gross_budgeted else NULL end)::double
            as metric_sum__revenue__gross_budgeted__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__revenue__gross_unclassified
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__revenue__gross_unclassified__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__revenue__gross_unclassified else NULL end)::double
            as metric_sum__revenue__gross_unclassified__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__ad_impressions
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__ad_impressions__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__ad_impressions else NULL end)::double
            as metric_sum__ad_impressions__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__tvt__vod_ymal
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__tvt__vod_ymal__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__vod_ymal else NULL end)::double
            as metric_sum__tvt__vod_ymal__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__tvt__vod_featured
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__tvt__vod_featured__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__vod_featured else NULL end)::double
            as metric_sum__tvt__vod_featured__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__tvt__vod_capped_featured
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__tvt__vod_capped_featured__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__vod_capped_featured else NULL end)::double
            as metric_sum__tvt__vod_capped_featured__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__tvt__vod_movie_featured
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__tvt__vod_movie_featured__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__vod_movie_featured else NULL end)::double
            as metric_sum__tvt__vod_movie_featured__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__tvt__vod_series_featured
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__tvt__vod_series_featured__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__vod_series_featured else NULL end)::double
            as metric_sum__tvt__vod_series_featured__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__tvt__vod_cw
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__tvt__vod_cw__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__vod_cw else NULL end)::double
            as metric_sum__tvt__vod_cw__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__tvt__vod_capped_cw
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__tvt__vod_capped_cw__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__vod_capped_cw else NULL end)::double
            as metric_sum__tvt__vod_capped_cw__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__tvt__vod_movie_cw
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__tvt__vod_movie_cw__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__vod_movie_cw else NULL end)::double
            as metric_sum__tvt__vod_movie_cw__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__tvt__vod_series_cw
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__tvt__vod_series_cw__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__vod_series_cw else NULL end)::double
            as metric_sum__tvt__vod_series_cw__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__tvt__vod_cast
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__tvt__vod_cast__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__vod_cast else NULL end)::double
            as metric_sum__tvt__vod_cast__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__tvt__vod_cast_total
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__tvt__vod_cast_total__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__vod_cast_total else NULL end)::double
            as metric_sum__tvt__vod_cast_total__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__tvt__vod_spanish
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__tvt__vod_spanish__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__vod_spanish else NULL end)::double
            as metric_sum__tvt__vod_spanish__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__tvt__vod_capped_spanish
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__tvt__vod_capped_spanish__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__vod_capped_spanish else NULL end)::double
            as metric_sum__tvt__vod_capped_spanish__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__tvt__vod_search
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__tvt__vod_search__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__vod_search else NULL end)::double
            as metric_sum__tvt__vod_search__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__player__exits
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__player__exits__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__player__exits else NULL end)::double
            as metric_sum__player__exits__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__player__seeks
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__player__seeks__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__player__seeks else NULL end)::double
            as metric_sum__player__seeks__metric_result,
            sum(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_sum__device_reactions
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_sum__device_reactions__metric_covariate,
            sum(case when d.ds >= e.first_exposure_ds then d.metric_sum__device_reactions else NULL end)::double
            as metric_sum__device_reactions__metric_result,
            max(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_max__conversion
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_max__conversion__metric_covariate,
            max(case when d.ds >= e.first_exposure_ds then d.metric_max__conversion else NULL end)::double
            as metric_max__conversion__metric_result,
            max(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_max__conversion__5min
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_max__conversion__5min__metric_covariate,
            max(case when d.ds >= e.first_exposure_ds then d.metric_max__conversion__5min else NULL end)::double
            as metric_max__conversion__5min__metric_result,
            max(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_max__conversion__20min
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_max__conversion__20min__metric_covariate,
            max(case when d.ds >= e.first_exposure_ds then d.metric_max__conversion__20min else NULL end)::double
            as metric_max__conversion__20min__metric_result,
            max(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_max__conversion__vod
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_max__conversion__vod__metric_covariate,
            max(case when d.ds >= e.first_exposure_ds then d.metric_max__conversion__vod else NULL end)::double
            as metric_max__conversion__vod__metric_result,
            max(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_max__conversion__vod_5min
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_max__conversion__vod_5min__metric_covariate,
            max(case when d.ds >= e.first_exposure_ds then d.metric_max__conversion__vod_5min else NULL end)::double
            as metric_max__conversion__vod_5min__metric_result,
            max(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_max__conversion__linear
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_max__conversion__linear__metric_covariate,
            max(case when d.ds >= e.first_exposure_ds then d.metric_max__conversion__linear else NULL end)::double
            as metric_max__conversion__linear__metric_result,
            max(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_max__conversion__linear_5min
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_max__conversion__linear_5min__metric_covariate,
            max(case when d.ds >= e.first_exposure_ds then d.metric_max__conversion__linear_5min else NULL end)::double
            as metric_max__conversion__linear_5min__metric_result,
            max(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_max__conversion__series_5min
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_max__conversion__series_5min__metric_covariate,
            max(case when d.ds >= e.first_exposure_ds then d.metric_max__conversion__series_5min else NULL end)::double
            as metric_max__conversion__series_5min__metric_result,
            max(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_max__conversion__movie_5min
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_max__conversion__movie_5min__metric_covariate,
            max(case when d.ds >= e.first_exposure_ds then d.metric_max__conversion__movie_5min else NULL end)::double
            as metric_max__conversion__movie_5min__metric_result,
            max(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_max__conversion__homepage_5min
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_max__conversion__homepage_5min__metric_covariate,
            max(case when d.ds >= e.first_exposure_ds then d.metric_max__conversion__homepage_5min else NULL end)::double
            as metric_max__conversion__homepage_5min__metric_result,
            max(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_max__conversion__search_5min
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_max__conversion__search_5min__metric_covariate,
            max(case when d.ds >= e.first_exposure_ds then d.metric_max__conversion__search_5min else NULL end)::double
            as metric_max__conversion__search_5min__metric_result,
            max(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_max__registration__did_signup
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_max__registration__did_signup__metric_covariate,
            max(case when d.ds >= e.first_exposure_ds then d.metric_max__registration__did_signup else NULL end)::double
            as metric_max__registration__did_signup__metric_result,
            max(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_max__registration__did_activate
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_max__registration__did_activate__metric_covariate,
            max(case when d.ds >= e.first_exposure_ds then d.metric_max__registration__did_activate else NULL end)::double
            as metric_max__registration__did_activate__metric_result,
            max(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_max__registration__did_authenticate
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_max__registration__did_authenticate__metric_covariate,
            max(
                case when d.ds >= e.first_exposure_ds then d.metric_max__registration__did_authenticate else NULL end
            )::double as metric_max__registration__did_authenticate__metric_result,
            max(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_max__search__did_search
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_max__search__did_search__metric_covariate,
            max(case when d.ds >= e.first_exposure_ds then d.metric_max__search__did_search else NULL end)::double
            as metric_max__search__did_search__metric_result,
            max(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_max__cast__did_cast
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_max__cast__did_cast__metric_covariate,
            max(case when d.ds >= e.first_exposure_ds then d.metric_max__cast__did_cast else NULL end)::double
            as metric_max__cast__did_cast__metric_result,
            max(
                case
                    when d.ds < e.first_exposure_ds
                    then d.metric_max__power_viewers
                    else (case when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0 end)
                end
            )::double as metric_max__power_viewers__metric_covariate,
            max(case when d.ds >= e.first_exposure_ds then d.metric_max__power_viewers else NULL end)::double
            as metric_max__power_viewers__metric_result,
            case
                when
                    (
                        sum(
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_sumgreaterthan__retention
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    )
                    > 1
                then 1
                when
                    (
                        sum(
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_sumgreaterthan__retention
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    )
                    is null
                then null
                else 0
            end::double as metric_sumgreaterthan__retention__metric_covariate,
            case
                when (sum(case when d.ds >= e.first_exposure_ds then d.metric_sumgreaterthan__retention else NULL end)) > 1
                then 1
                when
                    (sum(case when d.ds >= e.first_exposure_ds then d.metric_sumgreaterthan__retention else NULL end))
                    is null
                then null
                else 0
            end::double as metric_sumgreaterthan__retention__metric_result,
            case
                when
                    (
                        sum(
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_sumgreaterthan__retention__vod
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    )
                    > 1
                then 1
                when
                    (
                        sum(
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_sumgreaterthan__retention__vod
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    )
                    is null
                then null
                else 0
            end::double as metric_sumgreaterthan__retention__vod__metric_covariate,
            case
                when
                    (sum(case when d.ds >= e.first_exposure_ds then d.metric_sumgreaterthan__retention__vod else NULL end))
                    > 1
                then 1
                when
                    (sum(case when d.ds >= e.first_exposure_ds then d.metric_sumgreaterthan__retention__vod else NULL end))
                    is null
                then null
                else 0
            end::double as metric_sumgreaterthan__retention__vod__metric_result,
            case
                when
                    (
                        sum(
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_sumgreaterthan__retention__linear
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    )
                    > 1
                then 1
                when
                    (
                        sum(
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_sumgreaterthan__retention__linear
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    )
                    is null
                then null
                else 0
            end::double as metric_sumgreaterthan__retention__linear__metric_covariate,
            case
                when
                    (
                        sum(
                            case
                                when d.ds >= e.first_exposure_ds then d.metric_sumgreaterthan__retention__linear else NULL
                            end
                        )
                    )
                    > 1
                then 1
                when
                    (
                        sum(
                            case
                                when d.ds >= e.first_exposure_ds then d.metric_sumgreaterthan__retention__linear else NULL
                            end
                        )
                    )
                    is null
                then null
                else 0
            end::double as metric_sumgreaterthan__retention__linear__metric_result,
            case
                when
                    (
                        sum(
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_sumgreaterthan__aha_moment_conversion
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    )
                    > 1
                then 1
                when
                    (
                        sum(
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_sumgreaterthan__aha_moment_conversion
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    )
                    is null
                then null
                else 0
            end::double as metric_sumgreaterthan__aha_moment_conversion__metric_covariate,
            case
                when
                    (
                        sum(
                            case
                                when d.ds >= e.first_exposure_ds
                                then d.metric_sumgreaterthan__aha_moment_conversion
                                else NULL
                            end
                        )
                    )
                    > 1
                then 1
                when
                    (
                        sum(
                            case
                                when d.ds >= e.first_exposure_ds
                                then d.metric_sumgreaterthan__aha_moment_conversion
                                else NULL
                            end
                        )
                    )
                    is null
                then null
                else 0
            end::double as metric_sumgreaterthan__aha_moment_conversion__metric_result,
            case
                when
                    (
                        sum(
                            case
                                when d.segment_new_viewers = 1
                                then
                                    (
                                        case
                                            when d.ds < e.first_exposure_ds
                                            then d.metric_sumgreaterthan__retention
                                            else
                                                (
                                                    case
                                                        when
                                                            d.device_first_seen_ts
                                                            < e.first_exposure_ds - interval '14 day'
                                                        then 0
                                                    end
                                                )
                                        end
                                    )
                                else null
                            end
                        )
                    )
                    > 1
                then 1
                when
                    (
                        sum(
                            case
                                when d.segment_new_viewers = 1
                                then
                                    (
                                        case
                                            when d.ds < e.first_exposure_ds
                                            then d.metric_sumgreaterthan__retention
                                            else
                                                (
                                                    case
                                                        when
                                                            d.device_first_seen_ts
                                                            < e.first_exposure_ds - interval '14 day'
                                                        then 0
                                                    end
                                                )
                                        end
                                    )
                                else null
                            end
                        )
                    )
                    is null
                then null
                else 0
            end::double as metric_sumgreaterthan__retention__new_viewers__metric_covariate,
            case
                when
                    (
                        sum(
                            case
                                when d.segment_new_viewers = 1
                                then
                                    (
                                        case
                                            when d.ds >= e.first_exposure_ds
                                            then d.metric_sumgreaterthan__retention
                                            else NULL
                                        end
                                    )
                                else null
                            end
                        )
                    )
                    > 1
                then 1
                when
                    (
                        sum(
                            case
                                when d.segment_new_viewers = 1
                                then
                                    (
                                        case
                                            when d.ds >= e.first_exposure_ds
                                            then d.metric_sumgreaterthan__retention
                                            else NULL
                                        end
                                    )
                                else null
                            end
                        )
                    )
                    is null
                then null
                else 0
            end::double as metric_sumgreaterthan__retention__new_viewers__metric_result,
            max(
                case
                    when d.segment_new_visitors = 1
                    then
                        (
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_max__conversion
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    else null
                end
            )::double as metric_max__conversion__new_visitors__metric_covariate,
            max(
                case
                    when d.segment_new_visitors = 1
                    then (case when d.ds >= e.first_exposure_ds then d.metric_max__conversion else NULL end)
                    else null
                end
            )::double as metric_max__conversion__new_visitors__metric_result,
            max(
                case
                    when d.segment_new_visitors = 1
                    then
                        (
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_max__conversion__20min
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    else null
                end
            )::double as metric_max__conversion__20min__new_visitors__metric_covariate,
            max(
                case
                    when d.segment_new_visitors = 1
                    then (case when d.ds >= e.first_exposure_ds then d.metric_max__conversion__20min else NULL end)
                    else null
                end
            )::double as metric_max__conversion__20min__new_visitors__metric_result,
            max(
                case
                    when d.segment_new_visitors = 1
                    then
                        (
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_max__conversion__5min
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    else null
                end
            )::double as metric_max__conversion__5min__new_visitors__metric_covariate,
            max(
                case
                    when d.segment_new_visitors = 1
                    then (case when d.ds >= e.first_exposure_ds then d.metric_max__conversion__5min else NULL end)
                    else null
                end
            )::double as metric_max__conversion__5min__new_visitors__metric_result,
            max(
                case
                    when d.segment_new_visitors = 1
                    then
                        (
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_max__conversion__linear
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    else null
                end
            )::double as metric_max__conversion__linear__new_visitors__metric_covariate,
            max(
                case
                    when d.segment_new_visitors = 1
                    then (case when d.ds >= e.first_exposure_ds then d.metric_max__conversion__linear else NULL end)
                    else null
                end
            )::double as metric_max__conversion__linear__new_visitors__metric_result,
            max(
                case
                    when d.segment_new_visitors = 1
                    then
                        (
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_max__conversion__linear_5min
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    else null
                end
            )::double as metric_max__conversion__linear_5min__new_visitors__metric_covariate,
            max(
                case
                    when d.segment_new_visitors = 1
                    then (case when d.ds >= e.first_exposure_ds then d.metric_max__conversion__linear_5min else NULL end)
                    else null
                end
            )::double as metric_max__conversion__linear_5min__new_visitors__metric_result,
            max(
                case
                    when d.segment_new_visitors = 1
                    then
                        (
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_max__conversion__vod
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    else null
                end
            )::double as metric_max__conversion__vod__new_visitors__metric_covariate,
            max(
                case
                    when d.segment_new_visitors = 1
                    then (case when d.ds >= e.first_exposure_ds then d.metric_max__conversion__vod else NULL end)
                    else null
                end
            )::double as metric_max__conversion__vod__new_visitors__metric_result,
            max(
                case
                    when d.segment_new_visitors = 1
                    then
                        (
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_max__conversion__vod_5min
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    else null
                end
            )::double as metric_max__conversion__vod_5min__new_visitors__metric_covariate,
            max(
                case
                    when d.segment_new_visitors = 1
                    then (case when d.ds >= e.first_exposure_ds then d.metric_max__conversion__vod_5min else NULL end)
                    else null
                end
            )::double as metric_max__conversion__vod_5min__new_visitors__metric_result,
            max(
                case
                    when d.segment_new_visitors = 1
                    then
                        (
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_max__registration__did_activate
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    else null
                end
            )::double as metric_max__registration__did_activate__new_visitors__metric_covariate,
            max(
                case
                    when d.segment_new_visitors = 1
                    then
                        (case when d.ds >= e.first_exposure_ds then d.metric_max__registration__did_activate else NULL end)
                    else null
                end
            )::double as metric_max__registration__did_activate__new_visitors__metric_result,
            max(
                case
                    when d.segment_new_visitors = 1
                    then
                        (
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_max__registration__did_authenticate
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    else null
                end
            )::double as metric_max__registration__did_authenticate__new_visitors__metric_covariate,
            max(
                case
                    when d.segment_new_visitors = 1
                    then
                        (
                            case
                                when d.ds >= e.first_exposure_ds
                                then d.metric_max__registration__did_authenticate
                                else NULL
                            end
                        )
                    else null
                end
            )::double as metric_max__registration__did_authenticate__new_visitors__metric_result,
            max(
                case
                    when d.segment_new_visitors = 1
                    then
                        (
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_max__registration__did_signup
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    else null
                end
            )::double as metric_max__registration__did_signup__new_visitors__metric_covariate,
            max(
                case
                    when d.segment_new_visitors = 1
                    then (case when d.ds >= e.first_exposure_ds then d.metric_max__registration__did_signup else NULL end)
                    else null
                end
            )::double as metric_max__registration__did_signup__new_visitors__metric_result,
            sum(
                case
                    when d.segment_new_visitors = 1
                    then
                        (
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_sum__tvt__capped
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    else null
                end
            )::double as metric_sum__tvt__capped__new_visitors__metric_covariate,
            sum(
                case
                    when d.segment_new_visitors = 1
                    then (case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__capped else NULL end)
                    else null
                end
            )::double as metric_sum__tvt__capped__new_visitors__metric_result,
            sum(
                case
                    when d.segment_new_visitors = 1
                    then
                        (
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_sum__tvt__linear_capped
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    else null
                end
            )::double as metric_sum__tvt__linear_capped__new_visitors__metric_covariate,
            sum(
                case
                    when d.segment_new_visitors = 1
                    then (case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__linear_capped else NULL end)
                    else null
                end
            )::double as metric_sum__tvt__linear_capped__new_visitors__metric_result,
            sum(
                case
                    when d.segment_new_visitors = 1
                    then
                        (
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_sum__tvt__vod_capped
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    else null
                end
            )::double as metric_sum__tvt__vod_capped__new_visitors__metric_covariate,
            sum(
                case
                    when d.segment_new_visitors = 1
                    then (case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__vod_capped else NULL end)
                    else null
                end
            )::double as metric_sum__tvt__vod_capped__new_visitors__metric_result,
            sum(
                case
                    when d.segment_new_visitors = 1
                    then
                        (
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_sum__tvt__vod_nap_capped
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    else null
                end
            )::double as metric_sum__tvt__vod_nap_capped__new_visitors__metric_covariate,
            sum(
                case
                    when d.segment_new_visitors = 1
                    then (case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__vod_nap_capped else NULL end)
                    else null
                end
            )::double as metric_sum__tvt__vod_nap_capped__new_visitors__metric_result,
            case
                when
                    (
                        sum(
                            case
                                when d.segment_new_visitors = 1
                                then
                                    (
                                        case
                                            when d.ds < e.first_exposure_ds
                                            then d.metric_sumgreaterthan__aha_moment_conversion
                                            else
                                                (
                                                    case
                                                        when
                                                            d.device_first_seen_ts
                                                            < e.first_exposure_ds - interval '14 day'
                                                        then 0
                                                    end
                                                )
                                        end
                                    )
                                else null
                            end
                        )
                    )
                    > 1
                then 1
                when
                    (
                        sum(
                            case
                                when d.segment_new_visitors = 1
                                then
                                    (
                                        case
                                            when d.ds < e.first_exposure_ds
                                            then d.metric_sumgreaterthan__aha_moment_conversion
                                            else
                                                (
                                                    case
                                                        when
                                                            d.device_first_seen_ts
                                                            < e.first_exposure_ds - interval '14 day'
                                                        then 0
                                                    end
                                                )
                                        end
                                    )
                                else null
                            end
                        )
                    )
                    is null
                then null
                else 0
            end::double as metric_sumgreaterthan__aha_moment_conversion__new_visitors__metric_covariate,
            case
                when
                    (
                        sum(
                            case
                                when d.segment_new_visitors = 1
                                then
                                    (
                                        case
                                            when d.ds >= e.first_exposure_ds
                                            then d.metric_sumgreaterthan__aha_moment_conversion
                                            else NULL
                                        end
                                    )
                                else null
                            end
                        )
                    )
                    > 1
                then 1
                when
                    (
                        sum(
                            case
                                when d.segment_new_visitors = 1
                                then
                                    (
                                        case
                                            when d.ds >= e.first_exposure_ds
                                            then d.metric_sumgreaterthan__aha_moment_conversion
                                            else NULL
                                        end
                                    )
                                else null
                            end
                        )
                    )
                    is null
                then null
                else 0
            end::double as metric_sumgreaterthan__aha_moment_conversion__new_visitors__metric_result,
            max(
                case
                    when d.segment_new_visitors_d1 = 1
                    then
                        (
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_max__conversion__20min
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    else null
                end
            )::double as metric_max__conversion__20min__new_visitors_d1__metric_covariate,
            max(
                case
                    when d.segment_new_visitors_d1 = 1
                    then (case when d.ds >= e.first_exposure_ds then d.metric_max__conversion__20min else NULL end)
                    else null
                end
            )::double as metric_max__conversion__20min__new_visitors_d1__metric_result,
            max(
                case
                    when d.segment_new_visitors_d1 = 1
                    then
                        (
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_max__conversion__5min
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    else null
                end
            )::double as metric_max__conversion__5min__new_visitors_d1__metric_covariate,
            max(
                case
                    when d.segment_new_visitors_d1 = 1
                    then (case when d.ds >= e.first_exposure_ds then d.metric_max__conversion__5min else NULL end)
                    else null
                end
            )::double as metric_max__conversion__5min__new_visitors_d1__metric_result,
            max(
                case
                    when d.segment_new_visitors_d1 = 1
                    then
                        (
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_max__conversion__homepage_5min
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    else null
                end
            )::double as metric_max__conversion__homepage_5min__new_visitors_d1__metric_covariate,
            max(
                case
                    when d.segment_new_visitors_d1 = 1
                    then (case when d.ds >= e.first_exposure_ds then d.metric_max__conversion__homepage_5min else NULL end)
                    else null
                end
            )::double as metric_max__conversion__homepage_5min__new_visitors_d1__metric_result,
            max(
                case
                    when d.segment_new_visitors_d1 = 1
                    then
                        (
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_max__conversion__linear_5min
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    else null
                end
            )::double as metric_max__conversion__linear_5min__new_visitors_d1__metric_covariate,
            max(
                case
                    when d.segment_new_visitors_d1 = 1
                    then (case when d.ds >= e.first_exposure_ds then d.metric_max__conversion__linear_5min else NULL end)
                    else null
                end
            )::double as metric_max__conversion__linear_5min__new_visitors_d1__metric_result,
            max(
                case
                    when d.segment_new_visitors_d1 = 1
                    then
                        (
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_max__conversion__movie_5min
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    else null
                end
            )::double as metric_max__conversion__movie_5min__new_visitors_d1__metric_covariate,
            max(
                case
                    when d.segment_new_visitors_d1 = 1
                    then (case when d.ds >= e.first_exposure_ds then d.metric_max__conversion__movie_5min else NULL end)
                    else null
                end
            )::double as metric_max__conversion__movie_5min__new_visitors_d1__metric_result,
            max(
                case
                    when d.segment_new_visitors_d1 = 1
                    then
                        (
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_max__conversion__search_5min
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    else null
                end
            )::double as metric_max__conversion__search_5min__new_visitors_d1__metric_covariate,
            max(
                case
                    when d.segment_new_visitors_d1 = 1
                    then (case when d.ds >= e.first_exposure_ds then d.metric_max__conversion__search_5min else NULL end)
                    else null
                end
            )::double as metric_max__conversion__search_5min__new_visitors_d1__metric_result,
            max(
                case
                    when d.segment_new_visitors_d1 = 1
                    then
                        (
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_max__conversion__series_5min
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    else null
                end
            )::double as metric_max__conversion__series_5min__new_visitors_d1__metric_covariate,
            max(
                case
                    when d.segment_new_visitors_d1 = 1
                    then (case when d.ds >= e.first_exposure_ds then d.metric_max__conversion__series_5min else NULL end)
                    else null
                end
            )::double as metric_max__conversion__series_5min__new_visitors_d1__metric_result,
            max(
                case
                    when d.segment_new_visitors_d1 = 1
                    then
                        (
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_max__registration__did_authenticate
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    else null
                end
            )::double as metric_max__registration__did_authenticate__new_visitors_d1__metric_covariate,
            max(
                case
                    when d.segment_new_visitors_d1 = 1
                    then
                        (
                            case
                                when d.ds >= e.first_exposure_ds
                                then d.metric_max__registration__did_authenticate
                                else NULL
                            end
                        )
                    else null
                end
            )::double as metric_max__registration__did_authenticate__new_visitors_d1__metric_result,
            sum(
                case
                    when d.segment_new_visitors_d1 = 1
                    then
                        (
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_sum__add_to_queue
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    else null
                end
            )::double as metric_sum__add_to_queue__new_visitors_d1__metric_covariate,
            sum(
                case
                    when d.segment_new_visitors_d1 = 1
                    then (case when d.ds >= e.first_exposure_ds then d.metric_sum__add_to_queue else NULL end)
                    else null
                end
            )::double as metric_sum__add_to_queue__new_visitors_d1__metric_result,
            sum(
                case
                    when d.segment_new_visitors_d1 = 1
                    then
                        (
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_sum__device_reactions
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    else null
                end
            )::double as metric_sum__device_reactions__new_visitors_d1__metric_covariate,
            sum(
                case
                    when d.segment_new_visitors_d1 = 1
                    then (case when d.ds >= e.first_exposure_ds then d.metric_sum__device_reactions else NULL end)
                    else null
                end
            )::double as metric_sum__device_reactions__new_visitors_d1__metric_result,
            sum(
                case
                    when d.segment_new_visitors_d1 = 1
                    then
                        (
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_sum__revenue__gross
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    else null
                end
            )::double as metric_sum__revenue__gross__new_visitors_d1__metric_covariate,
            sum(
                case
                    when d.segment_new_visitors_d1 = 1
                    then (case when d.ds >= e.first_exposure_ds then d.metric_sum__revenue__gross else NULL end)
                    else null
                end
            )::double as metric_sum__revenue__gross__new_visitors_d1__metric_result,
            sum(
                case
                    when d.segment_new_visitors_d1 = 1
                    then
                        (
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_sum__revenue__gross_unbudgeted
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    else null
                end
            )::double as metric_sum__revenue__gross_unbudgeted__new_visitors_d1__metric_covariate,
            sum(
                case
                    when d.segment_new_visitors_d1 = 1
                    then (case when d.ds >= e.first_exposure_ds then d.metric_sum__revenue__gross_unbudgeted else NULL end)
                    else null
                end
            )::double as metric_sum__revenue__gross_unbudgeted__new_visitors_d1__metric_result,
            sum(
                case
                    when d.segment_new_visitors_d1 = 1
                    then
                        (
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_sum__tvt__capped
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    else null
                end
            )::double as metric_sum__tvt__capped__new_visitors_d1__metric_covariate,
            sum(
                case
                    when d.segment_new_visitors_d1 = 1
                    then (case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__capped else NULL end)
                    else null
                end
            )::double as metric_sum__tvt__capped__new_visitors_d1__metric_result,
            max(
                case
                    when d.segment_new_visitors_d2 = 1
                    then
                        (
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_max__conversion
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    else null
                end
            )::double as metric_max__conversion__new_visitors_d2__metric_covariate,
            max(
                case
                    when d.segment_new_visitors_d2 = 1
                    then (case when d.ds >= e.first_exposure_ds then d.metric_max__conversion else NULL end)
                    else null
                end
            )::double as metric_max__conversion__new_visitors_d2__metric_result,
            max(
                case
                    when d.segment_new_visitors_d2 = 1
                    then
                        (
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_max__conversion__5min
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    else null
                end
            )::double as metric_max__conversion__5min__new_visitors_d2__metric_covariate,
            max(
                case
                    when d.segment_new_visitors_d2 = 1
                    then (case when d.ds >= e.first_exposure_ds then d.metric_max__conversion__5min else NULL end)
                    else null
                end
            )::double as metric_max__conversion__5min__new_visitors_d2__metric_result,
            sum(
                case
                    when d.segment_new_visitors_d2 = 1
                    then
                        (
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_sum__tvt__capped
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    else null
                end
            )::double as metric_sum__tvt__capped__new_visitors_d2__metric_covariate,
            sum(
                case
                    when d.segment_new_visitors_d2 = 1
                    then (case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__capped else NULL end)
                    else null
                end
            )::double as metric_sum__tvt__capped__new_visitors_d2__metric_result,
            sum(
                case
                    when d.segment_new_visitors_non_us = 1
                    then
                        (
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_sum__tvt__capped_non_us
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    else null
                end
            )::double as metric_sum__tvt__capped_non_us__new_visitors_non_us__metric_covariate,
            sum(
                case
                    when d.segment_new_visitors_non_us = 1
                    then (case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__capped_non_us else NULL end)
                    else null
                end
            )::double as metric_sum__tvt__capped_non_us__new_visitors_non_us__metric_result,
            sum(
                case
                    when d.segment_viewers = 1
                    then
                        (
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_sum__tvt
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    else null
                end
            )::double as metric_sum__tvt__viewers__metric_covariate,
            sum(
                case
                    when d.segment_viewers = 1
                    then (case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt else NULL end)
                    else null
                end
            )::double as metric_sum__tvt__viewers__metric_result,
            sum(
                case
                    when d.segment_viewers = 1
                    then
                        (
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_sum__tvt__capped
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    else null
                end
            )::double as metric_sum__tvt__capped__viewers__metric_covariate,
            sum(
                case
                    when d.segment_viewers = 1
                    then (case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__capped else NULL end)
                    else null
                end
            )::double as metric_sum__tvt__capped__viewers__metric_result,
            case
                when
                    (
                        sum(
                            case
                                when d.segment_viewers = 1
                                then
                                    (
                                        case
                                            when d.ds < e.first_exposure_ds
                                            then d.metric_sumgreaterthan__retention
                                            else
                                                (
                                                    case
                                                        when
                                                            d.device_first_seen_ts
                                                            < e.first_exposure_ds - interval '14 day'
                                                        then 0
                                                    end
                                                )
                                        end
                                    )
                                else null
                            end
                        )
                    )
                    > 1
                then 1
                when
                    (
                        sum(
                            case
                                when d.segment_viewers = 1
                                then
                                    (
                                        case
                                            when d.ds < e.first_exposure_ds
                                            then d.metric_sumgreaterthan__retention
                                            else
                                                (
                                                    case
                                                        when
                                                            d.device_first_seen_ts
                                                            < e.first_exposure_ds - interval '14 day'
                                                        then 0
                                                    end
                                                )
                                        end
                                    )
                                else null
                            end
                        )
                    )
                    is null
                then null
                else 0
            end::double as metric_sumgreaterthan__retention__viewers__metric_covariate,
            case
                when
                    (
                        sum(
                            case
                                when d.segment_viewers = 1
                                then
                                    (
                                        case
                                            when d.ds >= e.first_exposure_ds
                                            then d.metric_sumgreaterthan__retention
                                            else NULL
                                        end
                                    )
                                else null
                            end
                        )
                    )
                    > 1
                then 1
                when
                    (
                        sum(
                            case
                                when d.segment_viewers = 1
                                then
                                    (
                                        case
                                            when d.ds >= e.first_exposure_ds
                                            then d.metric_sumgreaterthan__retention
                                            else NULL
                                        end
                                    )
                                else null
                            end
                        )
                    )
                    is null
                then null
                else 0
            end::double as metric_sumgreaterthan__retention__viewers__metric_result,
            case
                when
                    (
                        sum(
                            case
                                when d.segment_viewers_linear = 1
                                then
                                    (
                                        case
                                            when d.ds < e.first_exposure_ds
                                            then d.metric_sumgreaterthan__retention__linear
                                            else
                                                (
                                                    case
                                                        when
                                                            d.device_first_seen_ts
                                                            < e.first_exposure_ds - interval '14 day'
                                                        then 0
                                                    end
                                                )
                                        end
                                    )
                                else null
                            end
                        )
                    )
                    > 1
                then 1
                when
                    (
                        sum(
                            case
                                when d.segment_viewers_linear = 1
                                then
                                    (
                                        case
                                            when d.ds < e.first_exposure_ds
                                            then d.metric_sumgreaterthan__retention__linear
                                            else
                                                (
                                                    case
                                                        when
                                                            d.device_first_seen_ts
                                                            < e.first_exposure_ds - interval '14 day'
                                                        then 0
                                                    end
                                                )
                                        end
                                    )
                                else null
                            end
                        )
                    )
                    is null
                then null
                else 0
            end::double as metric_sumgreaterthan__retention__linear__viewers_linear__metric_covariate,
            case
                when
                    (
                        sum(
                            case
                                when d.segment_viewers_linear = 1
                                then
                                    (
                                        case
                                            when d.ds >= e.first_exposure_ds
                                            then d.metric_sumgreaterthan__retention__linear
                                            else NULL
                                        end
                                    )
                                else null
                            end
                        )
                    )
                    > 1
                then 1
                when
                    (
                        sum(
                            case
                                when d.segment_viewers_linear = 1
                                then
                                    (
                                        case
                                            when d.ds >= e.first_exposure_ds
                                            then d.metric_sumgreaterthan__retention__linear
                                            else NULL
                                        end
                                    )
                                else null
                            end
                        )
                    )
                    is null
                then null
                else 0
            end::double as metric_sumgreaterthan__retention__linear__viewers_linear__metric_result,
            sum(
                case
                    when d.segment_viewers_vod = 1
                    then
                        (
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_sum__view__vod_daily_active
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    else null
                end
            )::double as metric_sum__view__vod_daily_active__viewers_vod__metric_covariate,
            sum(
                case
                    when d.segment_viewers_vod = 1
                    then (case when d.ds >= e.first_exposure_ds then d.metric_sum__view__vod_daily_active else NULL end)
                    else null
                end
            )::double as metric_sum__view__vod_daily_active__viewers_vod__metric_result,
            case
                when
                    (
                        sum(
                            case
                                when d.segment_viewers_vod = 1
                                then
                                    (
                                        case
                                            when d.ds < e.first_exposure_ds
                                            then d.metric_sumgreaterthan__retention__vod
                                            else
                                                (
                                                    case
                                                        when
                                                            d.device_first_seen_ts
                                                            < e.first_exposure_ds - interval '14 day'
                                                        then 0
                                                    end
                                                )
                                        end
                                    )
                                else null
                            end
                        )
                    )
                    > 1
                then 1
                when
                    (
                        sum(
                            case
                                when d.segment_viewers_vod = 1
                                then
                                    (
                                        case
                                            when d.ds < e.first_exposure_ds
                                            then d.metric_sumgreaterthan__retention__vod
                                            else
                                                (
                                                    case
                                                        when
                                                            d.device_first_seen_ts
                                                            < e.first_exposure_ds - interval '14 day'
                                                        then 0
                                                    end
                                                )
                                        end
                                    )
                                else null
                            end
                        )
                    )
                    is null
                then null
                else 0
            end::double as metric_sumgreaterthan__retention__vod__viewers_vod__metric_covariate,
            case
                when
                    (
                        sum(
                            case
                                when d.segment_viewers_vod = 1
                                then
                                    (
                                        case
                                            when d.ds >= e.first_exposure_ds
                                            then d.metric_sumgreaterthan__retention__vod
                                            else NULL
                                        end
                                    )
                                else null
                            end
                        )
                    )
                    > 1
                then 1
                when
                    (
                        sum(
                            case
                                when d.segment_viewers_vod = 1
                                then
                                    (
                                        case
                                            when d.ds >= e.first_exposure_ds
                                            then d.metric_sumgreaterthan__retention__vod
                                            else NULL
                                        end
                                    )
                                else null
                            end
                        )
                    )
                    is null
                then null
                else 0
            end::double as metric_sumgreaterthan__retention__vod__viewers_vod__metric_result,
            sum(
                case
                    when d.segment_visitors_ca = 1
                    then
                        (
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_sum__tvt__capped_ca
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    else null
                end
            )::double as metric_sum__tvt__capped_ca__visitors_ca__metric_covariate,
            sum(
                case
                    when d.segment_visitors_ca = 1
                    then (case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__capped_ca else NULL end)
                    else null
                end
            )::double as metric_sum__tvt__capped_ca__visitors_ca__metric_result,
            sum(
                case
                    when d.segment_visitors_mx = 1
                    then
                        (
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_sum__tvt__capped_mx
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    else null
                end
            )::double as metric_sum__tvt__capped_mx__visitors_mx__metric_covariate,
            sum(
                case
                    when d.segment_visitors_mx = 1
                    then (case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__capped_mx else NULL end)
                    else null
                end
            )::double as metric_sum__tvt__capped_mx__visitors_mx__metric_result,
            sum(
                case
                    when d.segment_visitors_non_us = 1
                    then
                        (
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_sum__tvt__capped_non_us
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    else null
                end
            )::double as metric_sum__tvt__capped_non_us__visitors_non_us__metric_covariate,
            sum(
                case
                    when d.segment_visitors_non_us = 1
                    then (case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__capped_non_us else NULL end)
                    else null
                end
            )::double as metric_sum__tvt__capped_non_us__visitors_non_us__metric_result,
            sum(
                case
                    when d.segment_visitors_us = 1
                    then
                        (
                            case
                                when d.ds < e.first_exposure_ds
                                then d.metric_sum__tvt__capped_us
                                else
                                    (
                                        case
                                            when d.device_first_seen_ts < e.first_exposure_ds - interval '14 day' then 0
                                        end
                                    )
                            end
                        )
                    else null
                end
            )::double as metric_sum__tvt__capped_us__visitors_us__metric_covariate,
            sum(
                case
                    when d.segment_visitors_us = 1
                    then (case when d.ds >= e.first_exposure_ds then d.metric_sum__tvt__capped_us else NULL end)
                    else null
                end
            )::double as metric_sum__tvt__capped_us__visitors_us__metric_result

        -- [[ TABLE: experiment_metrics_wide; CTE: experiment_user_metrics; LOOP:
        -- metrics; END ]]
        from experiment_device_metric_daily as d

        inner join
            experiment_byuser_audit_filtered as e
            on d.device_id = e.device_id
            and d.ds > e.first_exposure_ds - interval '14 days'
            and d.ds <= e.experiment_last_value

        group by 1, 2, 3, 4

    ),

    experiment_user_metrics_stacked as (

        select *, platform_original as platform
        from experiment_user_metrics

        union all

        select *, 'ALL' as platform
        from experiment_user_metrics

    ),

    experiment_user_metrics_stacked_with_cuped_aggregates as (

        select
            *,
            -- [[ TABLE: experiment_metrics_wide; CTE:
            -- experiment_user_metrics_stacked_with_cuped_aggregates; LOOP: metrics;
            -- BEGIN ]]
            avg(metric_sum__tvt__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__before_covariate_average,
            avg(metric_sum__tvt__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__after_covariate_average,
            avg(metric_sum__tvt__capped__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__capped__before_covariate_average,
            avg(metric_sum__tvt__capped__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__capped__after_covariate_average,
            avg(metric_sum__tvt__capped_us__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__capped_us__before_covariate_average,
            avg(metric_sum__tvt__capped_us__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__capped_us__after_covariate_average,
            avg(metric_sum__tvt__capped_mx__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__capped_mx__before_covariate_average,
            avg(metric_sum__tvt__capped_mx__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__capped_mx__after_covariate_average,
            avg(metric_sum__tvt__capped_ca__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__capped_ca__before_covariate_average,
            avg(metric_sum__tvt__capped_ca__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__capped_ca__after_covariate_average,
            avg(metric_sum__tvt__capped_non_us__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__capped_non_us__before_covariate_average,
            avg(metric_sum__tvt__capped_non_us__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__capped_non_us__after_covariate_average,
            avg(metric_sum__tvt__vod__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__vod__before_covariate_average,
            avg(metric_sum__tvt__vod__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__vod__after_covariate_average,
            avg(metric_sum__tvt__vod_capped__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__vod_capped__before_covariate_average,
            avg(metric_sum__tvt__vod_capped__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__vod_capped__after_covariate_average,
            avg(metric_sum__tvt__vod_nap__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__vod_nap__before_covariate_average,
            avg(metric_sum__tvt__vod_nap__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__vod_nap__after_covariate_average,
            avg(metric_sum__tvt__vod_nap_capped__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_sum__tvt__vod_nap_capped__before_covariate_average,
            avg(metric_sum__tvt__vod_nap_capped__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__vod_nap_capped__after_covariate_average,
            avg(metric_sum__tvt__vod_movie__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__vod_movie__before_covariate_average,
            avg(metric_sum__tvt__vod_movie__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__vod_movie__after_covariate_average,
            avg(metric_sum__tvt__vod_series__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__vod_series__before_covariate_average,
            avg(metric_sum__tvt__vod_series__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__vod_series__after_covariate_average,
            avg(metric_sum__tvt__vod_capped_series__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_sum__tvt__vod_capped_series__before_covariate_average,
            avg(metric_sum__tvt__vod_capped_series__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_sum__tvt__vod_capped_series__after_covariate_average,
            avg(metric_sum__tvt__vod_nap_movie__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__vod_nap_movie__before_covariate_average,
            avg(metric_sum__tvt__vod_nap_movie__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__vod_nap_movie__after_covariate_average,
            avg(metric_sum__tvt__vod_nap_series__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_sum__tvt__vod_nap_series__before_covariate_average,
            avg(metric_sum__tvt__vod_nap_series__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__vod_nap_series__after_covariate_average,
            avg(metric_sum__tvt__vod_ap_movie__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__vod_ap_movie__before_covariate_average,
            avg(metric_sum__tvt__vod_ap_movie__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__vod_ap_movie__after_covariate_average,
            avg(metric_sum__tvt__vod_ap_capped_movie__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_sum__tvt__vod_ap_capped_movie__before_covariate_average,
            avg(metric_sum__tvt__vod_ap_capped_movie__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_sum__tvt__vod_ap_capped_movie__after_covariate_average,
            avg(metric_sum__tvt__vod_ap_series__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__vod_ap_series__before_covariate_average,
            avg(metric_sum__tvt__vod_ap_series__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__vod_ap_series__after_covariate_average,
            avg(metric_sum__tvt__vod_ap__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__vod_ap__before_covariate_average,
            avg(metric_sum__tvt__vod_ap__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__vod_ap__after_covariate_average,
            avg(metric_sum__tvt__vod_ap_capped__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__vod_ap_capped__before_covariate_average,
            avg(metric_sum__tvt__vod_ap_capped__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__vod_ap_capped__after_covariate_average,

            avg(metric_sum__tvt__linear__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__linear__before_covariate_average,
            avg(metric_sum__tvt__linear__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__linear__after_covariate_average,
            avg(metric_sum__tvt__linear_capped__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__linear_capped__before_covariate_average,
            avg(metric_sum__tvt__linear_capped__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__linear_capped__after_covariate_average,

            avg(metric_sum__tvt__scenes__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__scenes__before_covariate_average,
            avg(metric_sum__tvt__scenes__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__scenes__after_covariate_average,
            avg(metric_sum__tvt__scenes_capped__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__scenes_capped__before_covariate_average,
            avg(metric_sum__tvt__scenes_capped__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__scenes_capped__after_covariate_average,

            avg(metric_sum__ad_breaks__vod__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_sum__ad_breaks__vod__before_covariate_average,
            avg(metric_sum__ad_breaks__vod__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__ad_breaks__vod__after_covariate_average,
            avg(metric_sum__search__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_sum__search__before_covariate_average,
            avg(metric_sum__search__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__search__after_covariate_average,
            avg(metric_sum__search__click_through__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_sum__search__click_through__before_covariate_average,
            avg(metric_sum__search__click_through__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__search__click_through__after_covariate_average,
            avg(metric_sum__cast__sessions__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_sum__cast__sessions__before_covariate_average,
            avg(metric_sum__cast__sessions__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__cast__sessions__after_covariate_average,
            avg(metric_sum__visit__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_sum__visit__before_covariate_average,
            avg(metric_sum__visit__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__visit__after_covariate_average,
            avg(metric_sum__view__vod_completion_70p__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_sum__view__vod_completion_70p__before_covariate_average,
            avg(metric_sum__view__vod_completion_70p__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_sum__view__vod_completion_70p__after_covariate_average,
            avg(metric_sum__view__vod_daily_active__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_sum__view__vod_daily_active__before_covariate_average,
            avg(metric_sum__view__vod_daily_active__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_sum__view__vod_daily_active__after_covariate_average,
            avg(metric_sum__qualified_view_days__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_sum__qualified_view_days__before_covariate_average,
            avg(metric_sum__qualified_view_days__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__qualified_view_days__after_covariate_average,
            avg(metric_sum__visit_days__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_sum__visit_days__before_covariate_average,
            avg(metric_sum__visit_days__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__visit_days__after_covariate_average,
            avg(metric_sum__add_to_queue__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_sum__add_to_queue__before_covariate_average,
            avg(metric_sum__add_to_queue__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__add_to_queue__after_covariate_average,
            avg(metric_sum__revenue__gross__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_sum__revenue__gross__before_covariate_average,
            avg(metric_sum__revenue__gross__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__revenue__gross__after_covariate_average,
            avg(metric_sum__revenue__gross_unbudgeted__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_sum__revenue__gross_unbudgeted__before_covariate_average,
            avg(metric_sum__revenue__gross_unbudgeted__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_sum__revenue__gross_unbudgeted__after_covariate_average,
            avg(metric_sum__revenue__gross_budgeted__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_sum__revenue__gross_budgeted__before_covariate_average,
            avg(metric_sum__revenue__gross_budgeted__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_sum__revenue__gross_budgeted__after_covariate_average,
            avg(metric_sum__revenue__gross_unclassified__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_sum__revenue__gross_unclassified__before_covariate_average,
            avg(metric_sum__revenue__gross_unclassified__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_sum__revenue__gross_unclassified__after_covariate_average,
            avg(metric_sum__ad_impressions__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_sum__ad_impressions__before_covariate_average,
            avg(metric_sum__ad_impressions__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__ad_impressions__after_covariate_average,
            avg(metric_sum__tvt__vod_ymal__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__vod_ymal__before_covariate_average,
            avg(metric_sum__tvt__vod_ymal__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__vod_ymal__after_covariate_average,
            avg(metric_sum__tvt__vod_featured__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__vod_featured__before_covariate_average,
            avg(metric_sum__tvt__vod_featured__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__vod_featured__after_covariate_average,
            avg(metric_sum__tvt__vod_capped_featured__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_sum__tvt__vod_capped_featured__before_covariate_average,
            avg(metric_sum__tvt__vod_capped_featured__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_sum__tvt__vod_capped_featured__after_covariate_average,
            avg(metric_sum__tvt__vod_movie_featured__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_sum__tvt__vod_movie_featured__before_covariate_average,
            avg(metric_sum__tvt__vod_movie_featured__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_sum__tvt__vod_movie_featured__after_covariate_average,
            avg(metric_sum__tvt__vod_series_featured__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_sum__tvt__vod_series_featured__before_covariate_average,
            avg(metric_sum__tvt__vod_series_featured__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_sum__tvt__vod_series_featured__after_covariate_average,
            avg(metric_sum__tvt__vod_cw__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__vod_cw__before_covariate_average,
            avg(metric_sum__tvt__vod_cw__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__vod_cw__after_covariate_average,
            avg(metric_sum__tvt__vod_capped_cw__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__vod_capped_cw__before_covariate_average,
            avg(metric_sum__tvt__vod_capped_cw__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__vod_capped_cw__after_covariate_average,
            avg(metric_sum__tvt__vod_movie_cw__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__vod_movie_cw__before_covariate_average,
            avg(metric_sum__tvt__vod_movie_cw__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__vod_movie_cw__after_covariate_average,
            avg(metric_sum__tvt__vod_series_cw__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__vod_series_cw__before_covariate_average,
            avg(metric_sum__tvt__vod_series_cw__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__vod_series_cw__after_covariate_average,
            avg(metric_sum__tvt__vod_cast__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__vod_cast__before_covariate_average,
            avg(metric_sum__tvt__vod_cast__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__vod_cast__after_covariate_average,
            avg(metric_sum__tvt__vod_cast_total__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_sum__tvt__vod_cast_total__before_covariate_average,
            avg(metric_sum__tvt__vod_cast_total__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__vod_cast_total__after_covariate_average,
            avg(metric_sum__tvt__vod_spanish__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__vod_spanish__before_covariate_average,
            avg(metric_sum__tvt__vod_spanish__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__vod_spanish__after_covariate_average,
            avg(metric_sum__tvt__vod_capped_spanish__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_sum__tvt__vod_capped_spanish__before_covariate_average,
            avg(metric_sum__tvt__vod_capped_spanish__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_sum__tvt__vod_capped_spanish__after_covariate_average,
            avg(metric_sum__tvt__vod_search__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__vod_search__before_covariate_average,
            avg(metric_sum__tvt__vod_search__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__vod_search__after_covariate_average,
            avg(metric_sum__player__exits__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_sum__player__exits__before_covariate_average,
            avg(metric_sum__player__exits__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__player__exits__after_covariate_average,
            avg(metric_sum__player__seeks__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_sum__player__seeks__before_covariate_average,
            avg(metric_sum__player__seeks__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__player__seeks__after_covariate_average,
            avg(metric_sum__device_reactions__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_sum__device_reactions__before_covariate_average,
            avg(metric_sum__device_reactions__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__device_reactions__after_covariate_average,
            avg(metric_max__conversion__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_max__conversion__before_covariate_average,
            avg(metric_max__conversion__metric_result) over (partition by experiment__name, platform)::double
            as metric_max__conversion__after_covariate_average,
            avg(metric_max__conversion__5min__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_max__conversion__5min__before_covariate_average,
            avg(metric_max__conversion__5min__metric_result) over (partition by experiment__name, platform)::double
            as metric_max__conversion__5min__after_covariate_average,
            avg(metric_max__conversion__20min__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_max__conversion__20min__before_covariate_average,
            avg(metric_max__conversion__20min__metric_result) over (partition by experiment__name, platform)::double
            as metric_max__conversion__20min__after_covariate_average,
            avg(metric_max__conversion__vod__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_max__conversion__vod__before_covariate_average,
            avg(metric_max__conversion__vod__metric_result) over (partition by experiment__name, platform)::double
            as metric_max__conversion__vod__after_covariate_average,
            avg(metric_max__conversion__vod_5min__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__vod_5min__before_covariate_average,
            avg(metric_max__conversion__vod_5min__metric_result) over (partition by experiment__name, platform)::double
            as metric_max__conversion__vod_5min__after_covariate_average,
            avg(metric_max__conversion__linear__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_max__conversion__linear__before_covariate_average,
            avg(metric_max__conversion__linear__metric_result) over (partition by experiment__name, platform)::double
            as metric_max__conversion__linear__after_covariate_average,
            avg(metric_max__conversion__linear_5min__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__linear_5min__before_covariate_average,
            avg(metric_max__conversion__linear_5min__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__linear_5min__after_covariate_average,
            avg(metric_max__conversion__series_5min__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__series_5min__before_covariate_average,
            avg(metric_max__conversion__series_5min__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__series_5min__after_covariate_average,
            avg(metric_max__conversion__movie_5min__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__movie_5min__before_covariate_average,
            avg(metric_max__conversion__movie_5min__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__movie_5min__after_covariate_average,
            avg(metric_max__conversion__homepage_5min__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__homepage_5min__before_covariate_average,
            avg(metric_max__conversion__homepage_5min__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__homepage_5min__after_covariate_average,
            avg(metric_max__conversion__search_5min__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__search_5min__before_covariate_average,
            avg(metric_max__conversion__search_5min__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__search_5min__after_covariate_average,
            avg(metric_max__registration__did_signup__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_max__registration__did_signup__before_covariate_average,
            avg(metric_max__registration__did_signup__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_max__registration__did_signup__after_covariate_average,
            avg(metric_max__registration__did_activate__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_max__registration__did_activate__before_covariate_average,
            avg(metric_max__registration__did_activate__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_max__registration__did_activate__after_covariate_average,
            avg(metric_max__registration__did_authenticate__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_max__registration__did_authenticate__before_covariate_average,
            avg(metric_max__registration__did_authenticate__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_max__registration__did_authenticate__after_covariate_average,
            avg(metric_max__search__did_search__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_max__search__did_search__before_covariate_average,
            avg(metric_max__search__did_search__metric_result) over (partition by experiment__name, platform)::double
            as metric_max__search__did_search__after_covariate_average,
            avg(metric_max__cast__did_cast__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_max__cast__did_cast__before_covariate_average,
            avg(metric_max__cast__did_cast__metric_result) over (partition by experiment__name, platform)::double
            as metric_max__cast__did_cast__after_covariate_average,
            avg(metric_max__power_viewers__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_max__power_viewers__before_covariate_average,
            avg(metric_max__power_viewers__metric_result) over (partition by experiment__name, platform)::double
            as metric_max__power_viewers__after_covariate_average,
            avg(metric_sumgreaterthan__retention__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_sumgreaterthan__retention__before_covariate_average,
            avg(metric_sumgreaterthan__retention__metric_result) over (partition by experiment__name, platform)::double
            as metric_sumgreaterthan__retention__after_covariate_average,
            avg(metric_sumgreaterthan__retention__vod__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_sumgreaterthan__retention__vod__before_covariate_average,
            avg(metric_sumgreaterthan__retention__vod__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_sumgreaterthan__retention__vod__after_covariate_average,
            avg(metric_sumgreaterthan__retention__linear__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_sumgreaterthan__retention__linear__before_covariate_average,
            avg(metric_sumgreaterthan__retention__linear__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_sumgreaterthan__retention__linear__after_covariate_average,
            avg(metric_sumgreaterthan__aha_moment_conversion__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_sumgreaterthan__aha_moment_conversion__before_covariate_average,
            avg(metric_sumgreaterthan__aha_moment_conversion__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_sumgreaterthan__aha_moment_conversion__after_covariate_average,
            avg(metric_sumgreaterthan__retention__new_viewers__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_sumgreaterthan__retention__new_viewers__before_covariate_average,
            avg(metric_sumgreaterthan__retention__new_viewers__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_sumgreaterthan__retention__new_viewers__after_covariate_average,
            avg(metric_max__conversion__new_visitors__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__new_visitors__before_covariate_average,
            avg(metric_max__conversion__new_visitors__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__new_visitors__after_covariate_average,
            avg(metric_max__conversion__20min__new_visitors__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__20min__new_visitors__before_covariate_average,
            avg(metric_max__conversion__20min__new_visitors__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__20min__new_visitors__after_covariate_average,
            avg(metric_max__conversion__5min__new_visitors__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__5min__new_visitors__before_covariate_average,
            avg(metric_max__conversion__5min__new_visitors__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__5min__new_visitors__after_covariate_average,
            avg(metric_max__conversion__linear__new_visitors__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__linear__new_visitors__before_covariate_average,
            avg(metric_max__conversion__linear__new_visitors__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__linear__new_visitors__after_covariate_average,
            avg(metric_max__conversion__linear_5min__new_visitors__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__linear_5min__new_visitors__before_covariate_average,
            avg(metric_max__conversion__linear_5min__new_visitors__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__linear_5min__new_visitors__after_covariate_average,
            avg(metric_max__conversion__vod__new_visitors__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__vod__new_visitors__before_covariate_average,
            avg(metric_max__conversion__vod__new_visitors__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__vod__new_visitors__after_covariate_average,
            avg(metric_max__conversion__vod_5min__new_visitors__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__vod_5min__new_visitors__before_covariate_average,
            avg(metric_max__conversion__vod_5min__new_visitors__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__vod_5min__new_visitors__after_covariate_average,
            avg(metric_max__registration__did_activate__new_visitors__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_max__registration__did_activate__new_visitors__before_covariate_average,
            avg(metric_max__registration__did_activate__new_visitors__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_max__registration__did_activate__new_visitors__after_covariate_average,
            avg(metric_max__registration__did_authenticate__new_visitors__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_max__registration__did_authenticate__new_visitors__before_covariate_average,
            avg(metric_max__registration__did_authenticate__new_visitors__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_max__registration__did_authenticate__new_visitors__after_covariate_average,
            avg(metric_max__registration__did_signup__new_visitors__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_max__registration__did_signup__new_visitors__before_covariate_average,
            avg(metric_max__registration__did_signup__new_visitors__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_max__registration__did_signup__new_visitors__after_covariate_average,
            avg(metric_sum__tvt__capped__new_visitors__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_sum__tvt__capped__new_visitors__before_covariate_average,
            avg(metric_sum__tvt__capped__new_visitors__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_sum__tvt__capped__new_visitors__after_covariate_average,
            avg(metric_sum__tvt__linear_capped__new_visitors__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_sum__tvt__linear_capped__new_visitors__before_covariate_average,
            avg(metric_sum__tvt__linear_capped__new_visitors__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_sum__tvt__linear_capped__new_visitors__after_covariate_average,
            avg(metric_sum__tvt__vod_capped__new_visitors__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_sum__tvt__vod_capped__new_visitors__before_covariate_average,
            avg(metric_sum__tvt__vod_capped__new_visitors__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_sum__tvt__vod_capped__new_visitors__after_covariate_average,
            avg(metric_sum__tvt__vod_nap_capped__new_visitors__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_sum__tvt__vod_nap_capped__new_visitors__before_covariate_average,
            avg(metric_sum__tvt__vod_nap_capped__new_visitors__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_sum__tvt__vod_nap_capped__new_visitors__after_covariate_average,
            avg(metric_sumgreaterthan__aha_moment_conversion__new_visitors__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_sumgreaterthan__aha_moment_conversion__new_visitors__before_covariate_average,
            avg(metric_sumgreaterthan__aha_moment_conversion__new_visitors__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_sumgreaterthan__aha_moment_conversion__new_visitors__after_covariate_average,
            avg(metric_max__conversion__20min__new_visitors_d1__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__20min__new_visitors_d1__before_covariate_average,
            avg(metric_max__conversion__20min__new_visitors_d1__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__20min__new_visitors_d1__after_covariate_average,
            avg(metric_max__conversion__5min__new_visitors_d1__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__5min__new_visitors_d1__before_covariate_average,
            avg(metric_max__conversion__5min__new_visitors_d1__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__5min__new_visitors_d1__after_covariate_average,
            avg(metric_max__conversion__homepage_5min__new_visitors_d1__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__homepage_5min__new_visitors_d1__before_covariate_average,
            avg(metric_max__conversion__homepage_5min__new_visitors_d1__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__homepage_5min__new_visitors_d1__after_covariate_average,
            avg(metric_max__conversion__linear_5min__new_visitors_d1__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__linear_5min__new_visitors_d1__before_covariate_average,
            avg(metric_max__conversion__linear_5min__new_visitors_d1__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__linear_5min__new_visitors_d1__after_covariate_average,
            avg(metric_max__conversion__movie_5min__new_visitors_d1__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__movie_5min__new_visitors_d1__before_covariate_average,
            avg(metric_max__conversion__movie_5min__new_visitors_d1__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__movie_5min__new_visitors_d1__after_covariate_average,
            avg(metric_max__conversion__search_5min__new_visitors_d1__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__search_5min__new_visitors_d1__before_covariate_average,
            avg(metric_max__conversion__search_5min__new_visitors_d1__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__search_5min__new_visitors_d1__after_covariate_average,
            avg(metric_max__conversion__series_5min__new_visitors_d1__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__series_5min__new_visitors_d1__before_covariate_average,
            avg(metric_max__conversion__series_5min__new_visitors_d1__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__series_5min__new_visitors_d1__after_covariate_average,
            avg(metric_max__registration__did_authenticate__new_visitors_d1__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_max__registration__did_authenticate__new_visitors_d1__before_covariate_average,
            avg(metric_max__registration__did_authenticate__new_visitors_d1__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_max__registration__did_authenticate__new_visitors_d1__after_covariate_average,
            avg(metric_sum__add_to_queue__new_visitors_d1__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_sum__add_to_queue__new_visitors_d1__before_covariate_average,
            avg(metric_sum__add_to_queue__new_visitors_d1__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_sum__add_to_queue__new_visitors_d1__after_covariate_average,
            avg(metric_sum__device_reactions__new_visitors_d1__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_sum__device_reactions__new_visitors_d1__before_covariate_average,
            avg(metric_sum__device_reactions__new_visitors_d1__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_sum__device_reactions__new_visitors_d1__after_covariate_average,
            avg(metric_sum__revenue__gross__new_visitors_d1__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_sum__revenue__gross__new_visitors_d1__before_covariate_average,
            avg(metric_sum__revenue__gross__new_visitors_d1__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_sum__revenue__gross__new_visitors_d1__after_covariate_average,
            avg(metric_sum__revenue__gross_unbudgeted__new_visitors_d1__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_sum__revenue__gross_unbudgeted__new_visitors_d1__before_covariate_average,
            avg(metric_sum__revenue__gross_unbudgeted__new_visitors_d1__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_sum__revenue__gross_unbudgeted__new_visitors_d1__after_covariate_average,
            avg(metric_sum__tvt__capped__new_visitors_d1__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_sum__tvt__capped__new_visitors_d1__before_covariate_average,
            avg(metric_sum__tvt__capped__new_visitors_d1__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_sum__tvt__capped__new_visitors_d1__after_covariate_average,
            avg(metric_max__conversion__new_visitors_d2__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__new_visitors_d2__before_covariate_average,
            avg(metric_max__conversion__new_visitors_d2__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__new_visitors_d2__after_covariate_average,
            avg(metric_max__conversion__5min__new_visitors_d2__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__5min__new_visitors_d2__before_covariate_average,
            avg(metric_max__conversion__5min__new_visitors_d2__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_max__conversion__5min__new_visitors_d2__after_covariate_average,
            avg(metric_sum__tvt__capped__new_visitors_d2__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_sum__tvt__capped__new_visitors_d2__before_covariate_average,
            avg(metric_sum__tvt__capped__new_visitors_d2__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_sum__tvt__capped__new_visitors_d2__after_covariate_average,
            avg(metric_sum__tvt__capped_non_us__new_visitors_non_us__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_sum__tvt__capped_non_us__new_visitors_non_us__before_covariate_average,
            avg(metric_sum__tvt__capped_non_us__new_visitors_non_us__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_sum__tvt__capped_non_us__new_visitors_non_us__after_covariate_average,
            avg(metric_sum__tvt__viewers__metric_covariate) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__viewers__before_covariate_average,
            avg(metric_sum__tvt__viewers__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__viewers__after_covariate_average,
            avg(metric_sum__tvt__capped__viewers__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_sum__tvt__capped__viewers__before_covariate_average,
            avg(metric_sum__tvt__capped__viewers__metric_result) over (partition by experiment__name, platform)::double
            as metric_sum__tvt__capped__viewers__after_covariate_average,
            avg(metric_sumgreaterthan__retention__viewers__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_sumgreaterthan__retention__viewers__before_covariate_average,
            avg(metric_sumgreaterthan__retention__viewers__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_sumgreaterthan__retention__viewers__after_covariate_average,
            avg(metric_sumgreaterthan__retention__linear__viewers_linear__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_sumgreaterthan__retention__linear__viewers_linear__before_covariate_average,
            avg(metric_sumgreaterthan__retention__linear__viewers_linear__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_sumgreaterthan__retention__linear__viewers_linear__after_covariate_average,
            avg(metric_sum__view__vod_daily_active__viewers_vod__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_sum__view__vod_daily_active__viewers_vod__before_covariate_average,
            avg(metric_sum__view__vod_daily_active__viewers_vod__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_sum__view__vod_daily_active__viewers_vod__after_covariate_average,
            avg(metric_sumgreaterthan__retention__vod__viewers_vod__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_sumgreaterthan__retention__vod__viewers_vod__before_covariate_average,
            avg(metric_sumgreaterthan__retention__vod__viewers_vod__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_sumgreaterthan__retention__vod__viewers_vod__after_covariate_average,
            avg(metric_sum__tvt__capped_ca__visitors_ca__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_sum__tvt__capped_ca__visitors_ca__before_covariate_average,
            avg(metric_sum__tvt__capped_ca__visitors_ca__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_sum__tvt__capped_ca__visitors_ca__after_covariate_average,
            avg(metric_sum__tvt__capped_mx__visitors_mx__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_sum__tvt__capped_mx__visitors_mx__before_covariate_average,
            avg(metric_sum__tvt__capped_mx__visitors_mx__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_sum__tvt__capped_mx__visitors_mx__after_covariate_average,
            avg(metric_sum__tvt__capped_non_us__visitors_non_us__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_sum__tvt__capped_non_us__visitors_non_us__before_covariate_average,
            avg(metric_sum__tvt__capped_non_us__visitors_non_us__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_sum__tvt__capped_non_us__visitors_non_us__after_covariate_average,
            avg(metric_sum__tvt__capped_us__visitors_us__metric_covariate) over (
                partition by experiment__name, platform
            )::double as metric_sum__tvt__capped_us__visitors_us__before_covariate_average,
            avg(metric_sum__tvt__capped_us__visitors_us__metric_result) over (
                partition by experiment__name, platform
            )::double as metric_sum__tvt__capped_us__visitors_us__after_covariate_average

        -- [[ TABLE: experiment_metrics_wide; CTE:
        -- experiment_user_metrics_stacked_with_cuped_aggregates; LOOP: metrics; END
        -- ]]
        from experiment_user_metrics_stacked

    ),

    cuped_theta as (

        select

            experiment__name,
            platform,
            -- [[ TABLE: experiment_metrics_wide; CTE: cuped_theta; LOOP: metrics;
            -- BEGIN ]]
            1.0 * sum(
                (metric_sum__tvt__metric_covariate - metric_sum__tvt__before_covariate_average)
                * (metric_sum__tvt__metric_result - metric_sum__tvt__after_covariate_average)
            )
            / (nullif(pow(stddev(metric_sum__tvt__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__tvt__theta,
            1.0 * sum(
                (metric_sum__tvt__capped__metric_covariate - metric_sum__tvt__capped__before_covariate_average)
                * (metric_sum__tvt__capped__metric_result - metric_sum__tvt__capped__after_covariate_average)
            )
            / (nullif(pow(stddev(metric_sum__tvt__capped__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__tvt__capped__theta,
            1.0 * sum(
                (metric_sum__tvt__capped_us__metric_covariate - metric_sum__tvt__capped_us__before_covariate_average)
                * (metric_sum__tvt__capped_us__metric_result - metric_sum__tvt__capped_us__after_covariate_average)
            )
            / (nullif(pow(stddev(metric_sum__tvt__capped_us__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__tvt__capped_us__theta,
            1.0 * sum(
                (metric_sum__tvt__capped_mx__metric_covariate - metric_sum__tvt__capped_mx__before_covariate_average)
                * (metric_sum__tvt__capped_mx__metric_result - metric_sum__tvt__capped_mx__after_covariate_average)
            )
            / (nullif(pow(stddev(metric_sum__tvt__capped_mx__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__tvt__capped_mx__theta,
            1.0 * sum(
                (metric_sum__tvt__capped_ca__metric_covariate - metric_sum__tvt__capped_ca__before_covariate_average)
                * (metric_sum__tvt__capped_ca__metric_result - metric_sum__tvt__capped_ca__after_covariate_average)
            )
            / (nullif(pow(stddev(metric_sum__tvt__capped_ca__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__tvt__capped_ca__theta,
            1.0 * sum(
                (
                    metric_sum__tvt__capped_non_us__metric_covariate
                    - metric_sum__tvt__capped_non_us__before_covariate_average
                ) * (
                    metric_sum__tvt__capped_non_us__metric_result
                    - metric_sum__tvt__capped_non_us__after_covariate_average
                )
            )
            / (nullif(pow(stddev(metric_sum__tvt__capped_non_us__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__tvt__capped_non_us__theta,
            1.0 * sum(
                (metric_sum__tvt__vod__metric_covariate - metric_sum__tvt__vod__before_covariate_average)
                * (metric_sum__tvt__vod__metric_result - metric_sum__tvt__vod__after_covariate_average)
            )
            / (nullif(pow(stddev(metric_sum__tvt__vod__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__tvt__vod__theta,
            1.0 * sum(
                (metric_sum__tvt__vod_capped__metric_covariate - metric_sum__tvt__vod_capped__before_covariate_average)
                * (metric_sum__tvt__vod_capped__metric_result - metric_sum__tvt__vod_capped__after_covariate_average)
            )
            / (nullif(pow(stddev(metric_sum__tvt__vod_capped__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__tvt__vod_capped__theta,
            1.0 * sum(
                (metric_sum__tvt__vod_nap__metric_covariate - metric_sum__tvt__vod_nap__before_covariate_average)
                * (metric_sum__tvt__vod_nap__metric_result - metric_sum__tvt__vod_nap__after_covariate_average)
            )
            / (nullif(pow(stddev(metric_sum__tvt__vod_nap__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__tvt__vod_nap__theta,
            1.0 * sum(
                (
                    metric_sum__tvt__vod_nap_capped__metric_covariate
                    - metric_sum__tvt__vod_nap_capped__before_covariate_average
                ) * (
                    metric_sum__tvt__vod_nap_capped__metric_result
                    - metric_sum__tvt__vod_nap_capped__after_covariate_average
                )
            )
            / (nullif(pow(stddev(metric_sum__tvt__vod_nap_capped__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__tvt__vod_nap_capped__theta,
            1.0 * sum(
                (metric_sum__tvt__vod_movie__metric_covariate - metric_sum__tvt__vod_movie__before_covariate_average)
                * (metric_sum__tvt__vod_movie__metric_result - metric_sum__tvt__vod_movie__after_covariate_average)
            )
            / (nullif(pow(stddev(metric_sum__tvt__vod_movie__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__tvt__vod_movie__theta,
            1.0 * sum(
                (metric_sum__tvt__vod_series__metric_covariate - metric_sum__tvt__vod_series__before_covariate_average)
                * (metric_sum__tvt__vod_series__metric_result - metric_sum__tvt__vod_series__after_covariate_average)
            )
            / (nullif(pow(stddev(metric_sum__tvt__vod_series__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__tvt__vod_series__theta,
            1.0 * sum(
                (
                    metric_sum__tvt__vod_capped_series__metric_covariate
                    - metric_sum__tvt__vod_capped_series__before_covariate_average
                ) * (
                    metric_sum__tvt__vod_capped_series__metric_result
                    - metric_sum__tvt__vod_capped_series__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_sum__tvt__vod_capped_series__metric_covariate), 2), 0) * sum(segment_all)
            )::double as metric_sum__tvt__vod_capped_series__theta,
            1.0 * sum(
                (
                    metric_sum__tvt__vod_nap_movie__metric_covariate
                    - metric_sum__tvt__vod_nap_movie__before_covariate_average
                ) * (
                    metric_sum__tvt__vod_nap_movie__metric_result
                    - metric_sum__tvt__vod_nap_movie__after_covariate_average
                )
            )
            / (nullif(pow(stddev(metric_sum__tvt__vod_nap_movie__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__tvt__vod_nap_movie__theta,
            1.0 * sum(
                (
                    metric_sum__tvt__vod_nap_series__metric_covariate
                    - metric_sum__tvt__vod_nap_series__before_covariate_average
                ) * (
                    metric_sum__tvt__vod_nap_series__metric_result
                    - metric_sum__tvt__vod_nap_series__after_covariate_average
                )
            )
            / (nullif(pow(stddev(metric_sum__tvt__vod_nap_series__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__tvt__vod_nap_series__theta,
            1.0 * sum(
                (
                    metric_sum__tvt__vod_ap_movie__metric_covariate
                    - metric_sum__tvt__vod_ap_movie__before_covariate_average
                ) * (
                    metric_sum__tvt__vod_ap_movie__metric_result
                    - metric_sum__tvt__vod_ap_movie__after_covariate_average
                )
            )
            / (nullif(pow(stddev(metric_sum__tvt__vod_ap_movie__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__tvt__vod_ap_movie__theta,
            1.0 * sum(
                (
                    metric_sum__tvt__vod_ap_capped_movie__metric_covariate
                    - metric_sum__tvt__vod_ap_capped_movie__before_covariate_average
                ) * (
                    metric_sum__tvt__vod_ap_capped_movie__metric_result
                    - metric_sum__tvt__vod_ap_capped_movie__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_sum__tvt__vod_ap_capped_movie__metric_covariate), 2), 0) * sum(segment_all)
            )::double as metric_sum__tvt__vod_ap_capped_movie__theta,
            1.0 * sum(
                (
                    metric_sum__tvt__vod_ap_series__metric_covariate
                    - metric_sum__tvt__vod_ap_series__before_covariate_average
                ) * (
                    metric_sum__tvt__vod_ap_series__metric_result
                    - metric_sum__tvt__vod_ap_series__after_covariate_average
                )
            )
            / (nullif(pow(stddev(metric_sum__tvt__vod_ap_series__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__tvt__vod_ap_series__theta,
            1.0 * sum(
                (metric_sum__tvt__vod_ap__metric_covariate - metric_sum__tvt__vod_ap__before_covariate_average)
                * (metric_sum__tvt__vod_ap__metric_result - metric_sum__tvt__vod_ap__after_covariate_average)
            )
            / (nullif(pow(stddev(metric_sum__tvt__vod_ap__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__tvt__vod_ap__theta,
            1.0 * sum(
                (
                    metric_sum__tvt__vod_ap_capped__metric_covariate
                    - metric_sum__tvt__vod_ap_capped__before_covariate_average
                ) * (
                    metric_sum__tvt__vod_ap_capped__metric_result
                    - metric_sum__tvt__vod_ap_capped__after_covariate_average
                )
            )
            / (nullif(pow(stddev(metric_sum__tvt__vod_ap_capped__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__tvt__vod_ap_capped__theta,
            1.0 * sum(
                (metric_sum__tvt__linear__metric_covariate - metric_sum__tvt__linear__before_covariate_average)
                * (metric_sum__tvt__linear__metric_result - metric_sum__tvt__linear__after_covariate_average)
            )
            / (nullif(pow(stddev(metric_sum__tvt__linear__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__tvt__linear__theta,
            1.0 * sum(
                (
                    metric_sum__tvt__linear_capped__metric_covariate
                    - metric_sum__tvt__linear_capped__before_covariate_average
                ) * (
                    metric_sum__tvt__linear_capped__metric_result
                    - metric_sum__tvt__linear_capped__after_covariate_average
                )
            )
            / (nullif(pow(stddev(metric_sum__tvt__linear_capped__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__tvt__linear_capped__theta,

            1.0 * sum(
                (metric_sum__tvt__scenes__metric_covariate - metric_sum__tvt__scenes__before_covariate_average)
                * (metric_sum__tvt__scenes__metric_result - metric_sum__tvt__scenes__after_covariate_average)
            )
            / (nullif(pow(stddev(metric_sum__tvt__scenes__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__tvt__scenes__theta,
            1.0 * sum(
                (
                    metric_sum__tvt__scenes_capped__metric_covariate
                    - metric_sum__tvt__scenes_capped__before_covariate_average
                ) * (
                    metric_sum__tvt__scenes_capped__metric_result
                    - metric_sum__tvt__scenes_capped__after_covariate_average
                )
            )
            / (nullif(pow(stddev(metric_sum__tvt__scenes_capped__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__tvt__scenes_capped__theta,

            1.0 * sum(
                (metric_sum__ad_breaks__vod__metric_covariate - metric_sum__ad_breaks__vod__before_covariate_average)
                * (metric_sum__ad_breaks__vod__metric_result - metric_sum__ad_breaks__vod__after_covariate_average)
            )
            / (nullif(pow(stddev(metric_sum__ad_breaks__vod__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__ad_breaks__vod__theta,
            1.0 * sum(
                (metric_sum__search__metric_covariate - metric_sum__search__before_covariate_average)
                * (metric_sum__search__metric_result - metric_sum__search__after_covariate_average)
            )
            / (nullif(pow(stddev(metric_sum__search__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__search__theta,
            1.0 * sum(
                (
                    metric_sum__search__click_through__metric_covariate
                    - metric_sum__search__click_through__before_covariate_average
                ) * (
                    metric_sum__search__click_through__metric_result
                    - metric_sum__search__click_through__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_sum__search__click_through__metric_covariate), 2), 0) * sum(segment_all)
            )::double as metric_sum__search__click_through__theta,
            1.0 * sum(
                (metric_sum__cast__sessions__metric_covariate - metric_sum__cast__sessions__before_covariate_average)
                * (metric_sum__cast__sessions__metric_result - metric_sum__cast__sessions__after_covariate_average)
            )
            / (nullif(pow(stddev(metric_sum__cast__sessions__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__cast__sessions__theta,
            1.0 * sum(
                (metric_sum__visit__metric_covariate - metric_sum__visit__before_covariate_average)
                * (metric_sum__visit__metric_result - metric_sum__visit__after_covariate_average)
            )
            / (nullif(pow(stddev(metric_sum__visit__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__visit__theta,
            1.0 * sum(
                (
                    metric_sum__view__vod_completion_70p__metric_covariate
                    - metric_sum__view__vod_completion_70p__before_covariate_average
                ) * (
                    metric_sum__view__vod_completion_70p__metric_result
                    - metric_sum__view__vod_completion_70p__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_sum__view__vod_completion_70p__metric_covariate), 2), 0) * sum(segment_all)
            )::double as metric_sum__view__vod_completion_70p__theta,
            1.0 * sum(
                (
                    metric_sum__view__vod_daily_active__metric_covariate
                    - metric_sum__view__vod_daily_active__before_covariate_average
                ) * (
                    metric_sum__view__vod_daily_active__metric_result
                    - metric_sum__view__vod_daily_active__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_sum__view__vod_daily_active__metric_covariate), 2), 0) * sum(segment_all)
            )::double as metric_sum__view__vod_daily_active__theta,
            1.0 * sum(
                (
                    metric_sum__qualified_view_days__metric_covariate
                    - metric_sum__qualified_view_days__before_covariate_average
                ) * (
                    metric_sum__qualified_view_days__metric_result
                    - metric_sum__qualified_view_days__after_covariate_average
                )
            )
            / (nullif(pow(stddev(metric_sum__qualified_view_days__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__qualified_view_days__theta,
            1.0 * sum(
                (metric_sum__visit_days__metric_covariate - metric_sum__visit_days__before_covariate_average)
                * (metric_sum__visit_days__metric_result - metric_sum__visit_days__after_covariate_average)
            )
            / (nullif(pow(stddev(metric_sum__visit_days__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__visit_days__theta,
            1.0 * sum(
                (metric_sum__add_to_queue__metric_covariate - metric_sum__add_to_queue__before_covariate_average)
                * (metric_sum__add_to_queue__metric_result - metric_sum__add_to_queue__after_covariate_average)
            )
            / (nullif(pow(stddev(metric_sum__add_to_queue__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__add_to_queue__theta,
            1.0 * sum(
                (metric_sum__revenue__gross__metric_covariate - metric_sum__revenue__gross__before_covariate_average)
                * (metric_sum__revenue__gross__metric_result - metric_sum__revenue__gross__after_covariate_average)
            )
            / (nullif(pow(stddev(metric_sum__revenue__gross__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__revenue__gross__theta,
            1.0 * sum(
                (
                    metric_sum__revenue__gross_unbudgeted__metric_covariate
                    - metric_sum__revenue__gross_unbudgeted__before_covariate_average
                ) * (
                    metric_sum__revenue__gross_unbudgeted__metric_result
                    - metric_sum__revenue__gross_unbudgeted__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_sum__revenue__gross_unbudgeted__metric_covariate), 2), 0) * sum(segment_all)
            )::double as metric_sum__revenue__gross_unbudgeted__theta,
            1.0 * sum(
                (
                    metric_sum__revenue__gross_budgeted__metric_covariate
                    - metric_sum__revenue__gross_budgeted__before_covariate_average
                ) * (
                    metric_sum__revenue__gross_budgeted__metric_result
                    - metric_sum__revenue__gross_budgeted__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_sum__revenue__gross_budgeted__metric_covariate), 2), 0) * sum(segment_all)
            )::double as metric_sum__revenue__gross_budgeted__theta,
            1.0 * sum(
                (
                    metric_sum__revenue__gross_unclassified__metric_covariate
                    - metric_sum__revenue__gross_unclassified__before_covariate_average
                ) * (
                    metric_sum__revenue__gross_unclassified__metric_result
                    - metric_sum__revenue__gross_unclassified__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_sum__revenue__gross_unclassified__metric_covariate), 2), 0) * sum(segment_all)
            )::double as metric_sum__revenue__gross_unclassified__theta,
            1.0 * sum(
                (metric_sum__ad_impressions__metric_covariate - metric_sum__ad_impressions__before_covariate_average)
                * (metric_sum__ad_impressions__metric_result - metric_sum__ad_impressions__after_covariate_average)
            )
            / (nullif(pow(stddev(metric_sum__ad_impressions__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__ad_impressions__theta,
            1.0 * sum(
                (metric_sum__tvt__vod_ymal__metric_covariate - metric_sum__tvt__vod_ymal__before_covariate_average)
                * (metric_sum__tvt__vod_ymal__metric_result - metric_sum__tvt__vod_ymal__after_covariate_average)
            )
            / (nullif(pow(stddev(metric_sum__tvt__vod_ymal__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__tvt__vod_ymal__theta,
            1.0 * sum(
                (
                    metric_sum__tvt__vod_featured__metric_covariate
                    - metric_sum__tvt__vod_featured__before_covariate_average
                ) * (
                    metric_sum__tvt__vod_featured__metric_result
                    - metric_sum__tvt__vod_featured__after_covariate_average
                )
            )
            / (nullif(pow(stddev(metric_sum__tvt__vod_featured__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__tvt__vod_featured__theta,
            1.0 * sum(
                (
                    metric_sum__tvt__vod_capped_featured__metric_covariate
                    - metric_sum__tvt__vod_capped_featured__before_covariate_average
                ) * (
                    metric_sum__tvt__vod_capped_featured__metric_result
                    - metric_sum__tvt__vod_capped_featured__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_sum__tvt__vod_capped_featured__metric_covariate), 2), 0) * sum(segment_all)
            )::double as metric_sum__tvt__vod_capped_featured__theta,
            1.0 * sum(
                (
                    metric_sum__tvt__vod_movie_featured__metric_covariate
                    - metric_sum__tvt__vod_movie_featured__before_covariate_average
                ) * (
                    metric_sum__tvt__vod_movie_featured__metric_result
                    - metric_sum__tvt__vod_movie_featured__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_sum__tvt__vod_movie_featured__metric_covariate), 2), 0) * sum(segment_all)
            )::double as metric_sum__tvt__vod_movie_featured__theta,
            1.0 * sum(
                (
                    metric_sum__tvt__vod_series_featured__metric_covariate
                    - metric_sum__tvt__vod_series_featured__before_covariate_average
                ) * (
                    metric_sum__tvt__vod_series_featured__metric_result
                    - metric_sum__tvt__vod_series_featured__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_sum__tvt__vod_series_featured__metric_covariate), 2), 0) * sum(segment_all)
            )::double as metric_sum__tvt__vod_series_featured__theta,
            1.0 * sum(
                (metric_sum__tvt__vod_cw__metric_covariate - metric_sum__tvt__vod_cw__before_covariate_average)
                * (metric_sum__tvt__vod_cw__metric_result - metric_sum__tvt__vod_cw__after_covariate_average)
            )
            / (nullif(pow(stddev(metric_sum__tvt__vod_cw__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__tvt__vod_cw__theta,
            1.0 * sum(
                (
                    metric_sum__tvt__vod_capped_cw__metric_covariate
                    - metric_sum__tvt__vod_capped_cw__before_covariate_average
                ) * (
                    metric_sum__tvt__vod_capped_cw__metric_result
                    - metric_sum__tvt__vod_capped_cw__after_covariate_average
                )
            )
            / (nullif(pow(stddev(metric_sum__tvt__vod_capped_cw__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__tvt__vod_capped_cw__theta,
            1.0 * sum(
                (
                    metric_sum__tvt__vod_movie_cw__metric_covariate
                    - metric_sum__tvt__vod_movie_cw__before_covariate_average
                ) * (
                    metric_sum__tvt__vod_movie_cw__metric_result
                    - metric_sum__tvt__vod_movie_cw__after_covariate_average
                )
            )
            / (nullif(pow(stddev(metric_sum__tvt__vod_movie_cw__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__tvt__vod_movie_cw__theta,
            1.0 * sum(
                (
                    metric_sum__tvt__vod_series_cw__metric_covariate
                    - metric_sum__tvt__vod_series_cw__before_covariate_average
                ) * (
                    metric_sum__tvt__vod_series_cw__metric_result
                    - metric_sum__tvt__vod_series_cw__after_covariate_average
                )
            )
            / (nullif(pow(stddev(metric_sum__tvt__vod_series_cw__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__tvt__vod_series_cw__theta,
            1.0 * sum(
                (metric_sum__tvt__vod_cast__metric_covariate - metric_sum__tvt__vod_cast__before_covariate_average)
                * (metric_sum__tvt__vod_cast__metric_result - metric_sum__tvt__vod_cast__after_covariate_average)
            )
            / (nullif(pow(stddev(metric_sum__tvt__vod_cast__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__tvt__vod_cast__theta,
            1.0 * sum(
                (
                    metric_sum__tvt__vod_cast_total__metric_covariate
                    - metric_sum__tvt__vod_cast_total__before_covariate_average
                ) * (
                    metric_sum__tvt__vod_cast_total__metric_result
                    - metric_sum__tvt__vod_cast_total__after_covariate_average
                )
            )
            / (nullif(pow(stddev(metric_sum__tvt__vod_cast_total__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__tvt__vod_cast_total__theta,
            1.0 * sum(
                (
                    metric_sum__tvt__vod_spanish__metric_covariate
                    - metric_sum__tvt__vod_spanish__before_covariate_average
                )
                * (metric_sum__tvt__vod_spanish__metric_result - metric_sum__tvt__vod_spanish__after_covariate_average)
            )
            / (nullif(pow(stddev(metric_sum__tvt__vod_spanish__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__tvt__vod_spanish__theta,
            1.0 * sum(
                (
                    metric_sum__tvt__vod_capped_spanish__metric_covariate
                    - metric_sum__tvt__vod_capped_spanish__before_covariate_average
                ) * (
                    metric_sum__tvt__vod_capped_spanish__metric_result
                    - metric_sum__tvt__vod_capped_spanish__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_sum__tvt__vod_capped_spanish__metric_covariate), 2), 0) * sum(segment_all)
            )::double as metric_sum__tvt__vod_capped_spanish__theta,
            1.0 * sum(
                (metric_sum__tvt__vod_search__metric_covariate - metric_sum__tvt__vod_search__before_covariate_average)
                * (metric_sum__tvt__vod_search__metric_result - metric_sum__tvt__vod_search__after_covariate_average)
            )
            / (nullif(pow(stddev(metric_sum__tvt__vod_search__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__tvt__vod_search__theta,
            1.0 * sum(
                (metric_sum__player__exits__metric_covariate - metric_sum__player__exits__before_covariate_average)
                * (metric_sum__player__exits__metric_result - metric_sum__player__exits__after_covariate_average)
            )
            / (nullif(pow(stddev(metric_sum__player__exits__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__player__exits__theta,
            1.0 * sum(
                (metric_sum__player__seeks__metric_covariate - metric_sum__player__seeks__before_covariate_average)
                * (metric_sum__player__seeks__metric_result - metric_sum__player__seeks__after_covariate_average)
            )
            / (nullif(pow(stddev(metric_sum__player__seeks__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__player__seeks__theta,
            1.0 * sum(
                (
                    metric_sum__device_reactions__metric_covariate
                    - metric_sum__device_reactions__before_covariate_average
                )
                * (metric_sum__device_reactions__metric_result - metric_sum__device_reactions__after_covariate_average)
            )
            / (nullif(pow(stddev(metric_sum__device_reactions__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sum__device_reactions__theta,
            1.0 * sum(
                (metric_max__conversion__metric_covariate - metric_max__conversion__before_covariate_average)
                * (metric_max__conversion__metric_result - metric_max__conversion__after_covariate_average)
            )
            / (nullif(pow(stddev(metric_max__conversion__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_max__conversion__theta,
            1.0 * sum(
                (
                    metric_max__conversion__5min__metric_covariate
                    - metric_max__conversion__5min__before_covariate_average
                )
                * (metric_max__conversion__5min__metric_result - metric_max__conversion__5min__after_covariate_average)
            )
            / (nullif(pow(stddev(metric_max__conversion__5min__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_max__conversion__5min__theta,
            1.0 * sum(
                (
                    metric_max__conversion__20min__metric_covariate
                    - metric_max__conversion__20min__before_covariate_average
                ) * (
                    metric_max__conversion__20min__metric_result
                    - metric_max__conversion__20min__after_covariate_average
                )
            )
            / (nullif(pow(stddev(metric_max__conversion__20min__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_max__conversion__20min__theta,
            1.0 * sum(
                (metric_max__conversion__vod__metric_covariate - metric_max__conversion__vod__before_covariate_average)
                * (metric_max__conversion__vod__metric_result - metric_max__conversion__vod__after_covariate_average)
            )
            / (nullif(pow(stddev(metric_max__conversion__vod__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_max__conversion__vod__theta,
            1.0 * sum(
                (
                    metric_max__conversion__vod_5min__metric_covariate
                    - metric_max__conversion__vod_5min__before_covariate_average
                ) * (
                    metric_max__conversion__vod_5min__metric_result
                    - metric_max__conversion__vod_5min__after_covariate_average
                )
            )
            / (nullif(pow(stddev(metric_max__conversion__vod_5min__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_max__conversion__vod_5min__theta,
            1.0 * sum(
                (
                    metric_max__conversion__linear__metric_covariate
                    - metric_max__conversion__linear__before_covariate_average
                ) * (
                    metric_max__conversion__linear__metric_result
                    - metric_max__conversion__linear__after_covariate_average
                )
            )
            / (nullif(pow(stddev(metric_max__conversion__linear__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_max__conversion__linear__theta,
            1.0 * sum(
                (
                    metric_max__conversion__linear_5min__metric_covariate
                    - metric_max__conversion__linear_5min__before_covariate_average
                ) * (
                    metric_max__conversion__linear_5min__metric_result
                    - metric_max__conversion__linear_5min__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_max__conversion__linear_5min__metric_covariate), 2), 0) * sum(segment_all)
            )::double as metric_max__conversion__linear_5min__theta,
            1.0 * sum(
                (
                    metric_max__conversion__series_5min__metric_covariate
                    - metric_max__conversion__series_5min__before_covariate_average
                ) * (
                    metric_max__conversion__series_5min__metric_result
                    - metric_max__conversion__series_5min__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_max__conversion__series_5min__metric_covariate), 2), 0) * sum(segment_all)
            )::double as metric_max__conversion__series_5min__theta,
            1.0 * sum(
                (
                    metric_max__conversion__movie_5min__metric_covariate
                    - metric_max__conversion__movie_5min__before_covariate_average
                ) * (
                    metric_max__conversion__movie_5min__metric_result
                    - metric_max__conversion__movie_5min__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_max__conversion__movie_5min__metric_covariate), 2), 0) * sum(segment_all)
            )::double as metric_max__conversion__movie_5min__theta,
            1.0 * sum(
                (
                    metric_max__conversion__homepage_5min__metric_covariate
                    - metric_max__conversion__homepage_5min__before_covariate_average
                ) * (
                    metric_max__conversion__homepage_5min__metric_result
                    - metric_max__conversion__homepage_5min__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_max__conversion__homepage_5min__metric_covariate), 2), 0) * sum(segment_all)
            )::double as metric_max__conversion__homepage_5min__theta,
            1.0 * sum(
                (
                    metric_max__conversion__search_5min__metric_covariate
                    - metric_max__conversion__search_5min__before_covariate_average
                ) * (
                    metric_max__conversion__search_5min__metric_result
                    - metric_max__conversion__search_5min__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_max__conversion__search_5min__metric_covariate), 2), 0) * sum(segment_all)
            )::double as metric_max__conversion__search_5min__theta,
            1.0 * sum(
                (
                    metric_max__registration__did_signup__metric_covariate
                    - metric_max__registration__did_signup__before_covariate_average
                ) * (
                    metric_max__registration__did_signup__metric_result
                    - metric_max__registration__did_signup__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_max__registration__did_signup__metric_covariate), 2), 0) * sum(segment_all)
            )::double as metric_max__registration__did_signup__theta,
            1.0 * sum(
                (
                    metric_max__registration__did_activate__metric_covariate
                    - metric_max__registration__did_activate__before_covariate_average
                ) * (
                    metric_max__registration__did_activate__metric_result
                    - metric_max__registration__did_activate__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_max__registration__did_activate__metric_covariate), 2), 0) * sum(segment_all)
            )::double as metric_max__registration__did_activate__theta,
            1.0 * sum(
                (
                    metric_max__registration__did_authenticate__metric_covariate
                    - metric_max__registration__did_authenticate__before_covariate_average
                ) * (
                    metric_max__registration__did_authenticate__metric_result
                    - metric_max__registration__did_authenticate__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_max__registration__did_authenticate__metric_covariate), 2), 0)
                * sum(segment_all)
            )::double as metric_max__registration__did_authenticate__theta,
            1.0 * sum(
                (
                    metric_max__search__did_search__metric_covariate
                    - metric_max__search__did_search__before_covariate_average
                ) * (
                    metric_max__search__did_search__metric_result
                    - metric_max__search__did_search__after_covariate_average
                )
            )
            / (nullif(pow(stddev(metric_max__search__did_search__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_max__search__did_search__theta,
            1.0 * sum(
                (metric_max__cast__did_cast__metric_covariate - metric_max__cast__did_cast__before_covariate_average)
                * (metric_max__cast__did_cast__metric_result - metric_max__cast__did_cast__after_covariate_average)
            )
            / (nullif(pow(stddev(metric_max__cast__did_cast__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_max__cast__did_cast__theta,
            1.0 * sum(
                (metric_max__power_viewers__metric_covariate - metric_max__power_viewers__before_covariate_average)
                * (metric_max__power_viewers__metric_result - metric_max__power_viewers__after_covariate_average)
            )
            / (nullif(pow(stddev(metric_max__power_viewers__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_max__power_viewers__theta,
            1.0 * sum(
                (
                    metric_sumgreaterthan__retention__metric_covariate
                    - metric_sumgreaterthan__retention__before_covariate_average
                ) * (
                    metric_sumgreaterthan__retention__metric_result
                    - metric_sumgreaterthan__retention__after_covariate_average
                )
            )
            / (nullif(pow(stddev(metric_sumgreaterthan__retention__metric_covariate), 2), 0) * sum(segment_all))::double
            as metric_sumgreaterthan__retention__theta,
            1.0 * sum(
                (
                    metric_sumgreaterthan__retention__vod__metric_covariate
                    - metric_sumgreaterthan__retention__vod__before_covariate_average
                ) * (
                    metric_sumgreaterthan__retention__vod__metric_result
                    - metric_sumgreaterthan__retention__vod__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_sumgreaterthan__retention__vod__metric_covariate), 2), 0) * sum(segment_all)
            )::double as metric_sumgreaterthan__retention__vod__theta,
            1.0 * sum(
                (
                    metric_sumgreaterthan__retention__linear__metric_covariate
                    - metric_sumgreaterthan__retention__linear__before_covariate_average
                ) * (
                    metric_sumgreaterthan__retention__linear__metric_result
                    - metric_sumgreaterthan__retention__linear__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_sumgreaterthan__retention__linear__metric_covariate), 2), 0) * sum(segment_all)
            )::double as metric_sumgreaterthan__retention__linear__theta,
            1.0 * sum(
                (
                    metric_sumgreaterthan__aha_moment_conversion__metric_covariate
                    - metric_sumgreaterthan__aha_moment_conversion__before_covariate_average
                ) * (
                    metric_sumgreaterthan__aha_moment_conversion__metric_result
                    - metric_sumgreaterthan__aha_moment_conversion__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_sumgreaterthan__aha_moment_conversion__metric_covariate), 2), 0)
                * sum(segment_all)
            )::double as metric_sumgreaterthan__aha_moment_conversion__theta,
            1.0 * sum(
                (
                    metric_sumgreaterthan__retention__new_viewers__metric_covariate
                    - metric_sumgreaterthan__retention__new_viewers__before_covariate_average
                ) * (
                    metric_sumgreaterthan__retention__new_viewers__metric_result
                    - metric_sumgreaterthan__retention__new_viewers__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_sumgreaterthan__retention__new_viewers__metric_covariate), 2), 0)
                * sum(segment_new_viewers)
            )::double as metric_sumgreaterthan__retention__new_viewers__theta,
            1.0 * sum(
                (
                    metric_max__conversion__new_visitors__metric_covariate
                    - metric_max__conversion__new_visitors__before_covariate_average
                ) * (
                    metric_max__conversion__new_visitors__metric_result
                    - metric_max__conversion__new_visitors__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_max__conversion__new_visitors__metric_covariate), 2), 0)
                * sum(segment_new_visitors)
            )::double as metric_max__conversion__new_visitors__theta,
            1.0 * sum(
                (
                    metric_max__conversion__20min__new_visitors__metric_covariate
                    - metric_max__conversion__20min__new_visitors__before_covariate_average
                ) * (
                    metric_max__conversion__20min__new_visitors__metric_result
                    - metric_max__conversion__20min__new_visitors__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_max__conversion__20min__new_visitors__metric_covariate), 2), 0)
                * sum(segment_new_visitors)
            )::double as metric_max__conversion__20min__new_visitors__theta,
            1.0 * sum(
                (
                    metric_max__conversion__5min__new_visitors__metric_covariate
                    - metric_max__conversion__5min__new_visitors__before_covariate_average
                ) * (
                    metric_max__conversion__5min__new_visitors__metric_result
                    - metric_max__conversion__5min__new_visitors__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_max__conversion__5min__new_visitors__metric_covariate), 2), 0)
                * sum(segment_new_visitors)
            )::double as metric_max__conversion__5min__new_visitors__theta,
            1.0 * sum(
                (
                    metric_max__conversion__linear__new_visitors__metric_covariate
                    - metric_max__conversion__linear__new_visitors__before_covariate_average
                ) * (
                    metric_max__conversion__linear__new_visitors__metric_result
                    - metric_max__conversion__linear__new_visitors__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_max__conversion__linear__new_visitors__metric_covariate), 2), 0)
                * sum(segment_new_visitors)
            )::double as metric_max__conversion__linear__new_visitors__theta,
            1.0 * sum(
                (
                    metric_max__conversion__linear_5min__new_visitors__metric_covariate
                    - metric_max__conversion__linear_5min__new_visitors__before_covariate_average
                ) * (
                    metric_max__conversion__linear_5min__new_visitors__metric_result
                    - metric_max__conversion__linear_5min__new_visitors__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_max__conversion__linear_5min__new_visitors__metric_covariate), 2), 0)
                * sum(segment_new_visitors)
            )::double as metric_max__conversion__linear_5min__new_visitors__theta,
            1.0 * sum(
                (
                    metric_max__conversion__vod__new_visitors__metric_covariate
                    - metric_max__conversion__vod__new_visitors__before_covariate_average
                ) * (
                    metric_max__conversion__vod__new_visitors__metric_result
                    - metric_max__conversion__vod__new_visitors__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_max__conversion__vod__new_visitors__metric_covariate), 2), 0)
                * sum(segment_new_visitors)
            )::double as metric_max__conversion__vod__new_visitors__theta,
            1.0 * sum(
                (
                    metric_max__conversion__vod_5min__new_visitors__metric_covariate
                    - metric_max__conversion__vod_5min__new_visitors__before_covariate_average
                ) * (
                    metric_max__conversion__vod_5min__new_visitors__metric_result
                    - metric_max__conversion__vod_5min__new_visitors__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_max__conversion__vod_5min__new_visitors__metric_covariate), 2), 0)
                * sum(segment_new_visitors)
            )::double as metric_max__conversion__vod_5min__new_visitors__theta,
            1.0 * sum(
                (
                    metric_max__registration__did_activate__new_visitors__metric_covariate
                    - metric_max__registration__did_activate__new_visitors__before_covariate_average
                ) * (
                    metric_max__registration__did_activate__new_visitors__metric_result
                    - metric_max__registration__did_activate__new_visitors__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_max__registration__did_activate__new_visitors__metric_covariate), 2), 0)
                * sum(segment_new_visitors)
            )::double as metric_max__registration__did_activate__new_visitors__theta,
            1.0 * sum(
                (
                    metric_max__registration__did_authenticate__new_visitors__metric_covariate
                    - metric_max__registration__did_authenticate__new_visitors__before_covariate_average
                ) * (
                    metric_max__registration__did_authenticate__new_visitors__metric_result
                    - metric_max__registration__did_authenticate__new_visitors__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_max__registration__did_authenticate__new_visitors__metric_covariate), 2), 0)
                * sum(segment_new_visitors)
            )::double as metric_max__registration__did_authenticate__new_visitors__theta,
            1.0 * sum(
                (
                    metric_max__registration__did_signup__new_visitors__metric_covariate
                    - metric_max__registration__did_signup__new_visitors__before_covariate_average
                ) * (
                    metric_max__registration__did_signup__new_visitors__metric_result
                    - metric_max__registration__did_signup__new_visitors__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_max__registration__did_signup__new_visitors__metric_covariate), 2), 0)
                * sum(segment_new_visitors)
            )::double as metric_max__registration__did_signup__new_visitors__theta,
            1.0 * sum(
                (
                    metric_sum__tvt__capped__new_visitors__metric_covariate
                    - metric_sum__tvt__capped__new_visitors__before_covariate_average
                ) * (
                    metric_sum__tvt__capped__new_visitors__metric_result
                    - metric_sum__tvt__capped__new_visitors__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_sum__tvt__capped__new_visitors__metric_covariate), 2), 0)
                * sum(segment_new_visitors)
            )::double as metric_sum__tvt__capped__new_visitors__theta,
            1.0 * sum(
                (
                    metric_sum__tvt__linear_capped__new_visitors__metric_covariate
                    - metric_sum__tvt__linear_capped__new_visitors__before_covariate_average
                ) * (
                    metric_sum__tvt__linear_capped__new_visitors__metric_result
                    - metric_sum__tvt__linear_capped__new_visitors__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_sum__tvt__linear_capped__new_visitors__metric_covariate), 2), 0)
                * sum(segment_new_visitors)
            )::double as metric_sum__tvt__linear_capped__new_visitors__theta,
            1.0 * sum(
                (
                    metric_sum__tvt__vod_capped__new_visitors__metric_covariate
                    - metric_sum__tvt__vod_capped__new_visitors__before_covariate_average
                ) * (
                    metric_sum__tvt__vod_capped__new_visitors__metric_result
                    - metric_sum__tvt__vod_capped__new_visitors__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_sum__tvt__vod_capped__new_visitors__metric_covariate), 2), 0)
                * sum(segment_new_visitors)
            )::double as metric_sum__tvt__vod_capped__new_visitors__theta,
            1.0 * sum(
                (
                    metric_sum__tvt__vod_nap_capped__new_visitors__metric_covariate
                    - metric_sum__tvt__vod_nap_capped__new_visitors__before_covariate_average
                ) * (
                    metric_sum__tvt__vod_nap_capped__new_visitors__metric_result
                    - metric_sum__tvt__vod_nap_capped__new_visitors__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_sum__tvt__vod_nap_capped__new_visitors__metric_covariate), 2), 0)
                * sum(segment_new_visitors)
            )::double as metric_sum__tvt__vod_nap_capped__new_visitors__theta,
            1.0 * sum(
                (
                    metric_sumgreaterthan__aha_moment_conversion__new_visitors__metric_covariate
                    - metric_sumgreaterthan__aha_moment_conversion__new_visitors__before_covariate_average
                ) * (
                    metric_sumgreaterthan__aha_moment_conversion__new_visitors__metric_result
                    - metric_sumgreaterthan__aha_moment_conversion__new_visitors__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_sumgreaterthan__aha_moment_conversion__new_visitors__metric_covariate), 2), 0)
                * sum(segment_new_visitors)
            )::double as metric_sumgreaterthan__aha_moment_conversion__new_visitors__theta,
            1.0 * sum(
                (
                    metric_max__conversion__20min__new_visitors_d1__metric_covariate
                    - metric_max__conversion__20min__new_visitors_d1__before_covariate_average
                ) * (
                    metric_max__conversion__20min__new_visitors_d1__metric_result
                    - metric_max__conversion__20min__new_visitors_d1__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_max__conversion__20min__new_visitors_d1__metric_covariate), 2), 0)
                * sum(segment_new_visitors_d1)
            )::double as metric_max__conversion__20min__new_visitors_d1__theta,
            1.0 * sum(
                (
                    metric_max__conversion__5min__new_visitors_d1__metric_covariate
                    - metric_max__conversion__5min__new_visitors_d1__before_covariate_average
                ) * (
                    metric_max__conversion__5min__new_visitors_d1__metric_result
                    - metric_max__conversion__5min__new_visitors_d1__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_max__conversion__5min__new_visitors_d1__metric_covariate), 2), 0)
                * sum(segment_new_visitors_d1)
            )::double as metric_max__conversion__5min__new_visitors_d1__theta,
            1.0 * sum(
                (
                    metric_max__conversion__homepage_5min__new_visitors_d1__metric_covariate
                    - metric_max__conversion__homepage_5min__new_visitors_d1__before_covariate_average
                ) * (
                    metric_max__conversion__homepage_5min__new_visitors_d1__metric_result
                    - metric_max__conversion__homepage_5min__new_visitors_d1__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_max__conversion__homepage_5min__new_visitors_d1__metric_covariate), 2), 0)
                * sum(segment_new_visitors_d1)
            )::double as metric_max__conversion__homepage_5min__new_visitors_d1__theta,
            1.0 * sum(
                (
                    metric_max__conversion__linear_5min__new_visitors_d1__metric_covariate
                    - metric_max__conversion__linear_5min__new_visitors_d1__before_covariate_average
                ) * (
                    metric_max__conversion__linear_5min__new_visitors_d1__metric_result
                    - metric_max__conversion__linear_5min__new_visitors_d1__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_max__conversion__linear_5min__new_visitors_d1__metric_covariate), 2), 0)
                * sum(segment_new_visitors_d1)
            )::double as metric_max__conversion__linear_5min__new_visitors_d1__theta,
            1.0 * sum(
                (
                    metric_max__conversion__movie_5min__new_visitors_d1__metric_covariate
                    - metric_max__conversion__movie_5min__new_visitors_d1__before_covariate_average
                ) * (
                    metric_max__conversion__movie_5min__new_visitors_d1__metric_result
                    - metric_max__conversion__movie_5min__new_visitors_d1__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_max__conversion__movie_5min__new_visitors_d1__metric_covariate), 2), 0)
                * sum(segment_new_visitors_d1)
            )::double as metric_max__conversion__movie_5min__new_visitors_d1__theta,
            1.0 * sum(
                (
                    metric_max__conversion__search_5min__new_visitors_d1__metric_covariate
                    - metric_max__conversion__search_5min__new_visitors_d1__before_covariate_average
                ) * (
                    metric_max__conversion__search_5min__new_visitors_d1__metric_result
                    - metric_max__conversion__search_5min__new_visitors_d1__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_max__conversion__search_5min__new_visitors_d1__metric_covariate), 2), 0)
                * sum(segment_new_visitors_d1)
            )::double as metric_max__conversion__search_5min__new_visitors_d1__theta,
            1.0 * sum(
                (
                    metric_max__conversion__series_5min__new_visitors_d1__metric_covariate
                    - metric_max__conversion__series_5min__new_visitors_d1__before_covariate_average
                ) * (
                    metric_max__conversion__series_5min__new_visitors_d1__metric_result
                    - metric_max__conversion__series_5min__new_visitors_d1__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_max__conversion__series_5min__new_visitors_d1__metric_covariate), 2), 0)
                * sum(segment_new_visitors_d1)
            )::double as metric_max__conversion__series_5min__new_visitors_d1__theta,
            1.0 * sum(
                (
                    metric_max__registration__did_authenticate__new_visitors_d1__metric_covariate
                    - metric_max__registration__did_authenticate__new_visitors_d1__before_covariate_average
                ) * (
                    metric_max__registration__did_authenticate__new_visitors_d1__metric_result
                    - metric_max__registration__did_authenticate__new_visitors_d1__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_max__registration__did_authenticate__new_visitors_d1__metric_covariate), 2), 0)
                * sum(segment_new_visitors_d1)
            )::double as metric_max__registration__did_authenticate__new_visitors_d1__theta,
            1.0 * sum(
                (
                    metric_sum__add_to_queue__new_visitors_d1__metric_covariate
                    - metric_sum__add_to_queue__new_visitors_d1__before_covariate_average
                ) * (
                    metric_sum__add_to_queue__new_visitors_d1__metric_result
                    - metric_sum__add_to_queue__new_visitors_d1__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_sum__add_to_queue__new_visitors_d1__metric_covariate), 2), 0)
                * sum(segment_new_visitors_d1)
            )::double as metric_sum__add_to_queue__new_visitors_d1__theta,
            1.0 * sum(
                (
                    metric_sum__device_reactions__new_visitors_d1__metric_covariate
                    - metric_sum__device_reactions__new_visitors_d1__before_covariate_average
                ) * (
                    metric_sum__device_reactions__new_visitors_d1__metric_result
                    - metric_sum__device_reactions__new_visitors_d1__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_sum__device_reactions__new_visitors_d1__metric_covariate), 2), 0)
                * sum(segment_new_visitors_d1)
            )::double as metric_sum__device_reactions__new_visitors_d1__theta,
            1.0 * sum(
                (
                    metric_sum__revenue__gross__new_visitors_d1__metric_covariate
                    - metric_sum__revenue__gross__new_visitors_d1__before_covariate_average
                ) * (
                    metric_sum__revenue__gross__new_visitors_d1__metric_result
                    - metric_sum__revenue__gross__new_visitors_d1__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_sum__revenue__gross__new_visitors_d1__metric_covariate), 2), 0)
                * sum(segment_new_visitors_d1)
            )::double as metric_sum__revenue__gross__new_visitors_d1__theta,
            1.0 * sum(
                (
                    metric_sum__revenue__gross_unbudgeted__new_visitors_d1__metric_covariate
                    - metric_sum__revenue__gross_unbudgeted__new_visitors_d1__before_covariate_average
                ) * (
                    metric_sum__revenue__gross_unbudgeted__new_visitors_d1__metric_result
                    - metric_sum__revenue__gross_unbudgeted__new_visitors_d1__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_sum__revenue__gross_unbudgeted__new_visitors_d1__metric_covariate), 2), 0)
                * sum(segment_new_visitors_d1)
            )::double as metric_sum__revenue__gross_unbudgeted__new_visitors_d1__theta,
            1.0 * sum(
                (
                    metric_sum__tvt__capped__new_visitors_d1__metric_covariate
                    - metric_sum__tvt__capped__new_visitors_d1__before_covariate_average
                ) * (
                    metric_sum__tvt__capped__new_visitors_d1__metric_result
                    - metric_sum__tvt__capped__new_visitors_d1__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_sum__tvt__capped__new_visitors_d1__metric_covariate), 2), 0)
                * sum(segment_new_visitors_d1)
            )::double as metric_sum__tvt__capped__new_visitors_d1__theta,
            1.0 * sum(
                (
                    metric_max__conversion__new_visitors_d2__metric_covariate
                    - metric_max__conversion__new_visitors_d2__before_covariate_average
                ) * (
                    metric_max__conversion__new_visitors_d2__metric_result
                    - metric_max__conversion__new_visitors_d2__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_max__conversion__new_visitors_d2__metric_covariate), 2), 0)
                * sum(segment_new_visitors_d2)
            )::double as metric_max__conversion__new_visitors_d2__theta,
            1.0 * sum(
                (
                    metric_max__conversion__5min__new_visitors_d2__metric_covariate
                    - metric_max__conversion__5min__new_visitors_d2__before_covariate_average
                ) * (
                    metric_max__conversion__5min__new_visitors_d2__metric_result
                    - metric_max__conversion__5min__new_visitors_d2__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_max__conversion__5min__new_visitors_d2__metric_covariate), 2), 0)
                * sum(segment_new_visitors_d2)
            )::double as metric_max__conversion__5min__new_visitors_d2__theta,
            1.0 * sum(
                (
                    metric_sum__tvt__capped__new_visitors_d2__metric_covariate
                    - metric_sum__tvt__capped__new_visitors_d2__before_covariate_average
                ) * (
                    metric_sum__tvt__capped__new_visitors_d2__metric_result
                    - metric_sum__tvt__capped__new_visitors_d2__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_sum__tvt__capped__new_visitors_d2__metric_covariate), 2), 0)
                * sum(segment_new_visitors_d2)
            )::double as metric_sum__tvt__capped__new_visitors_d2__theta,
            1.0 * sum(
                (
                    metric_sum__tvt__capped_non_us__new_visitors_non_us__metric_covariate
                    - metric_sum__tvt__capped_non_us__new_visitors_non_us__before_covariate_average
                ) * (
                    metric_sum__tvt__capped_non_us__new_visitors_non_us__metric_result
                    - metric_sum__tvt__capped_non_us__new_visitors_non_us__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_sum__tvt__capped_non_us__new_visitors_non_us__metric_covariate), 2), 0)
                * sum(segment_new_visitors_non_us)
            )::double as metric_sum__tvt__capped_non_us__new_visitors_non_us__theta,
            1.0 * sum(
                (metric_sum__tvt__viewers__metric_covariate - metric_sum__tvt__viewers__before_covariate_average)
                * (metric_sum__tvt__viewers__metric_result - metric_sum__tvt__viewers__after_covariate_average)
            )
            / (nullif(pow(stddev(metric_sum__tvt__viewers__metric_covariate), 2), 0) * sum(segment_viewers))::double
            as metric_sum__tvt__viewers__theta,
            1.0 * sum(
                (
                    metric_sum__tvt__capped__viewers__metric_covariate
                    - metric_sum__tvt__capped__viewers__before_covariate_average
                ) * (
                    metric_sum__tvt__capped__viewers__metric_result
                    - metric_sum__tvt__capped__viewers__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_sum__tvt__capped__viewers__metric_covariate), 2), 0) * sum(segment_viewers)
            )::double as metric_sum__tvt__capped__viewers__theta,
            1.0 * sum(
                (
                    metric_sumgreaterthan__retention__viewers__metric_covariate
                    - metric_sumgreaterthan__retention__viewers__before_covariate_average
                ) * (
                    metric_sumgreaterthan__retention__viewers__metric_result
                    - metric_sumgreaterthan__retention__viewers__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_sumgreaterthan__retention__viewers__metric_covariate), 2), 0)
                * sum(segment_viewers)
            )::double as metric_sumgreaterthan__retention__viewers__theta,
            1.0 * sum(
                (
                    metric_sumgreaterthan__retention__linear__viewers_linear__metric_covariate
                    - metric_sumgreaterthan__retention__linear__viewers_linear__before_covariate_average
                ) * (
                    metric_sumgreaterthan__retention__linear__viewers_linear__metric_result
                    - metric_sumgreaterthan__retention__linear__viewers_linear__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_sumgreaterthan__retention__linear__viewers_linear__metric_covariate), 2), 0)
                * sum(segment_viewers_linear)
            )::double as metric_sumgreaterthan__retention__linear__viewers_linear__theta,
            1.0 * sum(
                (
                    metric_sum__view__vod_daily_active__viewers_vod__metric_covariate
                    - metric_sum__view__vod_daily_active__viewers_vod__before_covariate_average
                ) * (
                    metric_sum__view__vod_daily_active__viewers_vod__metric_result
                    - metric_sum__view__vod_daily_active__viewers_vod__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_sum__view__vod_daily_active__viewers_vod__metric_covariate), 2), 0)
                * sum(segment_viewers_vod)
            )::double as metric_sum__view__vod_daily_active__viewers_vod__theta,
            1.0 * sum(
                (
                    metric_sumgreaterthan__retention__vod__viewers_vod__metric_covariate
                    - metric_sumgreaterthan__retention__vod__viewers_vod__before_covariate_average
                ) * (
                    metric_sumgreaterthan__retention__vod__viewers_vod__metric_result
                    - metric_sumgreaterthan__retention__vod__viewers_vod__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_sumgreaterthan__retention__vod__viewers_vod__metric_covariate), 2), 0)
                * sum(segment_viewers_vod)
            )::double as metric_sumgreaterthan__retention__vod__viewers_vod__theta,
            1.0 * sum(
                (
                    metric_sum__tvt__capped_ca__visitors_ca__metric_covariate
                    - metric_sum__tvt__capped_ca__visitors_ca__before_covariate_average
                ) * (
                    metric_sum__tvt__capped_ca__visitors_ca__metric_result
                    - metric_sum__tvt__capped_ca__visitors_ca__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_sum__tvt__capped_ca__visitors_ca__metric_covariate), 2), 0)
                * sum(segment_visitors_ca)
            )::double as metric_sum__tvt__capped_ca__visitors_ca__theta,
            1.0 * sum(
                (
                    metric_sum__tvt__capped_mx__visitors_mx__metric_covariate
                    - metric_sum__tvt__capped_mx__visitors_mx__before_covariate_average
                ) * (
                    metric_sum__tvt__capped_mx__visitors_mx__metric_result
                    - metric_sum__tvt__capped_mx__visitors_mx__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_sum__tvt__capped_mx__visitors_mx__metric_covariate), 2), 0)
                * sum(segment_visitors_mx)
            )::double as metric_sum__tvt__capped_mx__visitors_mx__theta,
            1.0 * sum(
                (
                    metric_sum__tvt__capped_non_us__visitors_non_us__metric_covariate
                    - metric_sum__tvt__capped_non_us__visitors_non_us__before_covariate_average
                ) * (
                    metric_sum__tvt__capped_non_us__visitors_non_us__metric_result
                    - metric_sum__tvt__capped_non_us__visitors_non_us__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_sum__tvt__capped_non_us__visitors_non_us__metric_covariate), 2), 0)
                * sum(segment_visitors_non_us)
            )::double as metric_sum__tvt__capped_non_us__visitors_non_us__theta,
            1.0 * sum(
                (
                    metric_sum__tvt__capped_us__visitors_us__metric_covariate
                    - metric_sum__tvt__capped_us__visitors_us__before_covariate_average
                ) * (
                    metric_sum__tvt__capped_us__visitors_us__metric_result
                    - metric_sum__tvt__capped_us__visitors_us__after_covariate_average
                )
            )
            / (
                nullif(pow(stddev(metric_sum__tvt__capped_us__visitors_us__metric_covariate), 2), 0)
                * sum(segment_visitors_us)
            )::double as metric_sum__tvt__capped_us__visitors_us__theta

        -- [[ TABLE: experiment_metrics_wide; CTE: cuped_theta; LOOP: metrics; END ]]
        from experiment_user_metrics_stacked_with_cuped_aggregates

        group by 1, 2

    ),

    combined_cuped_data as (

        select
            e.*,
            -- [[ TABLE: experiment_metrics_wide; CTE: combined_cuped_data; LOOP:
            -- metrics; BEGIN ]]
            coalesce(
                e.metric_sum__tvt__metric_result
                - (e.metric_sum__tvt__metric_covariate - e.metric_sum__tvt__before_covariate_average)
                * c.metric_sum__tvt__theta,
                e.metric_sum__tvt__metric_result
            )::double as metric_sum__tvt__cuped_result,
            coalesce(
                e.metric_sum__tvt__capped__metric_result
                - (e.metric_sum__tvt__capped__metric_covariate - e.metric_sum__tvt__capped__before_covariate_average)
                * c.metric_sum__tvt__capped__theta,
                e.metric_sum__tvt__capped__metric_result
            )::double as metric_sum__tvt__capped__cuped_result,
            coalesce(
                e.metric_sum__tvt__capped_us__metric_result - (
                    e.metric_sum__tvt__capped_us__metric_covariate
                    - e.metric_sum__tvt__capped_us__before_covariate_average
                )
                * c.metric_sum__tvt__capped_us__theta,
                e.metric_sum__tvt__capped_us__metric_result
            )::double as metric_sum__tvt__capped_us__cuped_result,
            coalesce(
                e.metric_sum__tvt__capped_mx__metric_result - (
                    e.metric_sum__tvt__capped_mx__metric_covariate
                    - e.metric_sum__tvt__capped_mx__before_covariate_average
                )
                * c.metric_sum__tvt__capped_mx__theta,
                e.metric_sum__tvt__capped_mx__metric_result
            )::double as metric_sum__tvt__capped_mx__cuped_result,
            coalesce(
                e.metric_sum__tvt__capped_ca__metric_result - (
                    e.metric_sum__tvt__capped_ca__metric_covariate
                    - e.metric_sum__tvt__capped_ca__before_covariate_average
                )
                * c.metric_sum__tvt__capped_ca__theta,
                e.metric_sum__tvt__capped_ca__metric_result
            )::double as metric_sum__tvt__capped_ca__cuped_result,
            coalesce(
                e.metric_sum__tvt__capped_non_us__metric_result - (
                    e.metric_sum__tvt__capped_non_us__metric_covariate
                    - e.metric_sum__tvt__capped_non_us__before_covariate_average
                )
                * c.metric_sum__tvt__capped_non_us__theta,
                e.metric_sum__tvt__capped_non_us__metric_result
            )::double as metric_sum__tvt__capped_non_us__cuped_result,
            coalesce(
                e.metric_sum__tvt__vod__metric_result
                - (e.metric_sum__tvt__vod__metric_covariate - e.metric_sum__tvt__vod__before_covariate_average)
                * c.metric_sum__tvt__vod__theta,
                e.metric_sum__tvt__vod__metric_result
            )::double as metric_sum__tvt__vod__cuped_result,
            coalesce(
                e.metric_sum__tvt__vod_capped__metric_result - (
                    e.metric_sum__tvt__vod_capped__metric_covariate
                    - e.metric_sum__tvt__vod_capped__before_covariate_average
                )
                * c.metric_sum__tvt__vod_capped__theta,
                e.metric_sum__tvt__vod_capped__metric_result
            )::double as metric_sum__tvt__vod_capped__cuped_result,
            coalesce(
                e.metric_sum__tvt__vod_nap__metric_result
                - (e.metric_sum__tvt__vod_nap__metric_covariate - e.metric_sum__tvt__vod_nap__before_covariate_average)
                * c.metric_sum__tvt__vod_nap__theta,
                e.metric_sum__tvt__vod_nap__metric_result
            )::double as metric_sum__tvt__vod_nap__cuped_result,
            coalesce(
                e.metric_sum__tvt__vod_nap_capped__metric_result - (
                    e.metric_sum__tvt__vod_nap_capped__metric_covariate
                    - e.metric_sum__tvt__vod_nap_capped__before_covariate_average
                )
                * c.metric_sum__tvt__vod_nap_capped__theta,
                e.metric_sum__tvt__vod_nap_capped__metric_result
            )::double as metric_sum__tvt__vod_nap_capped__cuped_result,
            coalesce(
                e.metric_sum__tvt__vod_movie__metric_result - (
                    e.metric_sum__tvt__vod_movie__metric_covariate
                    - e.metric_sum__tvt__vod_movie__before_covariate_average
                )
                * c.metric_sum__tvt__vod_movie__theta,
                e.metric_sum__tvt__vod_movie__metric_result
            )::double as metric_sum__tvt__vod_movie__cuped_result,
            coalesce(
                e.metric_sum__tvt__vod_series__metric_result - (
                    e.metric_sum__tvt__vod_series__metric_covariate
                    - e.metric_sum__tvt__vod_series__before_covariate_average
                )
                * c.metric_sum__tvt__vod_series__theta,
                e.metric_sum__tvt__vod_series__metric_result
            )::double as metric_sum__tvt__vod_series__cuped_result,
            coalesce(
                e.metric_sum__tvt__vod_capped_series__metric_result - (
                    e.metric_sum__tvt__vod_capped_series__metric_covariate
                    - e.metric_sum__tvt__vod_capped_series__before_covariate_average
                )
                * c.metric_sum__tvt__vod_capped_series__theta,
                e.metric_sum__tvt__vod_capped_series__metric_result
            )::double as metric_sum__tvt__vod_capped_series__cuped_result,
            coalesce(
                e.metric_sum__tvt__vod_nap_movie__metric_result - (
                    e.metric_sum__tvt__vod_nap_movie__metric_covariate
                    - e.metric_sum__tvt__vod_nap_movie__before_covariate_average
                )
                * c.metric_sum__tvt__vod_nap_movie__theta,
                e.metric_sum__tvt__vod_nap_movie__metric_result
            )::double as metric_sum__tvt__vod_nap_movie__cuped_result,
            coalesce(
                e.metric_sum__tvt__vod_nap_series__metric_result - (
                    e.metric_sum__tvt__vod_nap_series__metric_covariate
                    - e.metric_sum__tvt__vod_nap_series__before_covariate_average
                )
                * c.metric_sum__tvt__vod_nap_series__theta,
                e.metric_sum__tvt__vod_nap_series__metric_result
            )::double as metric_sum__tvt__vod_nap_series__cuped_result,
            coalesce(
                e.metric_sum__tvt__vod_ap_movie__metric_result - (
                    e.metric_sum__tvt__vod_ap_movie__metric_covariate
                    - e.metric_sum__tvt__vod_ap_movie__before_covariate_average
                )
                * c.metric_sum__tvt__vod_ap_movie__theta,
                e.metric_sum__tvt__vod_ap_movie__metric_result
            )::double as metric_sum__tvt__vod_ap_movie__cuped_result,
            coalesce(
                e.metric_sum__tvt__vod_ap_capped_movie__metric_result - (
                    e.metric_sum__tvt__vod_ap_capped_movie__metric_covariate
                    - e.metric_sum__tvt__vod_ap_capped_movie__before_covariate_average
                )
                * c.metric_sum__tvt__vod_ap_capped_movie__theta,
                e.metric_sum__tvt__vod_ap_capped_movie__metric_result
            )::double as metric_sum__tvt__vod_ap_capped_movie__cuped_result,
            coalesce(
                e.metric_sum__tvt__vod_ap_series__metric_result - (
                    e.metric_sum__tvt__vod_ap_series__metric_covariate
                    - e.metric_sum__tvt__vod_ap_series__before_covariate_average
                )
                * c.metric_sum__tvt__vod_ap_series__theta,
                e.metric_sum__tvt__vod_ap_series__metric_result
            )::double as metric_sum__tvt__vod_ap_series__cuped_result,
            coalesce(
                e.metric_sum__tvt__vod_ap__metric_result
                - (e.metric_sum__tvt__vod_ap__metric_covariate - e.metric_sum__tvt__vod_ap__before_covariate_average)
                * c.metric_sum__tvt__vod_ap__theta,
                e.metric_sum__tvt__vod_ap__metric_result
            )::double as metric_sum__tvt__vod_ap__cuped_result,
            coalesce(
                e.metric_sum__tvt__vod_ap_capped__metric_result - (
                    e.metric_sum__tvt__vod_ap_capped__metric_covariate
                    - e.metric_sum__tvt__vod_ap_capped__before_covariate_average
                )
                * c.metric_sum__tvt__vod_ap_capped__theta,
                e.metric_sum__tvt__vod_ap_capped__metric_result
            )::double as metric_sum__tvt__vod_ap_capped__cuped_result,

            coalesce(
                e.metric_sum__tvt__linear__metric_result
                - (e.metric_sum__tvt__linear__metric_covariate - e.metric_sum__tvt__linear__before_covariate_average)
                * c.metric_sum__tvt__linear__theta,
                e.metric_sum__tvt__linear__metric_result
            )::double as metric_sum__tvt__linear__cuped_result,
            coalesce(
                e.metric_sum__tvt__linear_capped__metric_result - (
                    e.metric_sum__tvt__linear_capped__metric_covariate
                    - e.metric_sum__tvt__linear_capped__before_covariate_average
                )
                * c.metric_sum__tvt__linear_capped__theta,
                e.metric_sum__tvt__linear_capped__metric_result
            )::double as metric_sum__tvt__linear_capped__cuped_result,

            coalesce(
                e.metric_sum__tvt__scenes__metric_result
                - (e.metric_sum__tvt__scenes__metric_covariate - e.metric_sum__tvt__scenes__before_covariate_average)
                * c.metric_sum__tvt__scenes__theta,
                e.metric_sum__tvt__scenes__metric_result
            )::double as metric_sum__tvt__scenes__cuped_result,
            coalesce(
                e.metric_sum__tvt__scenes_capped__metric_result - (
                    e.metric_sum__tvt__scenes_capped__metric_covariate
                    - e.metric_sum__tvt__scenes_capped__before_covariate_average
                )
                * c.metric_sum__tvt__scenes_capped__theta,
                e.metric_sum__tvt__scenes_capped__metric_result
            )::double as metric_sum__tvt__scenes_capped__cuped_result,

            coalesce(
                e.metric_sum__ad_breaks__vod__metric_result - (
                    e.metric_sum__ad_breaks__vod__metric_covariate
                    - e.metric_sum__ad_breaks__vod__before_covariate_average
                )
                * c.metric_sum__ad_breaks__vod__theta,
                e.metric_sum__ad_breaks__vod__metric_result
            )::double as metric_sum__ad_breaks__vod__cuped_result,
            coalesce(
                e.metric_sum__search__metric_result
                - (e.metric_sum__search__metric_covariate - e.metric_sum__search__before_covariate_average)
                * c.metric_sum__search__theta,
                e.metric_sum__search__metric_result
            )::double as metric_sum__search__cuped_result,
            coalesce(
                e.metric_sum__search__click_through__metric_result - (
                    e.metric_sum__search__click_through__metric_covariate
                    - e.metric_sum__search__click_through__before_covariate_average
                )
                * c.metric_sum__search__click_through__theta,
                e.metric_sum__search__click_through__metric_result
            )::double as metric_sum__search__click_through__cuped_result,
            coalesce(
                e.metric_sum__cast__sessions__metric_result - (
                    e.metric_sum__cast__sessions__metric_covariate
                    - e.metric_sum__cast__sessions__before_covariate_average
                )
                * c.metric_sum__cast__sessions__theta,
                e.metric_sum__cast__sessions__metric_result
            )::double as metric_sum__cast__sessions__cuped_result,
            coalesce(
                e.metric_sum__visit__metric_result
                - (e.metric_sum__visit__metric_covariate - e.metric_sum__visit__before_covariate_average)
                * c.metric_sum__visit__theta,
                e.metric_sum__visit__metric_result
            )::double as metric_sum__visit__cuped_result,
            coalesce(
                e.metric_sum__view__vod_completion_70p__metric_result - (
                    e.metric_sum__view__vod_completion_70p__metric_covariate
                    - e.metric_sum__view__vod_completion_70p__before_covariate_average
                )
                * c.metric_sum__view__vod_completion_70p__theta,
                e.metric_sum__view__vod_completion_70p__metric_result
            )::double as metric_sum__view__vod_completion_70p__cuped_result,
            coalesce(
                e.metric_sum__view__vod_daily_active__metric_result - (
                    e.metric_sum__view__vod_daily_active__metric_covariate
                    - e.metric_sum__view__vod_daily_active__before_covariate_average
                )
                * c.metric_sum__view__vod_daily_active__theta,
                e.metric_sum__view__vod_daily_active__metric_result
            )::double as metric_sum__view__vod_daily_active__cuped_result,
            coalesce(
                e.metric_sum__qualified_view_days__metric_result - (
                    e.metric_sum__qualified_view_days__metric_covariate
                    - e.metric_sum__qualified_view_days__before_covariate_average
                )
                * c.metric_sum__qualified_view_days__theta,
                e.metric_sum__qualified_view_days__metric_result
            )::double as metric_sum__qualified_view_days__cuped_result,
            coalesce(
                e.metric_sum__visit_days__metric_result
                - (e.metric_sum__visit_days__metric_covariate - e.metric_sum__visit_days__before_covariate_average)
                * c.metric_sum__visit_days__theta,
                e.metric_sum__visit_days__metric_result
            )::double as metric_sum__visit_days__cuped_result,
            coalesce(
                e.metric_sum__add_to_queue__metric_result
                - (e.metric_sum__add_to_queue__metric_covariate - e.metric_sum__add_to_queue__before_covariate_average)
                * c.metric_sum__add_to_queue__theta,
                e.metric_sum__add_to_queue__metric_result
            )::double as metric_sum__add_to_queue__cuped_result,
            coalesce(
                e.metric_sum__revenue__gross__metric_result - (
                    e.metric_sum__revenue__gross__metric_covariate
                    - e.metric_sum__revenue__gross__before_covariate_average
                )
                * c.metric_sum__revenue__gross__theta,
                e.metric_sum__revenue__gross__metric_result
            )::double as metric_sum__revenue__gross__cuped_result,
            coalesce(
                e.metric_sum__revenue__gross_unbudgeted__metric_result - (
                    e.metric_sum__revenue__gross_unbudgeted__metric_covariate
                    - e.metric_sum__revenue__gross_unbudgeted__before_covariate_average
                )
                * c.metric_sum__revenue__gross_unbudgeted__theta,
                e.metric_sum__revenue__gross_unbudgeted__metric_result
            )::double as metric_sum__revenue__gross_unbudgeted__cuped_result,
            coalesce(
                e.metric_sum__revenue__gross_budgeted__metric_result - (
                    e.metric_sum__revenue__gross_budgeted__metric_covariate
                    - e.metric_sum__revenue__gross_budgeted__before_covariate_average
                )
                * c.metric_sum__revenue__gross_budgeted__theta,
                e.metric_sum__revenue__gross_budgeted__metric_result
            )::double as metric_sum__revenue__gross_budgeted__cuped_result,
            coalesce(
                e.metric_sum__revenue__gross_unclassified__metric_result - (
                    e.metric_sum__revenue__gross_unclassified__metric_covariate
                    - e.metric_sum__revenue__gross_unclassified__before_covariate_average
                )
                * c.metric_sum__revenue__gross_unclassified__theta,
                e.metric_sum__revenue__gross_unclassified__metric_result
            )::double as metric_sum__revenue__gross_unclassified__cuped_result,
            coalesce(
                e.metric_sum__ad_impressions__metric_result - (
                    e.metric_sum__ad_impressions__metric_covariate
                    - e.metric_sum__ad_impressions__before_covariate_average
                )
                * c.metric_sum__ad_impressions__theta,
                e.metric_sum__ad_impressions__metric_result
            )::double as metric_sum__ad_impressions__cuped_result,
            coalesce(
                e.metric_sum__tvt__vod_ymal__metric_result - (
                    e.metric_sum__tvt__vod_ymal__metric_covariate
                    - e.metric_sum__tvt__vod_ymal__before_covariate_average
                )
                * c.metric_sum__tvt__vod_ymal__theta,
                e.metric_sum__tvt__vod_ymal__metric_result
            )::double as metric_sum__tvt__vod_ymal__cuped_result,
            coalesce(
                e.metric_sum__tvt__vod_featured__metric_result - (
                    e.metric_sum__tvt__vod_featured__metric_covariate
                    - e.metric_sum__tvt__vod_featured__before_covariate_average
                )
                * c.metric_sum__tvt__vod_featured__theta,
                e.metric_sum__tvt__vod_featured__metric_result
            )::double as metric_sum__tvt__vod_featured__cuped_result,
            coalesce(
                e.metric_sum__tvt__vod_capped_featured__metric_result - (
                    e.metric_sum__tvt__vod_capped_featured__metric_covariate
                    - e.metric_sum__tvt__vod_capped_featured__before_covariate_average
                )
                * c.metric_sum__tvt__vod_capped_featured__theta,
                e.metric_sum__tvt__vod_capped_featured__metric_result
            )::double as metric_sum__tvt__vod_capped_featured__cuped_result,
            coalesce(
                e.metric_sum__tvt__vod_movie_featured__metric_result - (
                    e.metric_sum__tvt__vod_movie_featured__metric_covariate
                    - e.metric_sum__tvt__vod_movie_featured__before_covariate_average
                )
                * c.metric_sum__tvt__vod_movie_featured__theta,
                e.metric_sum__tvt__vod_movie_featured__metric_result
            )::double as metric_sum__tvt__vod_movie_featured__cuped_result,
            coalesce(
                e.metric_sum__tvt__vod_series_featured__metric_result - (
                    e.metric_sum__tvt__vod_series_featured__metric_covariate
                    - e.metric_sum__tvt__vod_series_featured__before_covariate_average
                )
                * c.metric_sum__tvt__vod_series_featured__theta,
                e.metric_sum__tvt__vod_series_featured__metric_result
            )::double as metric_sum__tvt__vod_series_featured__cuped_result,
            coalesce(
                e.metric_sum__tvt__vod_cw__metric_result
                - (e.metric_sum__tvt__vod_cw__metric_covariate - e.metric_sum__tvt__vod_cw__before_covariate_average)
                * c.metric_sum__tvt__vod_cw__theta,
                e.metric_sum__tvt__vod_cw__metric_result
            )::double as metric_sum__tvt__vod_cw__cuped_result,
            coalesce(
                e.metric_sum__tvt__vod_capped_cw__metric_result - (
                    e.metric_sum__tvt__vod_capped_cw__metric_covariate
                    - e.metric_sum__tvt__vod_capped_cw__before_covariate_average
                )
                * c.metric_sum__tvt__vod_capped_cw__theta,
                e.metric_sum__tvt__vod_capped_cw__metric_result
            )::double as metric_sum__tvt__vod_capped_cw__cuped_result,
            coalesce(
                e.metric_sum__tvt__vod_movie_cw__metric_result - (
                    e.metric_sum__tvt__vod_movie_cw__metric_covariate
                    - e.metric_sum__tvt__vod_movie_cw__before_covariate_average
                )
                * c.metric_sum__tvt__vod_movie_cw__theta,
                e.metric_sum__tvt__vod_movie_cw__metric_result
            )::double as metric_sum__tvt__vod_movie_cw__cuped_result,
            coalesce(
                e.metric_sum__tvt__vod_series_cw__metric_result - (
                    e.metric_sum__tvt__vod_series_cw__metric_covariate
                    - e.metric_sum__tvt__vod_series_cw__before_covariate_average
                )
                * c.metric_sum__tvt__vod_series_cw__theta,
                e.metric_sum__tvt__vod_series_cw__metric_result
            )::double as metric_sum__tvt__vod_series_cw__cuped_result,
            coalesce(
                e.metric_sum__tvt__vod_cast__metric_result - (
                    e.metric_sum__tvt__vod_cast__metric_covariate
                    - e.metric_sum__tvt__vod_cast__before_covariate_average
                )
                * c.metric_sum__tvt__vod_cast__theta,
                e.metric_sum__tvt__vod_cast__metric_result
            )::double as metric_sum__tvt__vod_cast__cuped_result,
            coalesce(
                e.metric_sum__tvt__vod_cast_total__metric_result - (
                    e.metric_sum__tvt__vod_cast_total__metric_covariate
                    - e.metric_sum__tvt__vod_cast_total__before_covariate_average
                )
                * c.metric_sum__tvt__vod_cast_total__theta,
                e.metric_sum__tvt__vod_cast_total__metric_result
            )::double as metric_sum__tvt__vod_cast_total__cuped_result,
            coalesce(
                e.metric_sum__tvt__vod_spanish__metric_result - (
                    e.metric_sum__tvt__vod_spanish__metric_covariate
                    - e.metric_sum__tvt__vod_spanish__before_covariate_average
                )
                * c.metric_sum__tvt__vod_spanish__theta,
                e.metric_sum__tvt__vod_spanish__metric_result
            )::double as metric_sum__tvt__vod_spanish__cuped_result,
            coalesce(
                e.metric_sum__tvt__vod_capped_spanish__metric_result - (
                    e.metric_sum__tvt__vod_capped_spanish__metric_covariate
                    - e.metric_sum__tvt__vod_capped_spanish__before_covariate_average
                )
                * c.metric_sum__tvt__vod_capped_spanish__theta,
                e.metric_sum__tvt__vod_capped_spanish__metric_result
            )::double as metric_sum__tvt__vod_capped_spanish__cuped_result,
            coalesce(
                e.metric_sum__tvt__vod_search__metric_result - (
                    e.metric_sum__tvt__vod_search__metric_covariate
                    - e.metric_sum__tvt__vod_search__before_covariate_average
                )
                * c.metric_sum__tvt__vod_search__theta,
                e.metric_sum__tvt__vod_search__metric_result
            )::double as metric_sum__tvt__vod_search__cuped_result,
            coalesce(
                e.metric_sum__player__exits__metric_result - (
                    e.metric_sum__player__exits__metric_covariate
                    - e.metric_sum__player__exits__before_covariate_average
                )
                * c.metric_sum__player__exits__theta,
                e.metric_sum__player__exits__metric_result
            )::double as metric_sum__player__exits__cuped_result,
            coalesce(
                e.metric_sum__player__seeks__metric_result - (
                    e.metric_sum__player__seeks__metric_covariate
                    - e.metric_sum__player__seeks__before_covariate_average
                )
                * c.metric_sum__player__seeks__theta,
                e.metric_sum__player__seeks__metric_result
            )::double as metric_sum__player__seeks__cuped_result,
            coalesce(
                e.metric_sum__device_reactions__metric_result - (
                    e.metric_sum__device_reactions__metric_covariate
                    - e.metric_sum__device_reactions__before_covariate_average
                )
                * c.metric_sum__device_reactions__theta,
                e.metric_sum__device_reactions__metric_result
            )::double as metric_sum__device_reactions__cuped_result,
            coalesce(
                e.metric_max__conversion__metric_result
                - (e.metric_max__conversion__metric_covariate - e.metric_max__conversion__before_covariate_average)
                * c.metric_max__conversion__theta,
                e.metric_max__conversion__metric_result
            )::double as metric_max__conversion__cuped_result,
            coalesce(
                e.metric_max__conversion__5min__metric_result - (
                    e.metric_max__conversion__5min__metric_covariate
                    - e.metric_max__conversion__5min__before_covariate_average
                )
                * c.metric_max__conversion__5min__theta,
                e.metric_max__conversion__5min__metric_result
            )::double as metric_max__conversion__5min__cuped_result,
            coalesce(
                e.metric_max__conversion__20min__metric_result - (
                    e.metric_max__conversion__20min__metric_covariate
                    - e.metric_max__conversion__20min__before_covariate_average
                )
                * c.metric_max__conversion__20min__theta,
                e.metric_max__conversion__20min__metric_result
            )::double as metric_max__conversion__20min__cuped_result,
            coalesce(
                e.metric_max__conversion__vod__metric_result - (
                    e.metric_max__conversion__vod__metric_covariate
                    - e.metric_max__conversion__vod__before_covariate_average
                )
                * c.metric_max__conversion__vod__theta,
                e.metric_max__conversion__vod__metric_result
            )::double as metric_max__conversion__vod__cuped_result,
            coalesce(
                e.metric_max__conversion__vod_5min__metric_result - (
                    e.metric_max__conversion__vod_5min__metric_covariate
                    - e.metric_max__conversion__vod_5min__before_covariate_average
                )
                * c.metric_max__conversion__vod_5min__theta,
                e.metric_max__conversion__vod_5min__metric_result
            )::double as metric_max__conversion__vod_5min__cuped_result,
            coalesce(
                e.metric_max__conversion__linear__metric_result - (
                    e.metric_max__conversion__linear__metric_covariate
                    - e.metric_max__conversion__linear__before_covariate_average
                )
                * c.metric_max__conversion__linear__theta,
                e.metric_max__conversion__linear__metric_result
            )::double as metric_max__conversion__linear__cuped_result,
            coalesce(
                e.metric_max__conversion__linear_5min__metric_result - (
                    e.metric_max__conversion__linear_5min__metric_covariate
                    - e.metric_max__conversion__linear_5min__before_covariate_average
                )
                * c.metric_max__conversion__linear_5min__theta,
                e.metric_max__conversion__linear_5min__metric_result
            )::double as metric_max__conversion__linear_5min__cuped_result,
            coalesce(
                e.metric_max__conversion__series_5min__metric_result - (
                    e.metric_max__conversion__series_5min__metric_covariate
                    - e.metric_max__conversion__series_5min__before_covariate_average
                )
                * c.metric_max__conversion__series_5min__theta,
                e.metric_max__conversion__series_5min__metric_result
            )::double as metric_max__conversion__series_5min__cuped_result,
            coalesce(
                e.metric_max__conversion__movie_5min__metric_result - (
                    e.metric_max__conversion__movie_5min__metric_covariate
                    - e.metric_max__conversion__movie_5min__before_covariate_average
                )
                * c.metric_max__conversion__movie_5min__theta,
                e.metric_max__conversion__movie_5min__metric_result
            )::double as metric_max__conversion__movie_5min__cuped_result,
            coalesce(
                e.metric_max__conversion__homepage_5min__metric_result - (
                    e.metric_max__conversion__homepage_5min__metric_covariate
                    - e.metric_max__conversion__homepage_5min__before_covariate_average
                )
                * c.metric_max__conversion__homepage_5min__theta,
                e.metric_max__conversion__homepage_5min__metric_result
            )::double as metric_max__conversion__homepage_5min__cuped_result,
            coalesce(
                e.metric_max__conversion__search_5min__metric_result - (
                    e.metric_max__conversion__search_5min__metric_covariate
                    - e.metric_max__conversion__search_5min__before_covariate_average
                )
                * c.metric_max__conversion__search_5min__theta,
                e.metric_max__conversion__search_5min__metric_result
            )::double as metric_max__conversion__search_5min__cuped_result,
            coalesce(
                e.metric_max__registration__did_signup__metric_result - (
                    e.metric_max__registration__did_signup__metric_covariate
                    - e.metric_max__registration__did_signup__before_covariate_average
                )
                * c.metric_max__registration__did_signup__theta,
                e.metric_max__registration__did_signup__metric_result
            )::double as metric_max__registration__did_signup__cuped_result,
            coalesce(
                e.metric_max__registration__did_activate__metric_result - (
                    e.metric_max__registration__did_activate__metric_covariate
                    - e.metric_max__registration__did_activate__before_covariate_average
                )
                * c.metric_max__registration__did_activate__theta,
                e.metric_max__registration__did_activate__metric_result
            )::double as metric_max__registration__did_activate__cuped_result,
            coalesce(
                e.metric_max__registration__did_authenticate__metric_result - (
                    e.metric_max__registration__did_authenticate__metric_covariate
                    - e.metric_max__registration__did_authenticate__before_covariate_average
                )
                * c.metric_max__registration__did_authenticate__theta,
                e.metric_max__registration__did_authenticate__metric_result
            )::double as metric_max__registration__did_authenticate__cuped_result,
            coalesce(
                e.metric_max__search__did_search__metric_result - (
                    e.metric_max__search__did_search__metric_covariate
                    - e.metric_max__search__did_search__before_covariate_average
                )
                * c.metric_max__search__did_search__theta,
                e.metric_max__search__did_search__metric_result
            )::double as metric_max__search__did_search__cuped_result,
            coalesce(
                e.metric_max__cast__did_cast__metric_result - (
                    e.metric_max__cast__did_cast__metric_covariate
                    - e.metric_max__cast__did_cast__before_covariate_average
                )
                * c.metric_max__cast__did_cast__theta,
                e.metric_max__cast__did_cast__metric_result
            )::double as metric_max__cast__did_cast__cuped_result,
            coalesce(
                e.metric_max__power_viewers__metric_result - (
                    e.metric_max__power_viewers__metric_covariate
                    - e.metric_max__power_viewers__before_covariate_average
                )
                * c.metric_max__power_viewers__theta,
                e.metric_max__power_viewers__metric_result
            )::double as metric_max__power_viewers__cuped_result,
            coalesce(
                e.metric_sumgreaterthan__retention__metric_result - (
                    e.metric_sumgreaterthan__retention__metric_covariate
                    - e.metric_sumgreaterthan__retention__before_covariate_average
                )
                * c.metric_sumgreaterthan__retention__theta,
                e.metric_sumgreaterthan__retention__metric_result
            )::double as metric_sumgreaterthan__retention__cuped_result,
            coalesce(
                e.metric_sumgreaterthan__retention__vod__metric_result - (
                    e.metric_sumgreaterthan__retention__vod__metric_covariate
                    - e.metric_sumgreaterthan__retention__vod__before_covariate_average
                )
                * c.metric_sumgreaterthan__retention__vod__theta,
                e.metric_sumgreaterthan__retention__vod__metric_result
            )::double as metric_sumgreaterthan__retention__vod__cuped_result,
            coalesce(
                e.metric_sumgreaterthan__retention__linear__metric_result - (
                    e.metric_sumgreaterthan__retention__linear__metric_covariate
                    - e.metric_sumgreaterthan__retention__linear__before_covariate_average
                )
                * c.metric_sumgreaterthan__retention__linear__theta,
                e.metric_sumgreaterthan__retention__linear__metric_result
            )::double as metric_sumgreaterthan__retention__linear__cuped_result,
            coalesce(
                e.metric_sumgreaterthan__aha_moment_conversion__metric_result - (
                    e.metric_sumgreaterthan__aha_moment_conversion__metric_covariate
                    - e.metric_sumgreaterthan__aha_moment_conversion__before_covariate_average
                )
                * c.metric_sumgreaterthan__aha_moment_conversion__theta,
                e.metric_sumgreaterthan__aha_moment_conversion__metric_result
            )::double as metric_sumgreaterthan__aha_moment_conversion__cuped_result,
            coalesce(
                e.metric_sumgreaterthan__retention__new_viewers__metric_result - (
                    e.metric_sumgreaterthan__retention__new_viewers__metric_covariate
                    - e.metric_sumgreaterthan__retention__new_viewers__before_covariate_average
                )
                * c.metric_sumgreaterthan__retention__new_viewers__theta,
                e.metric_sumgreaterthan__retention__new_viewers__metric_result
            )::double as metric_sumgreaterthan__retention__new_viewers__cuped_result,
            coalesce(
                e.metric_max__conversion__new_visitors__metric_result - (
                    e.metric_max__conversion__new_visitors__metric_covariate
                    - e.metric_max__conversion__new_visitors__before_covariate_average
                )
                * c.metric_max__conversion__new_visitors__theta,
                e.metric_max__conversion__new_visitors__metric_result
            )::double as metric_max__conversion__new_visitors__cuped_result,
            coalesce(
                e.metric_max__conversion__20min__new_visitors__metric_result - (
                    e.metric_max__conversion__20min__new_visitors__metric_covariate
                    - e.metric_max__conversion__20min__new_visitors__before_covariate_average
                )
                * c.metric_max__conversion__20min__new_visitors__theta,
                e.metric_max__conversion__20min__new_visitors__metric_result
            )::double as metric_max__conversion__20min__new_visitors__cuped_result,
            coalesce(
                e.metric_max__conversion__5min__new_visitors__metric_result - (
                    e.metric_max__conversion__5min__new_visitors__metric_covariate
                    - e.metric_max__conversion__5min__new_visitors__before_covariate_average
                )
                * c.metric_max__conversion__5min__new_visitors__theta,
                e.metric_max__conversion__5min__new_visitors__metric_result
            )::double as metric_max__conversion__5min__new_visitors__cuped_result,
            coalesce(
                e.metric_max__conversion__linear__new_visitors__metric_result - (
                    e.metric_max__conversion__linear__new_visitors__metric_covariate
                    - e.metric_max__conversion__linear__new_visitors__before_covariate_average
                )
                * c.metric_max__conversion__linear__new_visitors__theta,
                e.metric_max__conversion__linear__new_visitors__metric_result
            )::double as metric_max__conversion__linear__new_visitors__cuped_result,
            coalesce(
                e.metric_max__conversion__linear_5min__new_visitors__metric_result - (
                    e.metric_max__conversion__linear_5min__new_visitors__metric_covariate
                    - e.metric_max__conversion__linear_5min__new_visitors__before_covariate_average
                )
                * c.metric_max__conversion__linear_5min__new_visitors__theta,
                e.metric_max__conversion__linear_5min__new_visitors__metric_result
            )::double as metric_max__conversion__linear_5min__new_visitors__cuped_result,
            coalesce(
                e.metric_max__conversion__vod__new_visitors__metric_result - (
                    e.metric_max__conversion__vod__new_visitors__metric_covariate
                    - e.metric_max__conversion__vod__new_visitors__before_covariate_average
                )
                * c.metric_max__conversion__vod__new_visitors__theta,
                e.metric_max__conversion__vod__new_visitors__metric_result
            )::double as metric_max__conversion__vod__new_visitors__cuped_result,
            coalesce(
                e.metric_max__conversion__vod_5min__new_visitors__metric_result - (
                    e.metric_max__conversion__vod_5min__new_visitors__metric_covariate
                    - e.metric_max__conversion__vod_5min__new_visitors__before_covariate_average
                )
                * c.metric_max__conversion__vod_5min__new_visitors__theta,
                e.metric_max__conversion__vod_5min__new_visitors__metric_result
            )::double as metric_max__conversion__vod_5min__new_visitors__cuped_result,
            coalesce(
                e.metric_max__registration__did_activate__new_visitors__metric_result - (
                    e.metric_max__registration__did_activate__new_visitors__metric_covariate
                    - e.metric_max__registration__did_activate__new_visitors__before_covariate_average
                )
                * c.metric_max__registration__did_activate__new_visitors__theta,
                e.metric_max__registration__did_activate__new_visitors__metric_result
            )::double as metric_max__registration__did_activate__new_visitors__cuped_result,
            coalesce(
                e.metric_max__registration__did_authenticate__new_visitors__metric_result - (
                    e.metric_max__registration__did_authenticate__new_visitors__metric_covariate
                    - e.metric_max__registration__did_authenticate__new_visitors__before_covariate_average
                )
                * c.metric_max__registration__did_authenticate__new_visitors__theta,
                e.metric_max__registration__did_authenticate__new_visitors__metric_result
            )::double as metric_max__registration__did_authenticate__new_visitors__cuped_result,
            coalesce(
                e.metric_max__registration__did_signup__new_visitors__metric_result - (
                    e.metric_max__registration__did_signup__new_visitors__metric_covariate
                    - e.metric_max__registration__did_signup__new_visitors__before_covariate_average
                )
                * c.metric_max__registration__did_signup__new_visitors__theta,
                e.metric_max__registration__did_signup__new_visitors__metric_result
            )::double as metric_max__registration__did_signup__new_visitors__cuped_result,
            coalesce(
                e.metric_sum__tvt__capped__new_visitors__metric_result - (
                    e.metric_sum__tvt__capped__new_visitors__metric_covariate
                    - e.metric_sum__tvt__capped__new_visitors__before_covariate_average
                )
                * c.metric_sum__tvt__capped__new_visitors__theta,
                e.metric_sum__tvt__capped__new_visitors__metric_result
            )::double as metric_sum__tvt__capped__new_visitors__cuped_result,
            coalesce(
                e.metric_sum__tvt__linear_capped__new_visitors__metric_result - (
                    e.metric_sum__tvt__linear_capped__new_visitors__metric_covariate
                    - e.metric_sum__tvt__linear_capped__new_visitors__before_covariate_average
                )
                * c.metric_sum__tvt__linear_capped__new_visitors__theta,
                e.metric_sum__tvt__linear_capped__new_visitors__metric_result
            )::double as metric_sum__tvt__linear_capped__new_visitors__cuped_result,
            coalesce(
                e.metric_sum__tvt__vod_capped__new_visitors__metric_result - (
                    e.metric_sum__tvt__vod_capped__new_visitors__metric_covariate
                    - e.metric_sum__tvt__vod_capped__new_visitors__before_covariate_average
                )
                * c.metric_sum__tvt__vod_capped__new_visitors__theta,
                e.metric_sum__tvt__vod_capped__new_visitors__metric_result
            )::double as metric_sum__tvt__vod_capped__new_visitors__cuped_result,
            coalesce(
                e.metric_sum__tvt__vod_nap_capped__new_visitors__metric_result - (
                    e.metric_sum__tvt__vod_nap_capped__new_visitors__metric_covariate
                    - e.metric_sum__tvt__vod_nap_capped__new_visitors__before_covariate_average
                )
                * c.metric_sum__tvt__vod_nap_capped__new_visitors__theta,
                e.metric_sum__tvt__vod_nap_capped__new_visitors__metric_result
            )::double as metric_sum__tvt__vod_nap_capped__new_visitors__cuped_result,
            coalesce(
                e.metric_sumgreaterthan__aha_moment_conversion__new_visitors__metric_result - (
                    e.metric_sumgreaterthan__aha_moment_conversion__new_visitors__metric_covariate
                    - e.metric_sumgreaterthan__aha_moment_conversion__new_visitors__before_covariate_average
                )
                * c.metric_sumgreaterthan__aha_moment_conversion__new_visitors__theta,
                e.metric_sumgreaterthan__aha_moment_conversion__new_visitors__metric_result
            )::double as metric_sumgreaterthan__aha_moment_conversion__new_visitors__cuped_result,
            coalesce(
                e.metric_max__conversion__20min__new_visitors_d1__metric_result - (
                    e.metric_max__conversion__20min__new_visitors_d1__metric_covariate
                    - e.metric_max__conversion__20min__new_visitors_d1__before_covariate_average
                )
                * c.metric_max__conversion__20min__new_visitors_d1__theta,
                e.metric_max__conversion__20min__new_visitors_d1__metric_result
            )::double as metric_max__conversion__20min__new_visitors_d1__cuped_result,
            coalesce(
                e.metric_max__conversion__5min__new_visitors_d1__metric_result - (
                    e.metric_max__conversion__5min__new_visitors_d1__metric_covariate
                    - e.metric_max__conversion__5min__new_visitors_d1__before_covariate_average
                )
                * c.metric_max__conversion__5min__new_visitors_d1__theta,
                e.metric_max__conversion__5min__new_visitors_d1__metric_result
            )::double as metric_max__conversion__5min__new_visitors_d1__cuped_result,
            coalesce(
                e.metric_max__conversion__homepage_5min__new_visitors_d1__metric_result - (
                    e.metric_max__conversion__homepage_5min__new_visitors_d1__metric_covariate
                    - e.metric_max__conversion__homepage_5min__new_visitors_d1__before_covariate_average
                )
                * c.metric_max__conversion__homepage_5min__new_visitors_d1__theta,
                e.metric_max__conversion__homepage_5min__new_visitors_d1__metric_result
            )::double as metric_max__conversion__homepage_5min__new_visitors_d1__cuped_result,
            coalesce(
                e.metric_max__conversion__linear_5min__new_visitors_d1__metric_result - (
                    e.metric_max__conversion__linear_5min__new_visitors_d1__metric_covariate
                    - e.metric_max__conversion__linear_5min__new_visitors_d1__before_covariate_average
                )
                * c.metric_max__conversion__linear_5min__new_visitors_d1__theta,
                e.metric_max__conversion__linear_5min__new_visitors_d1__metric_result
            )::double as metric_max__conversion__linear_5min__new_visitors_d1__cuped_result,
            coalesce(
                e.metric_max__conversion__movie_5min__new_visitors_d1__metric_result - (
                    e.metric_max__conversion__movie_5min__new_visitors_d1__metric_covariate
                    - e.metric_max__conversion__movie_5min__new_visitors_d1__before_covariate_average
                )
                * c.metric_max__conversion__movie_5min__new_visitors_d1__theta,
                e.metric_max__conversion__movie_5min__new_visitors_d1__metric_result
            )::double as metric_max__conversion__movie_5min__new_visitors_d1__cuped_result,
            coalesce(
                e.metric_max__conversion__search_5min__new_visitors_d1__metric_result - (
                    e.metric_max__conversion__search_5min__new_visitors_d1__metric_covariate
                    - e.metric_max__conversion__search_5min__new_visitors_d1__before_covariate_average
                )
                * c.metric_max__conversion__search_5min__new_visitors_d1__theta,
                e.metric_max__conversion__search_5min__new_visitors_d1__metric_result
            )::double as metric_max__conversion__search_5min__new_visitors_d1__cuped_result,
            coalesce(
                e.metric_max__conversion__series_5min__new_visitors_d1__metric_result - (
                    e.metric_max__conversion__series_5min__new_visitors_d1__metric_covariate
                    - e.metric_max__conversion__series_5min__new_visitors_d1__before_covariate_average
                )
                * c.metric_max__conversion__series_5min__new_visitors_d1__theta,
                e.metric_max__conversion__series_5min__new_visitors_d1__metric_result
            )::double as metric_max__conversion__series_5min__new_visitors_d1__cuped_result,
            coalesce(
                e.metric_max__registration__did_authenticate__new_visitors_d1__metric_result - (
                    e.metric_max__registration__did_authenticate__new_visitors_d1__metric_covariate
                    - e.metric_max__registration__did_authenticate__new_visitors_d1__before_covariate_average
                )
                * c.metric_max__registration__did_authenticate__new_visitors_d1__theta,
                e.metric_max__registration__did_authenticate__new_visitors_d1__metric_result
            )::double as metric_max__registration__did_authenticate__new_visitors_d1__cuped_result,
            coalesce(
                e.metric_sum__add_to_queue__new_visitors_d1__metric_result - (
                    e.metric_sum__add_to_queue__new_visitors_d1__metric_covariate
                    - e.metric_sum__add_to_queue__new_visitors_d1__before_covariate_average
                )
                * c.metric_sum__add_to_queue__new_visitors_d1__theta,
                e.metric_sum__add_to_queue__new_visitors_d1__metric_result
            )::double as metric_sum__add_to_queue__new_visitors_d1__cuped_result,
            coalesce(
                e.metric_sum__device_reactions__new_visitors_d1__metric_result - (
                    e.metric_sum__device_reactions__new_visitors_d1__metric_covariate
                    - e.metric_sum__device_reactions__new_visitors_d1__before_covariate_average
                )
                * c.metric_sum__device_reactions__new_visitors_d1__theta,
                e.metric_sum__device_reactions__new_visitors_d1__metric_result
            )::double as metric_sum__device_reactions__new_visitors_d1__cuped_result,
            coalesce(
                e.metric_sum__revenue__gross__new_visitors_d1__metric_result - (
                    e.metric_sum__revenue__gross__new_visitors_d1__metric_covariate
                    - e.metric_sum__revenue__gross__new_visitors_d1__before_covariate_average
                )
                * c.metric_sum__revenue__gross__new_visitors_d1__theta,
                e.metric_sum__revenue__gross__new_visitors_d1__metric_result
            )::double as metric_sum__revenue__gross__new_visitors_d1__cuped_result,
            coalesce(
                e.metric_sum__revenue__gross_unbudgeted__new_visitors_d1__metric_result - (
                    e.metric_sum__revenue__gross_unbudgeted__new_visitors_d1__metric_covariate
                    - e.metric_sum__revenue__gross_unbudgeted__new_visitors_d1__before_covariate_average
                )
                * c.metric_sum__revenue__gross_unbudgeted__new_visitors_d1__theta,
                e.metric_sum__revenue__gross_unbudgeted__new_visitors_d1__metric_result
            )::double as metric_sum__revenue__gross_unbudgeted__new_visitors_d1__cuped_result,
            coalesce(
                e.metric_sum__tvt__capped__new_visitors_d1__metric_result - (
                    e.metric_sum__tvt__capped__new_visitors_d1__metric_covariate
                    - e.metric_sum__tvt__capped__new_visitors_d1__before_covariate_average
                )
                * c.metric_sum__tvt__capped__new_visitors_d1__theta,
                e.metric_sum__tvt__capped__new_visitors_d1__metric_result
            )::double as metric_sum__tvt__capped__new_visitors_d1__cuped_result,
            coalesce(
                e.metric_max__conversion__new_visitors_d2__metric_result - (
                    e.metric_max__conversion__new_visitors_d2__metric_covariate
                    - e.metric_max__conversion__new_visitors_d2__before_covariate_average
                )
                * c.metric_max__conversion__new_visitors_d2__theta,
                e.metric_max__conversion__new_visitors_d2__metric_result
            )::double as metric_max__conversion__new_visitors_d2__cuped_result,
            coalesce(
                e.metric_max__conversion__5min__new_visitors_d2__metric_result - (
                    e.metric_max__conversion__5min__new_visitors_d2__metric_covariate
                    - e.metric_max__conversion__5min__new_visitors_d2__before_covariate_average
                )
                * c.metric_max__conversion__5min__new_visitors_d2__theta,
                e.metric_max__conversion__5min__new_visitors_d2__metric_result
            )::double as metric_max__conversion__5min__new_visitors_d2__cuped_result,
            coalesce(
                e.metric_sum__tvt__capped__new_visitors_d2__metric_result - (
                    e.metric_sum__tvt__capped__new_visitors_d2__metric_covariate
                    - e.metric_sum__tvt__capped__new_visitors_d2__before_covariate_average
                )
                * c.metric_sum__tvt__capped__new_visitors_d2__theta,
                e.metric_sum__tvt__capped__new_visitors_d2__metric_result
            )::double as metric_sum__tvt__capped__new_visitors_d2__cuped_result,
            coalesce(
                e.metric_sum__tvt__capped_non_us__new_visitors_non_us__metric_result - (
                    e.metric_sum__tvt__capped_non_us__new_visitors_non_us__metric_covariate
                    - e.metric_sum__tvt__capped_non_us__new_visitors_non_us__before_covariate_average
                )
                * c.metric_sum__tvt__capped_non_us__new_visitors_non_us__theta,
                e.metric_sum__tvt__capped_non_us__new_visitors_non_us__metric_result
            )::double as metric_sum__tvt__capped_non_us__new_visitors_non_us__cuped_result,
            coalesce(
                e.metric_sum__tvt__viewers__metric_result
                - (e.metric_sum__tvt__viewers__metric_covariate - e.metric_sum__tvt__viewers__before_covariate_average)
                * c.metric_sum__tvt__viewers__theta,
                e.metric_sum__tvt__viewers__metric_result
            )::double as metric_sum__tvt__viewers__cuped_result,
            coalesce(
                e.metric_sum__tvt__capped__viewers__metric_result - (
                    e.metric_sum__tvt__capped__viewers__metric_covariate
                    - e.metric_sum__tvt__capped__viewers__before_covariate_average
                )
                * c.metric_sum__tvt__capped__viewers__theta,
                e.metric_sum__tvt__capped__viewers__metric_result
            )::double as metric_sum__tvt__capped__viewers__cuped_result,
            coalesce(
                e.metric_sumgreaterthan__retention__viewers__metric_result - (
                    e.metric_sumgreaterthan__retention__viewers__metric_covariate
                    - e.metric_sumgreaterthan__retention__viewers__before_covariate_average
                )
                * c.metric_sumgreaterthan__retention__viewers__theta,
                e.metric_sumgreaterthan__retention__viewers__metric_result
            )::double as metric_sumgreaterthan__retention__viewers__cuped_result,
            coalesce(
                e.metric_sumgreaterthan__retention__linear__viewers_linear__metric_result - (
                    e.metric_sumgreaterthan__retention__linear__viewers_linear__metric_covariate
                    - e.metric_sumgreaterthan__retention__linear__viewers_linear__before_covariate_average
                )
                * c.metric_sumgreaterthan__retention__linear__viewers_linear__theta,
                e.metric_sumgreaterthan__retention__linear__viewers_linear__metric_result
            )::double as metric_sumgreaterthan__retention__linear__viewers_linear__cuped_result,
            coalesce(
                e.metric_sum__view__vod_daily_active__viewers_vod__metric_result - (
                    e.metric_sum__view__vod_daily_active__viewers_vod__metric_covariate
                    - e.metric_sum__view__vod_daily_active__viewers_vod__before_covariate_average
                )
                * c.metric_sum__view__vod_daily_active__viewers_vod__theta,
                e.metric_sum__view__vod_daily_active__viewers_vod__metric_result
            )::double as metric_sum__view__vod_daily_active__viewers_vod__cuped_result,
            coalesce(
                e.metric_sumgreaterthan__retention__vod__viewers_vod__metric_result - (
                    e.metric_sumgreaterthan__retention__vod__viewers_vod__metric_covariate
                    - e.metric_sumgreaterthan__retention__vod__viewers_vod__before_covariate_average
                )
                * c.metric_sumgreaterthan__retention__vod__viewers_vod__theta,
                e.metric_sumgreaterthan__retention__vod__viewers_vod__metric_result
            )::double as metric_sumgreaterthan__retention__vod__viewers_vod__cuped_result,
            coalesce(
                e.metric_sum__tvt__capped_ca__visitors_ca__metric_result - (
                    e.metric_sum__tvt__capped_ca__visitors_ca__metric_covariate
                    - e.metric_sum__tvt__capped_ca__visitors_ca__before_covariate_average
                )
                * c.metric_sum__tvt__capped_ca__visitors_ca__theta,
                e.metric_sum__tvt__capped_ca__visitors_ca__metric_result
            )::double as metric_sum__tvt__capped_ca__visitors_ca__cuped_result,
            coalesce(
                e.metric_sum__tvt__capped_mx__visitors_mx__metric_result - (
                    e.metric_sum__tvt__capped_mx__visitors_mx__metric_covariate
                    - e.metric_sum__tvt__capped_mx__visitors_mx__before_covariate_average
                )
                * c.metric_sum__tvt__capped_mx__visitors_mx__theta,
                e.metric_sum__tvt__capped_mx__visitors_mx__metric_result
            )::double as metric_sum__tvt__capped_mx__visitors_mx__cuped_result,
            coalesce(
                e.metric_sum__tvt__capped_non_us__visitors_non_us__metric_result - (
                    e.metric_sum__tvt__capped_non_us__visitors_non_us__metric_covariate
                    - e.metric_sum__tvt__capped_non_us__visitors_non_us__before_covariate_average
                )
                * c.metric_sum__tvt__capped_non_us__visitors_non_us__theta,
                e.metric_sum__tvt__capped_non_us__visitors_non_us__metric_result
            )::double as metric_sum__tvt__capped_non_us__visitors_non_us__cuped_result,
            coalesce(
                e.metric_sum__tvt__capped_us__visitors_us__metric_result - (
                    e.metric_sum__tvt__capped_us__visitors_us__metric_covariate
                    - e.metric_sum__tvt__capped_us__visitors_us__before_covariate_average
                )
                * c.metric_sum__tvt__capped_us__visitors_us__theta,
                e.metric_sum__tvt__capped_us__visitors_us__metric_result
            )::double as metric_sum__tvt__capped_us__visitors_us__cuped_result

        -- [[ TABLE: experiment_metrics_wide; CTE: combined_cuped_data; LOOP: metrics;
        -- END ]]
        from experiment_user_metrics_stacked_with_cuped_aggregates as e
        inner join cuped_theta as c on e.experiment__name = c.experiment__name and e.platform = c.platform

    )

select
    md5(
        cast(
            coalesce(cast(experiment__name as string), '')
            || '-'
            || coalesce(cast(experiment__parameter_value as string), '')
            || '-'
            || coalesce(cast(platform as string), '') as string
        )
    ) as _id,
    experiment__name,
    experiment__parameter_value,
    platform,
    min(experiment_begin) as exp_start_date,
    max(experiment_last_value) as exp_last_value,
    max(_last_date) as _last_date,
    -- [[ TABLE: experiment_metrics_wide; CTE: main; LOOP: segments; BEGIN ]]
    sum(segment_all) as device_count_segment_all,
    sum(segment_new_viewers) as device_count_segment_new_viewers,
    sum(segment_new_visitors) as device_count_segment_new_visitors,
    sum(segment_new_visitors_d1) as device_count_segment_new_visitors_d1,
    sum(segment_new_visitors_d2) as device_count_segment_new_visitors_d2,
    sum(segment_new_visitors_non_us) as device_count_segment_new_visitors_non_us,
    sum(segment_viewers) as device_count_segment_viewers,
    sum(segment_viewers_linear) as device_count_segment_viewers_linear,
    sum(segment_viewers_vod) as device_count_segment_viewers_vod,
    sum(segment_visitors_ca) as device_count_segment_visitors_ca,
    sum(segment_visitors_mx) as device_count_segment_visitors_mx,
    sum(segment_visitors_non_us) as device_count_segment_visitors_non_us,
    sum(segment_visitors_us) as device_count_segment_visitors_us,
    -- [[ TABLE: experiment_metrics_wide; CTE: main; LOOP: segments; END ]]
    -- [[ TABLE: experiment_metrics_wide; CTE: main; LOOP: metrics; BEGIN ]]
    avg(metric_sum__tvt__metric_result)::double as metric_sum__tvt__metric_result,
    stddev(metric_sum__tvt__metric_result)::double as metric_sum__tvt__metric_stddev,
    avg(metric_sum__tvt__cuped_result)::double as metric_sum__tvt__cuped_result,
    stddev(metric_sum__tvt__cuped_result)::double as metric_sum__tvt__cuped_stddev,
    avg(metric_sum__tvt__metric_covariate)::double as metric_sum__tvt__pre_experiment_metric_result,
    stddev(metric_sum__tvt__metric_covariate)::double as metric_sum__tvt__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__capped__metric_result)::double as metric_sum__tvt__capped__metric_result,
    stddev(metric_sum__tvt__capped__metric_result)::double as metric_sum__tvt__capped__metric_stddev,
    avg(metric_sum__tvt__capped__cuped_result)::double as metric_sum__tvt__capped__cuped_result,
    stddev(metric_sum__tvt__capped__cuped_result)::double as metric_sum__tvt__capped__cuped_stddev,
    avg(metric_sum__tvt__capped__metric_covariate)::double as metric_sum__tvt__capped__pre_experiment_metric_result,
    stddev(metric_sum__tvt__capped__metric_covariate)::double as metric_sum__tvt__capped__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__capped_us__metric_result)::double as metric_sum__tvt__capped_us__metric_result,
    stddev(metric_sum__tvt__capped_us__metric_result)::double as metric_sum__tvt__capped_us__metric_stddev,
    avg(metric_sum__tvt__capped_us__cuped_result)::double as metric_sum__tvt__capped_us__cuped_result,
    stddev(metric_sum__tvt__capped_us__cuped_result)::double as metric_sum__tvt__capped_us__cuped_stddev,
    avg(metric_sum__tvt__capped_us__metric_covariate)::double
    as metric_sum__tvt__capped_us__pre_experiment_metric_result,
    stddev(metric_sum__tvt__capped_us__metric_covariate)::double
    as metric_sum__tvt__capped_us__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__capped_mx__metric_result)::double as metric_sum__tvt__capped_mx__metric_result,
    stddev(metric_sum__tvt__capped_mx__metric_result)::double as metric_sum__tvt__capped_mx__metric_stddev,
    avg(metric_sum__tvt__capped_mx__cuped_result)::double as metric_sum__tvt__capped_mx__cuped_result,
    stddev(metric_sum__tvt__capped_mx__cuped_result)::double as metric_sum__tvt__capped_mx__cuped_stddev,
    avg(metric_sum__tvt__capped_mx__metric_covariate)::double
    as metric_sum__tvt__capped_mx__pre_experiment_metric_result,
    stddev(metric_sum__tvt__capped_mx__metric_covariate)::double
    as metric_sum__tvt__capped_mx__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__capped_ca__metric_result)::double as metric_sum__tvt__capped_ca__metric_result,
    stddev(metric_sum__tvt__capped_ca__metric_result)::double as metric_sum__tvt__capped_ca__metric_stddev,
    avg(metric_sum__tvt__capped_ca__cuped_result)::double as metric_sum__tvt__capped_ca__cuped_result,
    stddev(metric_sum__tvt__capped_ca__cuped_result)::double as metric_sum__tvt__capped_ca__cuped_stddev,
    avg(metric_sum__tvt__capped_ca__metric_covariate)::double
    as metric_sum__tvt__capped_ca__pre_experiment_metric_result,
    stddev(metric_sum__tvt__capped_ca__metric_covariate)::double
    as metric_sum__tvt__capped_ca__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__capped_non_us__metric_result)::double as metric_sum__tvt__capped_non_us__metric_result,
    stddev(metric_sum__tvt__capped_non_us__metric_result)::double as metric_sum__tvt__capped_non_us__metric_stddev,
    avg(metric_sum__tvt__capped_non_us__cuped_result)::double as metric_sum__tvt__capped_non_us__cuped_result,
    stddev(metric_sum__tvt__capped_non_us__cuped_result)::double as metric_sum__tvt__capped_non_us__cuped_stddev,
    avg(metric_sum__tvt__capped_non_us__metric_covariate)::double
    as metric_sum__tvt__capped_non_us__pre_experiment_metric_result,
    stddev(metric_sum__tvt__capped_non_us__metric_covariate)::double
    as metric_sum__tvt__capped_non_us__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__vod__metric_result)::double as metric_sum__tvt__vod__metric_result,
    stddev(metric_sum__tvt__vod__metric_result)::double as metric_sum__tvt__vod__metric_stddev,
    avg(metric_sum__tvt__vod__cuped_result)::double as metric_sum__tvt__vod__cuped_result,
    stddev(metric_sum__tvt__vod__cuped_result)::double as metric_sum__tvt__vod__cuped_stddev,
    avg(metric_sum__tvt__vod__metric_covariate)::double as metric_sum__tvt__vod__pre_experiment_metric_result,
    stddev(metric_sum__tvt__vod__metric_covariate)::double as metric_sum__tvt__vod__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__vod_capped__metric_result)::double as metric_sum__tvt__vod_capped__metric_result,
    stddev(metric_sum__tvt__vod_capped__metric_result)::double as metric_sum__tvt__vod_capped__metric_stddev,
    avg(metric_sum__tvt__vod_capped__cuped_result)::double as metric_sum__tvt__vod_capped__cuped_result,
    stddev(metric_sum__tvt__vod_capped__cuped_result)::double as metric_sum__tvt__vod_capped__cuped_stddev,
    avg(metric_sum__tvt__vod_capped__metric_covariate)::double
    as metric_sum__tvt__vod_capped__pre_experiment_metric_result,
    stddev(metric_sum__tvt__vod_capped__metric_covariate)::double
    as metric_sum__tvt__vod_capped__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__vod_nap__metric_result)::double as metric_sum__tvt__vod_nap__metric_result,
    stddev(metric_sum__tvt__vod_nap__metric_result)::double as metric_sum__tvt__vod_nap__metric_stddev,
    avg(metric_sum__tvt__vod_nap__cuped_result)::double as metric_sum__tvt__vod_nap__cuped_result,
    stddev(metric_sum__tvt__vod_nap__cuped_result)::double as metric_sum__tvt__vod_nap__cuped_stddev,
    avg(metric_sum__tvt__vod_nap__metric_covariate)::double as metric_sum__tvt__vod_nap__pre_experiment_metric_result,
    stddev(metric_sum__tvt__vod_nap__metric_covariate)::double
    as metric_sum__tvt__vod_nap__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__vod_nap_capped__metric_result)::double as metric_sum__tvt__vod_nap_capped__metric_result,
    stddev(metric_sum__tvt__vod_nap_capped__metric_result)::double as metric_sum__tvt__vod_nap_capped__metric_stddev,
    avg(metric_sum__tvt__vod_nap_capped__cuped_result)::double as metric_sum__tvt__vod_nap_capped__cuped_result,
    stddev(metric_sum__tvt__vod_nap_capped__cuped_result)::double as metric_sum__tvt__vod_nap_capped__cuped_stddev,
    avg(metric_sum__tvt__vod_nap_capped__metric_covariate)::double
    as metric_sum__tvt__vod_nap_capped__pre_experiment_metric_result,
    stddev(metric_sum__tvt__vod_nap_capped__metric_covariate)::double
    as metric_sum__tvt__vod_nap_capped__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__vod_movie__metric_result)::double as metric_sum__tvt__vod_movie__metric_result,
    stddev(metric_sum__tvt__vod_movie__metric_result)::double as metric_sum__tvt__vod_movie__metric_stddev,
    avg(metric_sum__tvt__vod_movie__cuped_result)::double as metric_sum__tvt__vod_movie__cuped_result,
    stddev(metric_sum__tvt__vod_movie__cuped_result)::double as metric_sum__tvt__vod_movie__cuped_stddev,
    avg(metric_sum__tvt__vod_movie__metric_covariate)::double
    as metric_sum__tvt__vod_movie__pre_experiment_metric_result,
    stddev(metric_sum__tvt__vod_movie__metric_covariate)::double
    as metric_sum__tvt__vod_movie__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__vod_series__metric_result)::double as metric_sum__tvt__vod_series__metric_result,
    stddev(metric_sum__tvt__vod_series__metric_result)::double as metric_sum__tvt__vod_series__metric_stddev,
    avg(metric_sum__tvt__vod_series__cuped_result)::double as metric_sum__tvt__vod_series__cuped_result,
    stddev(metric_sum__tvt__vod_series__cuped_result)::double as metric_sum__tvt__vod_series__cuped_stddev,
    avg(metric_sum__tvt__vod_series__metric_covariate)::double
    as metric_sum__tvt__vod_series__pre_experiment_metric_result,
    stddev(metric_sum__tvt__vod_series__metric_covariate)::double
    as metric_sum__tvt__vod_series__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__vod_capped_series__metric_result)::double as metric_sum__tvt__vod_capped_series__metric_result,
    stddev(metric_sum__tvt__vod_capped_series__metric_result)::double
    as metric_sum__tvt__vod_capped_series__metric_stddev,
    avg(metric_sum__tvt__vod_capped_series__cuped_result)::double as metric_sum__tvt__vod_capped_series__cuped_result,
    stddev(metric_sum__tvt__vod_capped_series__cuped_result)::double
    as metric_sum__tvt__vod_capped_series__cuped_stddev,
    avg(metric_sum__tvt__vod_capped_series__metric_covariate)::double
    as metric_sum__tvt__vod_capped_series__pre_experiment_metric_result,
    stddev(metric_sum__tvt__vod_capped_series__metric_covariate)::double
    as metric_sum__tvt__vod_capped_series__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__vod_nap_movie__metric_result)::double as metric_sum__tvt__vod_nap_movie__metric_result,
    stddev(metric_sum__tvt__vod_nap_movie__metric_result)::double as metric_sum__tvt__vod_nap_movie__metric_stddev,
    avg(metric_sum__tvt__vod_nap_movie__cuped_result)::double as metric_sum__tvt__vod_nap_movie__cuped_result,
    stddev(metric_sum__tvt__vod_nap_movie__cuped_result)::double as metric_sum__tvt__vod_nap_movie__cuped_stddev,
    avg(metric_sum__tvt__vod_nap_movie__metric_covariate)::double
    as metric_sum__tvt__vod_nap_movie__pre_experiment_metric_result,
    stddev(metric_sum__tvt__vod_nap_movie__metric_covariate)::double
    as metric_sum__tvt__vod_nap_movie__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__vod_nap_series__metric_result)::double as metric_sum__tvt__vod_nap_series__metric_result,
    stddev(metric_sum__tvt__vod_nap_series__metric_result)::double as metric_sum__tvt__vod_nap_series__metric_stddev,
    avg(metric_sum__tvt__vod_nap_series__cuped_result)::double as metric_sum__tvt__vod_nap_series__cuped_result,
    stddev(metric_sum__tvt__vod_nap_series__cuped_result)::double as metric_sum__tvt__vod_nap_series__cuped_stddev,
    avg(metric_sum__tvt__vod_nap_series__metric_covariate)::double
    as metric_sum__tvt__vod_nap_series__pre_experiment_metric_result,
    stddev(metric_sum__tvt__vod_nap_series__metric_covariate)::double
    as metric_sum__tvt__vod_nap_series__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__vod_ap_movie__metric_result)::double as metric_sum__tvt__vod_ap_movie__metric_result,
    stddev(metric_sum__tvt__vod_ap_movie__metric_result)::double as metric_sum__tvt__vod_ap_movie__metric_stddev,
    avg(metric_sum__tvt__vod_ap_movie__cuped_result)::double as metric_sum__tvt__vod_ap_movie__cuped_result,
    stddev(metric_sum__tvt__vod_ap_movie__cuped_result)::double as metric_sum__tvt__vod_ap_movie__cuped_stddev,
    avg(metric_sum__tvt__vod_ap_movie__metric_covariate)::double
    as metric_sum__tvt__vod_ap_movie__pre_experiment_metric_result,
    stddev(metric_sum__tvt__vod_ap_movie__metric_covariate)::double
    as metric_sum__tvt__vod_ap_movie__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__vod_ap_capped_movie__metric_result)::double
    as metric_sum__tvt__vod_ap_capped_movie__metric_result,
    stddev(metric_sum__tvt__vod_ap_capped_movie__metric_result)::double
    as metric_sum__tvt__vod_ap_capped_movie__metric_stddev,
    avg(metric_sum__tvt__vod_ap_capped_movie__cuped_result)::double
    as metric_sum__tvt__vod_ap_capped_movie__cuped_result,
    stddev(metric_sum__tvt__vod_ap_capped_movie__cuped_result)::double
    as metric_sum__tvt__vod_ap_capped_movie__cuped_stddev,
    avg(metric_sum__tvt__vod_ap_capped_movie__metric_covariate)::double
    as metric_sum__tvt__vod_ap_capped_movie__pre_experiment_metric_result,
    stddev(metric_sum__tvt__vod_ap_capped_movie__metric_covariate)::double
    as metric_sum__tvt__vod_ap_capped_movie__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__vod_ap_series__metric_result)::double as metric_sum__tvt__vod_ap_series__metric_result,
    stddev(metric_sum__tvt__vod_ap_series__metric_result)::double as metric_sum__tvt__vod_ap_series__metric_stddev,
    avg(metric_sum__tvt__vod_ap_series__cuped_result)::double as metric_sum__tvt__vod_ap_series__cuped_result,
    stddev(metric_sum__tvt__vod_ap_series__cuped_result)::double as metric_sum__tvt__vod_ap_series__cuped_stddev,
    avg(metric_sum__tvt__vod_ap_series__metric_covariate)::double
    as metric_sum__tvt__vod_ap_series__pre_experiment_metric_result,
    stddev(metric_sum__tvt__vod_ap_series__metric_covariate)::double
    as metric_sum__tvt__vod_ap_series__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__vod_ap__metric_result)::double as metric_sum__tvt__vod_ap__metric_result,
    stddev(metric_sum__tvt__vod_ap__metric_result)::double as metric_sum__tvt__vod_ap__metric_stddev,
    avg(metric_sum__tvt__vod_ap__cuped_result)::double as metric_sum__tvt__vod_ap__cuped_result,
    stddev(metric_sum__tvt__vod_ap__cuped_result)::double as metric_sum__tvt__vod_ap__cuped_stddev,
    avg(metric_sum__tvt__vod_ap__metric_covariate)::double as metric_sum__tvt__vod_ap__pre_experiment_metric_result,
    stddev(metric_sum__tvt__vod_ap__metric_covariate)::double as metric_sum__tvt__vod_ap__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__vod_ap_capped__metric_result)::double as metric_sum__tvt__vod_ap_capped__metric_result,
    stddev(metric_sum__tvt__vod_ap_capped__metric_result)::double as metric_sum__tvt__vod_ap_capped__metric_stddev,
    avg(metric_sum__tvt__vod_ap_capped__cuped_result)::double as metric_sum__tvt__vod_ap_capped__cuped_result,
    stddev(metric_sum__tvt__vod_ap_capped__cuped_result)::double as metric_sum__tvt__vod_ap_capped__cuped_stddev,
    avg(metric_sum__tvt__vod_ap_capped__metric_covariate)::double
    as metric_sum__tvt__vod_ap_capped__pre_experiment_metric_result,
    stddev(metric_sum__tvt__vod_ap_capped__metric_covariate)::double
    as metric_sum__tvt__vod_ap_capped__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__linear__metric_result)::double as metric_sum__tvt__linear__metric_result,
    stddev(metric_sum__tvt__linear__metric_result)::double as metric_sum__tvt__linear__metric_stddev,
    avg(metric_sum__tvt__linear__cuped_result)::double as metric_sum__tvt__linear__cuped_result,
    stddev(metric_sum__tvt__linear__cuped_result)::double as metric_sum__tvt__linear__cuped_stddev,
    avg(metric_sum__tvt__linear__metric_covariate)::double as metric_sum__tvt__linear__pre_experiment_metric_result,
    stddev(metric_sum__tvt__linear__metric_covariate)::double as metric_sum__tvt__linear__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__linear_capped__metric_result)::double as metric_sum__tvt__linear_capped__metric_result,
    stddev(metric_sum__tvt__linear_capped__metric_result)::double as metric_sum__tvt__linear_capped__metric_stddev,
    avg(metric_sum__tvt__linear_capped__cuped_result)::double as metric_sum__tvt__linear_capped__cuped_result,
    stddev(metric_sum__tvt__linear_capped__cuped_result)::double as metric_sum__tvt__linear_capped__cuped_stddev,
    avg(metric_sum__tvt__linear_capped__metric_covariate)::double
    as metric_sum__tvt__linear_capped__pre_experiment_metric_result,
    stddev(metric_sum__tvt__linear_capped__metric_covariate)::double
    as metric_sum__tvt__linear_capped__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__scenes__metric_result)::double as metric_sum__tvt__scenes__metric_result,
    stddev(metric_sum__tvt__scenes__metric_result)::double as metric_sum__tvt__scenes__metric_stddev,
    avg(metric_sum__tvt__scenes__cuped_result)::double as metric_sum__tvt__scenes__cuped_result,
    stddev(metric_sum__tvt__scenes__cuped_result)::double as metric_sum__tvt__scenes__cuped_stddev,
    avg(metric_sum__tvt__scenes__metric_covariate)::double as metric_sum__tvt__scenes__pre_experiment_metric_result,
    stddev(metric_sum__tvt__scenes__metric_covariate)::double as metric_sum__tvt__scenes__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__scenes_capped__metric_result)::double as metric_sum__tvt__scenes_capped__metric_result,
    stddev(metric_sum__tvt__scenes_capped__metric_result)::double as metric_sum__tvt__scenes_capped__metric_stddev,
    avg(metric_sum__tvt__scenes_capped__cuped_result)::double as metric_sum__tvt__scenes_capped__cuped_result,
    stddev(metric_sum__tvt__scenes_capped__cuped_result)::double as metric_sum__tvt__scenes_capped__cuped_stddev,
    avg(metric_sum__tvt__scenes_capped__metric_covariate)::double
    as metric_sum__tvt__scenes_capped__pre_experiment_metric_result,
    stddev(metric_sum__tvt__scenes_capped__metric_covariate)::double
    as metric_sum__tvt__scenes_capped__pre_experiment_metric_stddev,
    avg(metric_sum__ad_breaks__vod__metric_result)::double as metric_sum__ad_breaks__vod__metric_result,
    stddev(metric_sum__ad_breaks__vod__metric_result)::double as metric_sum__ad_breaks__vod__metric_stddev,
    avg(metric_sum__ad_breaks__vod__cuped_result)::double as metric_sum__ad_breaks__vod__cuped_result,
    stddev(metric_sum__ad_breaks__vod__cuped_result)::double as metric_sum__ad_breaks__vod__cuped_stddev,
    avg(metric_sum__ad_breaks__vod__metric_covariate)::double
    as metric_sum__ad_breaks__vod__pre_experiment_metric_result,
    stddev(metric_sum__ad_breaks__vod__metric_covariate)::double
    as metric_sum__ad_breaks__vod__pre_experiment_metric_stddev,
    avg(metric_sum__search__metric_result)::double as metric_sum__search__metric_result,
    stddev(metric_sum__search__metric_result)::double as metric_sum__search__metric_stddev,
    avg(metric_sum__search__cuped_result)::double as metric_sum__search__cuped_result,
    stddev(metric_sum__search__cuped_result)::double as metric_sum__search__cuped_stddev,
    avg(metric_sum__search__metric_covariate)::double as metric_sum__search__pre_experiment_metric_result,
    stddev(metric_sum__search__metric_covariate)::double as metric_sum__search__pre_experiment_metric_stddev,
    avg(metric_sum__search__click_through__metric_result)::double as metric_sum__search__click_through__metric_result,
    stddev(metric_sum__search__click_through__metric_result)::double
    as metric_sum__search__click_through__metric_stddev,
    avg(metric_sum__search__click_through__cuped_result)::double as metric_sum__search__click_through__cuped_result,
    stddev(metric_sum__search__click_through__cuped_result)::double as metric_sum__search__click_through__cuped_stddev,
    avg(metric_sum__search__click_through__metric_covariate)::double
    as metric_sum__search__click_through__pre_experiment_metric_result,
    stddev(metric_sum__search__click_through__metric_covariate)::double
    as metric_sum__search__click_through__pre_experiment_metric_stddev,
    avg(metric_sum__cast__sessions__metric_result)::double as metric_sum__cast__sessions__metric_result,
    stddev(metric_sum__cast__sessions__metric_result)::double as metric_sum__cast__sessions__metric_stddev,
    avg(metric_sum__cast__sessions__cuped_result)::double as metric_sum__cast__sessions__cuped_result,
    stddev(metric_sum__cast__sessions__cuped_result)::double as metric_sum__cast__sessions__cuped_stddev,
    avg(metric_sum__cast__sessions__metric_covariate)::double
    as metric_sum__cast__sessions__pre_experiment_metric_result,
    stddev(metric_sum__cast__sessions__metric_covariate)::double
    as metric_sum__cast__sessions__pre_experiment_metric_stddev,
    avg(metric_sum__visit__metric_result)::double as metric_sum__visit__metric_result,
    stddev(metric_sum__visit__metric_result)::double as metric_sum__visit__metric_stddev,
    avg(metric_sum__visit__cuped_result)::double as metric_sum__visit__cuped_result,
    stddev(metric_sum__visit__cuped_result)::double as metric_sum__visit__cuped_stddev,
    avg(metric_sum__visit__metric_covariate)::double as metric_sum__visit__pre_experiment_metric_result,
    stddev(metric_sum__visit__metric_covariate)::double as metric_sum__visit__pre_experiment_metric_stddev,
    avg(metric_sum__view__vod_completion_70p__metric_result)::double
    as metric_sum__view__vod_completion_70p__metric_result,
    stddev(metric_sum__view__vod_completion_70p__metric_result)::double
    as metric_sum__view__vod_completion_70p__metric_stddev,
    avg(metric_sum__view__vod_completion_70p__cuped_result)::double
    as metric_sum__view__vod_completion_70p__cuped_result,
    stddev(metric_sum__view__vod_completion_70p__cuped_result)::double
    as metric_sum__view__vod_completion_70p__cuped_stddev,
    avg(metric_sum__view__vod_completion_70p__metric_covariate)::double
    as metric_sum__view__vod_completion_70p__pre_experiment_metric_result,
    stddev(metric_sum__view__vod_completion_70p__metric_covariate)::double
    as metric_sum__view__vod_completion_70p__pre_experiment_metric_stddev,
    avg(metric_sum__view__vod_daily_active__metric_result)::double as metric_sum__view__vod_daily_active__metric_result,
    stddev(metric_sum__view__vod_daily_active__metric_result)::double
    as metric_sum__view__vod_daily_active__metric_stddev,
    avg(metric_sum__view__vod_daily_active__cuped_result)::double as metric_sum__view__vod_daily_active__cuped_result,
    stddev(metric_sum__view__vod_daily_active__cuped_result)::double
    as metric_sum__view__vod_daily_active__cuped_stddev,
    avg(metric_sum__view__vod_daily_active__metric_covariate)::double
    as metric_sum__view__vod_daily_active__pre_experiment_metric_result,
    stddev(metric_sum__view__vod_daily_active__metric_covariate)::double
    as metric_sum__view__vod_daily_active__pre_experiment_metric_stddev,
    avg(metric_sum__qualified_view_days__metric_result)::double as metric_sum__qualified_view_days__metric_result,
    stddev(metric_sum__qualified_view_days__metric_result)::double as metric_sum__qualified_view_days__metric_stddev,
    avg(metric_sum__qualified_view_days__cuped_result)::double as metric_sum__qualified_view_days__cuped_result,
    stddev(metric_sum__qualified_view_days__cuped_result)::double as metric_sum__qualified_view_days__cuped_stddev,
    avg(metric_sum__qualified_view_days__metric_covariate)::double
    as metric_sum__qualified_view_days__pre_experiment_metric_result,
    stddev(metric_sum__qualified_view_days__metric_covariate)::double
    as metric_sum__qualified_view_days__pre_experiment_metric_stddev,
    avg(metric_sum__visit_days__metric_result)::double as metric_sum__visit_days__metric_result,
    stddev(metric_sum__visit_days__metric_result)::double as metric_sum__visit_days__metric_stddev,
    avg(metric_sum__visit_days__cuped_result)::double as metric_sum__visit_days__cuped_result,
    stddev(metric_sum__visit_days__cuped_result)::double as metric_sum__visit_days__cuped_stddev,
    avg(metric_sum__visit_days__metric_covariate)::double as metric_sum__visit_days__pre_experiment_metric_result,
    stddev(metric_sum__visit_days__metric_covariate)::double as metric_sum__visit_days__pre_experiment_metric_stddev,
    avg(metric_sum__add_to_queue__metric_result)::double as metric_sum__add_to_queue__metric_result,
    stddev(metric_sum__add_to_queue__metric_result)::double as metric_sum__add_to_queue__metric_stddev,
    avg(metric_sum__add_to_queue__cuped_result)::double as metric_sum__add_to_queue__cuped_result,
    stddev(metric_sum__add_to_queue__cuped_result)::double as metric_sum__add_to_queue__cuped_stddev,
    avg(metric_sum__add_to_queue__metric_covariate)::double as metric_sum__add_to_queue__pre_experiment_metric_result,
    stddev(metric_sum__add_to_queue__metric_covariate)::double
    as metric_sum__add_to_queue__pre_experiment_metric_stddev,
    avg(metric_sum__revenue__gross__metric_result)::double as metric_sum__revenue__gross__metric_result,
    stddev(metric_sum__revenue__gross__metric_result)::double as metric_sum__revenue__gross__metric_stddev,
    avg(metric_sum__revenue__gross__cuped_result)::double as metric_sum__revenue__gross__cuped_result,
    stddev(metric_sum__revenue__gross__cuped_result)::double as metric_sum__revenue__gross__cuped_stddev,
    avg(metric_sum__revenue__gross__metric_covariate)::double
    as metric_sum__revenue__gross__pre_experiment_metric_result,
    stddev(metric_sum__revenue__gross__metric_covariate)::double
    as metric_sum__revenue__gross__pre_experiment_metric_stddev,
    avg(metric_sum__revenue__gross_unbudgeted__metric_result)::double
    as metric_sum__revenue__gross_unbudgeted__metric_result,
    stddev(metric_sum__revenue__gross_unbudgeted__metric_result)::double
    as metric_sum__revenue__gross_unbudgeted__metric_stddev,
    avg(metric_sum__revenue__gross_unbudgeted__cuped_result)::double
    as metric_sum__revenue__gross_unbudgeted__cuped_result,
    stddev(metric_sum__revenue__gross_unbudgeted__cuped_result)::double
    as metric_sum__revenue__gross_unbudgeted__cuped_stddev,
    avg(metric_sum__revenue__gross_unbudgeted__metric_covariate)::double
    as metric_sum__revenue__gross_unbudgeted__pre_experiment_metric_result,
    stddev(metric_sum__revenue__gross_unbudgeted__metric_covariate)::double
    as metric_sum__revenue__gross_unbudgeted__pre_experiment_metric_stddev,
    avg(metric_sum__revenue__gross_budgeted__metric_result)::double
    as metric_sum__revenue__gross_budgeted__metric_result,
    stddev(metric_sum__revenue__gross_budgeted__metric_result)::double
    as metric_sum__revenue__gross_budgeted__metric_stddev,
    avg(metric_sum__revenue__gross_budgeted__cuped_result)::double as metric_sum__revenue__gross_budgeted__cuped_result,
    stddev(metric_sum__revenue__gross_budgeted__cuped_result)::double
    as metric_sum__revenue__gross_budgeted__cuped_stddev,
    avg(metric_sum__revenue__gross_budgeted__metric_covariate)::double
    as metric_sum__revenue__gross_budgeted__pre_experiment_metric_result,
    stddev(metric_sum__revenue__gross_budgeted__metric_covariate)::double
    as metric_sum__revenue__gross_budgeted__pre_experiment_metric_stddev,
    avg(metric_sum__revenue__gross_unclassified__metric_result)::double
    as metric_sum__revenue__gross_unclassified__metric_result,
    stddev(metric_sum__revenue__gross_unclassified__metric_result)::double
    as metric_sum__revenue__gross_unclassified__metric_stddev,
    avg(metric_sum__revenue__gross_unclassified__cuped_result)::double
    as metric_sum__revenue__gross_unclassified__cuped_result,
    stddev(metric_sum__revenue__gross_unclassified__cuped_result)::double
    as metric_sum__revenue__gross_unclassified__cuped_stddev,
    avg(metric_sum__revenue__gross_unclassified__metric_covariate)::double
    as metric_sum__revenue__gross_unclassified__pre_experiment_metric_result,
    stddev(metric_sum__revenue__gross_unclassified__metric_covariate)::double
    as metric_sum__revenue__gross_unclassified__pre_experiment_metric_stddev,
    avg(metric_sum__ad_impressions__metric_result)::double as metric_sum__ad_impressions__metric_result,
    stddev(metric_sum__ad_impressions__metric_result)::double as metric_sum__ad_impressions__metric_stddev,
    avg(metric_sum__ad_impressions__cuped_result)::double as metric_sum__ad_impressions__cuped_result,
    stddev(metric_sum__ad_impressions__cuped_result)::double as metric_sum__ad_impressions__cuped_stddev,
    avg(metric_sum__ad_impressions__metric_covariate)::double
    as metric_sum__ad_impressions__pre_experiment_metric_result,
    stddev(metric_sum__ad_impressions__metric_covariate)::double
    as metric_sum__ad_impressions__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__vod_ymal__metric_result)::double as metric_sum__tvt__vod_ymal__metric_result,
    stddev(metric_sum__tvt__vod_ymal__metric_result)::double as metric_sum__tvt__vod_ymal__metric_stddev,
    avg(metric_sum__tvt__vod_ymal__cuped_result)::double as metric_sum__tvt__vod_ymal__cuped_result,
    stddev(metric_sum__tvt__vod_ymal__cuped_result)::double as metric_sum__tvt__vod_ymal__cuped_stddev,
    avg(metric_sum__tvt__vod_ymal__metric_covariate)::double as metric_sum__tvt__vod_ymal__pre_experiment_metric_result,
    stddev(metric_sum__tvt__vod_ymal__metric_covariate)::double
    as metric_sum__tvt__vod_ymal__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__vod_featured__metric_result)::double as metric_sum__tvt__vod_featured__metric_result,
    stddev(metric_sum__tvt__vod_featured__metric_result)::double as metric_sum__tvt__vod_featured__metric_stddev,
    avg(metric_sum__tvt__vod_featured__cuped_result)::double as metric_sum__tvt__vod_featured__cuped_result,
    stddev(metric_sum__tvt__vod_featured__cuped_result)::double as metric_sum__tvt__vod_featured__cuped_stddev,
    avg(metric_sum__tvt__vod_featured__metric_covariate)::double
    as metric_sum__tvt__vod_featured__pre_experiment_metric_result,
    stddev(metric_sum__tvt__vod_featured__metric_covariate)::double
    as metric_sum__tvt__vod_featured__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__vod_capped_featured__metric_result)::double
    as metric_sum__tvt__vod_capped_featured__metric_result,
    stddev(metric_sum__tvt__vod_capped_featured__metric_result)::double
    as metric_sum__tvt__vod_capped_featured__metric_stddev,
    avg(metric_sum__tvt__vod_capped_featured__cuped_result)::double
    as metric_sum__tvt__vod_capped_featured__cuped_result,
    stddev(metric_sum__tvt__vod_capped_featured__cuped_result)::double
    as metric_sum__tvt__vod_capped_featured__cuped_stddev,
    avg(metric_sum__tvt__vod_capped_featured__metric_covariate)::double
    as metric_sum__tvt__vod_capped_featured__pre_experiment_metric_result,
    stddev(metric_sum__tvt__vod_capped_featured__metric_covariate)::double
    as metric_sum__tvt__vod_capped_featured__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__vod_movie_featured__metric_result)::double
    as metric_sum__tvt__vod_movie_featured__metric_result,
    stddev(metric_sum__tvt__vod_movie_featured__metric_result)::double
    as metric_sum__tvt__vod_movie_featured__metric_stddev,
    avg(metric_sum__tvt__vod_movie_featured__cuped_result)::double as metric_sum__tvt__vod_movie_featured__cuped_result,
    stddev(metric_sum__tvt__vod_movie_featured__cuped_result)::double
    as metric_sum__tvt__vod_movie_featured__cuped_stddev,
    avg(metric_sum__tvt__vod_movie_featured__metric_covariate)::double
    as metric_sum__tvt__vod_movie_featured__pre_experiment_metric_result,
    stddev(metric_sum__tvt__vod_movie_featured__metric_covariate)::double
    as metric_sum__tvt__vod_movie_featured__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__vod_series_featured__metric_result)::double
    as metric_sum__tvt__vod_series_featured__metric_result,
    stddev(metric_sum__tvt__vod_series_featured__metric_result)::double
    as metric_sum__tvt__vod_series_featured__metric_stddev,
    avg(metric_sum__tvt__vod_series_featured__cuped_result)::double
    as metric_sum__tvt__vod_series_featured__cuped_result,
    stddev(metric_sum__tvt__vod_series_featured__cuped_result)::double
    as metric_sum__tvt__vod_series_featured__cuped_stddev,
    avg(metric_sum__tvt__vod_series_featured__metric_covariate)::double
    as metric_sum__tvt__vod_series_featured__pre_experiment_metric_result,
    stddev(metric_sum__tvt__vod_series_featured__metric_covariate)::double
    as metric_sum__tvt__vod_series_featured__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__vod_cw__metric_result)::double as metric_sum__tvt__vod_cw__metric_result,
    stddev(metric_sum__tvt__vod_cw__metric_result)::double as metric_sum__tvt__vod_cw__metric_stddev,
    avg(metric_sum__tvt__vod_cw__cuped_result)::double as metric_sum__tvt__vod_cw__cuped_result,
    stddev(metric_sum__tvt__vod_cw__cuped_result)::double as metric_sum__tvt__vod_cw__cuped_stddev,
    avg(metric_sum__tvt__vod_cw__metric_covariate)::double as metric_sum__tvt__vod_cw__pre_experiment_metric_result,
    stddev(metric_sum__tvt__vod_cw__metric_covariate)::double as metric_sum__tvt__vod_cw__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__vod_capped_cw__metric_result)::double as metric_sum__tvt__vod_capped_cw__metric_result,
    stddev(metric_sum__tvt__vod_capped_cw__metric_result)::double as metric_sum__tvt__vod_capped_cw__metric_stddev,
    avg(metric_sum__tvt__vod_capped_cw__cuped_result)::double as metric_sum__tvt__vod_capped_cw__cuped_result,
    stddev(metric_sum__tvt__vod_capped_cw__cuped_result)::double as metric_sum__tvt__vod_capped_cw__cuped_stddev,
    avg(metric_sum__tvt__vod_capped_cw__metric_covariate)::double
    as metric_sum__tvt__vod_capped_cw__pre_experiment_metric_result,
    stddev(metric_sum__tvt__vod_capped_cw__metric_covariate)::double
    as metric_sum__tvt__vod_capped_cw__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__vod_movie_cw__metric_result)::double as metric_sum__tvt__vod_movie_cw__metric_result,
    stddev(metric_sum__tvt__vod_movie_cw__metric_result)::double as metric_sum__tvt__vod_movie_cw__metric_stddev,
    avg(metric_sum__tvt__vod_movie_cw__cuped_result)::double as metric_sum__tvt__vod_movie_cw__cuped_result,
    stddev(metric_sum__tvt__vod_movie_cw__cuped_result)::double as metric_sum__tvt__vod_movie_cw__cuped_stddev,
    avg(metric_sum__tvt__vod_movie_cw__metric_covariate)::double
    as metric_sum__tvt__vod_movie_cw__pre_experiment_metric_result,
    stddev(metric_sum__tvt__vod_movie_cw__metric_covariate)::double
    as metric_sum__tvt__vod_movie_cw__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__vod_series_cw__metric_result)::double as metric_sum__tvt__vod_series_cw__metric_result,
    stddev(metric_sum__tvt__vod_series_cw__metric_result)::double as metric_sum__tvt__vod_series_cw__metric_stddev,
    avg(metric_sum__tvt__vod_series_cw__cuped_result)::double as metric_sum__tvt__vod_series_cw__cuped_result,
    stddev(metric_sum__tvt__vod_series_cw__cuped_result)::double as metric_sum__tvt__vod_series_cw__cuped_stddev,
    avg(metric_sum__tvt__vod_series_cw__metric_covariate)::double
    as metric_sum__tvt__vod_series_cw__pre_experiment_metric_result,
    stddev(metric_sum__tvt__vod_series_cw__metric_covariate)::double
    as metric_sum__tvt__vod_series_cw__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__vod_cast__metric_result)::double as metric_sum__tvt__vod_cast__metric_result,
    stddev(metric_sum__tvt__vod_cast__metric_result)::double as metric_sum__tvt__vod_cast__metric_stddev,
    avg(metric_sum__tvt__vod_cast__cuped_result)::double as metric_sum__tvt__vod_cast__cuped_result,
    stddev(metric_sum__tvt__vod_cast__cuped_result)::double as metric_sum__tvt__vod_cast__cuped_stddev,
    avg(metric_sum__tvt__vod_cast__metric_covariate)::double as metric_sum__tvt__vod_cast__pre_experiment_metric_result,
    stddev(metric_sum__tvt__vod_cast__metric_covariate)::double
    as metric_sum__tvt__vod_cast__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__vod_cast_total__metric_result)::double as metric_sum__tvt__vod_cast_total__metric_result,
    stddev(metric_sum__tvt__vod_cast_total__metric_result)::double as metric_sum__tvt__vod_cast_total__metric_stddev,
    avg(metric_sum__tvt__vod_cast_total__cuped_result)::double as metric_sum__tvt__vod_cast_total__cuped_result,
    stddev(metric_sum__tvt__vod_cast_total__cuped_result)::double as metric_sum__tvt__vod_cast_total__cuped_stddev,
    avg(metric_sum__tvt__vod_cast_total__metric_covariate)::double
    as metric_sum__tvt__vod_cast_total__pre_experiment_metric_result,
    stddev(metric_sum__tvt__vod_cast_total__metric_covariate)::double
    as metric_sum__tvt__vod_cast_total__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__vod_spanish__metric_result)::double as metric_sum__tvt__vod_spanish__metric_result,
    stddev(metric_sum__tvt__vod_spanish__metric_result)::double as metric_sum__tvt__vod_spanish__metric_stddev,
    avg(metric_sum__tvt__vod_spanish__cuped_result)::double as metric_sum__tvt__vod_spanish__cuped_result,
    stddev(metric_sum__tvt__vod_spanish__cuped_result)::double as metric_sum__tvt__vod_spanish__cuped_stddev,
    avg(metric_sum__tvt__vod_spanish__metric_covariate)::double
    as metric_sum__tvt__vod_spanish__pre_experiment_metric_result,
    stddev(metric_sum__tvt__vod_spanish__metric_covariate)::double
    as metric_sum__tvt__vod_spanish__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__vod_capped_spanish__metric_result)::double
    as metric_sum__tvt__vod_capped_spanish__metric_result,
    stddev(metric_sum__tvt__vod_capped_spanish__metric_result)::double
    as metric_sum__tvt__vod_capped_spanish__metric_stddev,
    avg(metric_sum__tvt__vod_capped_spanish__cuped_result)::double as metric_sum__tvt__vod_capped_spanish__cuped_result,
    stddev(metric_sum__tvt__vod_capped_spanish__cuped_result)::double
    as metric_sum__tvt__vod_capped_spanish__cuped_stddev,
    avg(metric_sum__tvt__vod_capped_spanish__metric_covariate)::double
    as metric_sum__tvt__vod_capped_spanish__pre_experiment_metric_result,
    stddev(metric_sum__tvt__vod_capped_spanish__metric_covariate)::double
    as metric_sum__tvt__vod_capped_spanish__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__vod_search__metric_result)::double as metric_sum__tvt__vod_search__metric_result,
    stddev(metric_sum__tvt__vod_search__metric_result)::double as metric_sum__tvt__vod_search__metric_stddev,
    avg(metric_sum__tvt__vod_search__cuped_result)::double as metric_sum__tvt__vod_search__cuped_result,
    stddev(metric_sum__tvt__vod_search__cuped_result)::double as metric_sum__tvt__vod_search__cuped_stddev,
    avg(metric_sum__tvt__vod_search__metric_covariate)::double
    as metric_sum__tvt__vod_search__pre_experiment_metric_result,
    stddev(metric_sum__tvt__vod_search__metric_covariate)::double
    as metric_sum__tvt__vod_search__pre_experiment_metric_stddev,
    avg(metric_sum__player__exits__metric_result)::double as metric_sum__player__exits__metric_result,
    stddev(metric_sum__player__exits__metric_result)::double as metric_sum__player__exits__metric_stddev,
    avg(metric_sum__player__exits__cuped_result)::double as metric_sum__player__exits__cuped_result,
    stddev(metric_sum__player__exits__cuped_result)::double as metric_sum__player__exits__cuped_stddev,
    avg(metric_sum__player__exits__metric_covariate)::double as metric_sum__player__exits__pre_experiment_metric_result,
    stddev(metric_sum__player__exits__metric_covariate)::double
    as metric_sum__player__exits__pre_experiment_metric_stddev,
    avg(metric_sum__player__seeks__metric_result)::double as metric_sum__player__seeks__metric_result,
    stddev(metric_sum__player__seeks__metric_result)::double as metric_sum__player__seeks__metric_stddev,
    avg(metric_sum__player__seeks__cuped_result)::double as metric_sum__player__seeks__cuped_result,
    stddev(metric_sum__player__seeks__cuped_result)::double as metric_sum__player__seeks__cuped_stddev,
    avg(metric_sum__player__seeks__metric_covariate)::double as metric_sum__player__seeks__pre_experiment_metric_result,
    stddev(metric_sum__player__seeks__metric_covariate)::double
    as metric_sum__player__seeks__pre_experiment_metric_stddev,
    avg(metric_sum__device_reactions__metric_result)::double as metric_sum__device_reactions__metric_result,
    stddev(metric_sum__device_reactions__metric_result)::double as metric_sum__device_reactions__metric_stddev,
    avg(metric_sum__device_reactions__cuped_result)::double as metric_sum__device_reactions__cuped_result,
    stddev(metric_sum__device_reactions__cuped_result)::double as metric_sum__device_reactions__cuped_stddev,
    avg(metric_sum__device_reactions__metric_covariate)::double
    as metric_sum__device_reactions__pre_experiment_metric_result,
    stddev(metric_sum__device_reactions__metric_covariate)::double
    as metric_sum__device_reactions__pre_experiment_metric_stddev,
    avg(metric_max__conversion__metric_result)::double as metric_max__conversion__metric_result,
    stddev(metric_max__conversion__metric_result)::double as metric_max__conversion__metric_stddev,
    avg(metric_max__conversion__cuped_result)::double as metric_max__conversion__cuped_result,
    stddev(metric_max__conversion__cuped_result)::double as metric_max__conversion__cuped_stddev,
    avg(metric_max__conversion__metric_covariate)::double as metric_max__conversion__pre_experiment_metric_result,
    stddev(metric_max__conversion__metric_covariate)::double as metric_max__conversion__pre_experiment_metric_stddev,
    avg(metric_max__conversion__5min__metric_result)::double as metric_max__conversion__5min__metric_result,
    stddev(metric_max__conversion__5min__metric_result)::double as metric_max__conversion__5min__metric_stddev,
    avg(metric_max__conversion__5min__cuped_result)::double as metric_max__conversion__5min__cuped_result,
    stddev(metric_max__conversion__5min__cuped_result)::double as metric_max__conversion__5min__cuped_stddev,
    avg(metric_max__conversion__5min__metric_covariate)::double
    as metric_max__conversion__5min__pre_experiment_metric_result,
    stddev(metric_max__conversion__5min__metric_covariate)::double
    as metric_max__conversion__5min__pre_experiment_metric_stddev,
    avg(metric_max__conversion__20min__metric_result)::double as metric_max__conversion__20min__metric_result,
    stddev(metric_max__conversion__20min__metric_result)::double as metric_max__conversion__20min__metric_stddev,
    avg(metric_max__conversion__20min__cuped_result)::double as metric_max__conversion__20min__cuped_result,
    stddev(metric_max__conversion__20min__cuped_result)::double as metric_max__conversion__20min__cuped_stddev,
    avg(metric_max__conversion__20min__metric_covariate)::double
    as metric_max__conversion__20min__pre_experiment_metric_result,
    stddev(metric_max__conversion__20min__metric_covariate)::double
    as metric_max__conversion__20min__pre_experiment_metric_stddev,
    avg(metric_max__conversion__vod__metric_result)::double as metric_max__conversion__vod__metric_result,
    stddev(metric_max__conversion__vod__metric_result)::double as metric_max__conversion__vod__metric_stddev,
    avg(metric_max__conversion__vod__cuped_result)::double as metric_max__conversion__vod__cuped_result,
    stddev(metric_max__conversion__vod__cuped_result)::double as metric_max__conversion__vod__cuped_stddev,
    avg(metric_max__conversion__vod__metric_covariate)::double
    as metric_max__conversion__vod__pre_experiment_metric_result,
    stddev(metric_max__conversion__vod__metric_covariate)::double
    as metric_max__conversion__vod__pre_experiment_metric_stddev,
    avg(metric_max__conversion__vod_5min__metric_result)::double as metric_max__conversion__vod_5min__metric_result,
    stddev(metric_max__conversion__vod_5min__metric_result)::double as metric_max__conversion__vod_5min__metric_stddev,
    avg(metric_max__conversion__vod_5min__cuped_result)::double as metric_max__conversion__vod_5min__cuped_result,
    stddev(metric_max__conversion__vod_5min__cuped_result)::double as metric_max__conversion__vod_5min__cuped_stddev,
    avg(metric_max__conversion__vod_5min__metric_covariate)::double
    as metric_max__conversion__vod_5min__pre_experiment_metric_result,
    stddev(metric_max__conversion__vod_5min__metric_covariate)::double
    as metric_max__conversion__vod_5min__pre_experiment_metric_stddev,
    avg(metric_max__conversion__linear__metric_result)::double as metric_max__conversion__linear__metric_result,
    stddev(metric_max__conversion__linear__metric_result)::double as metric_max__conversion__linear__metric_stddev,
    avg(metric_max__conversion__linear__cuped_result)::double as metric_max__conversion__linear__cuped_result,
    stddev(metric_max__conversion__linear__cuped_result)::double as metric_max__conversion__linear__cuped_stddev,
    avg(metric_max__conversion__linear__metric_covariate)::double
    as metric_max__conversion__linear__pre_experiment_metric_result,
    stddev(metric_max__conversion__linear__metric_covariate)::double
    as metric_max__conversion__linear__pre_experiment_metric_stddev,
    avg(metric_max__conversion__linear_5min__metric_result)::double
    as metric_max__conversion__linear_5min__metric_result,
    stddev(metric_max__conversion__linear_5min__metric_result)::double
    as metric_max__conversion__linear_5min__metric_stddev,
    avg(metric_max__conversion__linear_5min__cuped_result)::double as metric_max__conversion__linear_5min__cuped_result,
    stddev(metric_max__conversion__linear_5min__cuped_result)::double
    as metric_max__conversion__linear_5min__cuped_stddev,
    avg(metric_max__conversion__linear_5min__metric_covariate)::double
    as metric_max__conversion__linear_5min__pre_experiment_metric_result,
    stddev(metric_max__conversion__linear_5min__metric_covariate)::double
    as metric_max__conversion__linear_5min__pre_experiment_metric_stddev,
    avg(metric_max__conversion__series_5min__metric_result)::double
    as metric_max__conversion__series_5min__metric_result,
    stddev(metric_max__conversion__series_5min__metric_result)::double
    as metric_max__conversion__series_5min__metric_stddev,
    avg(metric_max__conversion__series_5min__cuped_result)::double as metric_max__conversion__series_5min__cuped_result,
    stddev(metric_max__conversion__series_5min__cuped_result)::double
    as metric_max__conversion__series_5min__cuped_stddev,
    avg(metric_max__conversion__series_5min__metric_covariate)::double
    as metric_max__conversion__series_5min__pre_experiment_metric_result,
    stddev(metric_max__conversion__series_5min__metric_covariate)::double
    as metric_max__conversion__series_5min__pre_experiment_metric_stddev,
    avg(metric_max__conversion__movie_5min__metric_result)::double as metric_max__conversion__movie_5min__metric_result,
    stddev(metric_max__conversion__movie_5min__metric_result)::double
    as metric_max__conversion__movie_5min__metric_stddev,
    avg(metric_max__conversion__movie_5min__cuped_result)::double as metric_max__conversion__movie_5min__cuped_result,
    stddev(metric_max__conversion__movie_5min__cuped_result)::double
    as metric_max__conversion__movie_5min__cuped_stddev,
    avg(metric_max__conversion__movie_5min__metric_covariate)::double
    as metric_max__conversion__movie_5min__pre_experiment_metric_result,
    stddev(metric_max__conversion__movie_5min__metric_covariate)::double
    as metric_max__conversion__movie_5min__pre_experiment_metric_stddev,
    avg(metric_max__conversion__homepage_5min__metric_result)::double
    as metric_max__conversion__homepage_5min__metric_result,
    stddev(metric_max__conversion__homepage_5min__metric_result)::double
    as metric_max__conversion__homepage_5min__metric_stddev,
    avg(metric_max__conversion__homepage_5min__cuped_result)::double
    as metric_max__conversion__homepage_5min__cuped_result,
    stddev(metric_max__conversion__homepage_5min__cuped_result)::double
    as metric_max__conversion__homepage_5min__cuped_stddev,
    avg(metric_max__conversion__homepage_5min__metric_covariate)::double
    as metric_max__conversion__homepage_5min__pre_experiment_metric_result,
    stddev(metric_max__conversion__homepage_5min__metric_covariate)::double
    as metric_max__conversion__homepage_5min__pre_experiment_metric_stddev,
    avg(metric_max__conversion__search_5min__metric_result)::double
    as metric_max__conversion__search_5min__metric_result,
    stddev(metric_max__conversion__search_5min__metric_result)::double
    as metric_max__conversion__search_5min__metric_stddev,
    avg(metric_max__conversion__search_5min__cuped_result)::double as metric_max__conversion__search_5min__cuped_result,
    stddev(metric_max__conversion__search_5min__cuped_result)::double
    as metric_max__conversion__search_5min__cuped_stddev,
    avg(metric_max__conversion__search_5min__metric_covariate)::double
    as metric_max__conversion__search_5min__pre_experiment_metric_result,
    stddev(metric_max__conversion__search_5min__metric_covariate)::double
    as metric_max__conversion__search_5min__pre_experiment_metric_stddev,
    avg(metric_max__registration__did_signup__metric_result)::double
    as metric_max__registration__did_signup__metric_result,
    stddev(metric_max__registration__did_signup__metric_result)::double
    as metric_max__registration__did_signup__metric_stddev,
    avg(metric_max__registration__did_signup__cuped_result)::double
    as metric_max__registration__did_signup__cuped_result,
    stddev(metric_max__registration__did_signup__cuped_result)::double
    as metric_max__registration__did_signup__cuped_stddev,
    avg(metric_max__registration__did_signup__metric_covariate)::double
    as metric_max__registration__did_signup__pre_experiment_metric_result,
    stddev(metric_max__registration__did_signup__metric_covariate)::double
    as metric_max__registration__did_signup__pre_experiment_metric_stddev,
    avg(metric_max__registration__did_activate__metric_result)::double
    as metric_max__registration__did_activate__metric_result,
    stddev(metric_max__registration__did_activate__metric_result)::double
    as metric_max__registration__did_activate__metric_stddev,
    avg(metric_max__registration__did_activate__cuped_result)::double
    as metric_max__registration__did_activate__cuped_result,
    stddev(metric_max__registration__did_activate__cuped_result)::double
    as metric_max__registration__did_activate__cuped_stddev,
    avg(metric_max__registration__did_activate__metric_covariate)::double
    as metric_max__registration__did_activate__pre_experiment_metric_result,
    stddev(metric_max__registration__did_activate__metric_covariate)::double
    as metric_max__registration__did_activate__pre_experiment_metric_stddev,
    avg(metric_max__registration__did_authenticate__metric_result)::double
    as metric_max__registration__did_authenticate__metric_result,
    stddev(metric_max__registration__did_authenticate__metric_result)::double
    as metric_max__registration__did_authenticate__metric_stddev,
    avg(metric_max__registration__did_authenticate__cuped_result)::double
    as metric_max__registration__did_authenticate__cuped_result,
    stddev(metric_max__registration__did_authenticate__cuped_result)::double
    as metric_max__registration__did_authenticate__cuped_stddev,
    avg(metric_max__registration__did_authenticate__metric_covariate)::double
    as metric_max__registration__did_authenticate__pre_experiment_metric_result,
    stddev(metric_max__registration__did_authenticate__metric_covariate)::double
    as metric_max__registration__did_authenticate__pre_experiment_metric_stddev,
    avg(metric_max__search__did_search__metric_result)::double as metric_max__search__did_search__metric_result,
    stddev(metric_max__search__did_search__metric_result)::double as metric_max__search__did_search__metric_stddev,
    avg(metric_max__search__did_search__cuped_result)::double as metric_max__search__did_search__cuped_result,
    stddev(metric_max__search__did_search__cuped_result)::double as metric_max__search__did_search__cuped_stddev,
    avg(metric_max__search__did_search__metric_covariate)::double
    as metric_max__search__did_search__pre_experiment_metric_result,
    stddev(metric_max__search__did_search__metric_covariate)::double
    as metric_max__search__did_search__pre_experiment_metric_stddev,
    avg(metric_max__cast__did_cast__metric_result)::double as metric_max__cast__did_cast__metric_result,
    stddev(metric_max__cast__did_cast__metric_result)::double as metric_max__cast__did_cast__metric_stddev,
    avg(metric_max__cast__did_cast__cuped_result)::double as metric_max__cast__did_cast__cuped_result,
    stddev(metric_max__cast__did_cast__cuped_result)::double as metric_max__cast__did_cast__cuped_stddev,
    avg(metric_max__cast__did_cast__metric_covariate)::double
    as metric_max__cast__did_cast__pre_experiment_metric_result,
    stddev(metric_max__cast__did_cast__metric_covariate)::double
    as metric_max__cast__did_cast__pre_experiment_metric_stddev,
    avg(metric_max__power_viewers__metric_result)::double as metric_max__power_viewers__metric_result,
    stddev(metric_max__power_viewers__metric_result)::double as metric_max__power_viewers__metric_stddev,
    avg(metric_max__power_viewers__cuped_result)::double as metric_max__power_viewers__cuped_result,
    stddev(metric_max__power_viewers__cuped_result)::double as metric_max__power_viewers__cuped_stddev,
    avg(metric_max__power_viewers__metric_covariate)::double as metric_max__power_viewers__pre_experiment_metric_result,
    stddev(metric_max__power_viewers__metric_covariate)::double
    as metric_max__power_viewers__pre_experiment_metric_stddev,
    avg(metric_sumgreaterthan__retention__metric_result)::double as metric_sumgreaterthan__retention__metric_result,
    stddev(metric_sumgreaterthan__retention__metric_result)::double as metric_sumgreaterthan__retention__metric_stddev,
    avg(metric_sumgreaterthan__retention__cuped_result)::double as metric_sumgreaterthan__retention__cuped_result,
    stddev(metric_sumgreaterthan__retention__cuped_result)::double as metric_sumgreaterthan__retention__cuped_stddev,
    avg(metric_sumgreaterthan__retention__metric_covariate)::double
    as metric_sumgreaterthan__retention__pre_experiment_metric_result,
    stddev(metric_sumgreaterthan__retention__metric_covariate)::double
    as metric_sumgreaterthan__retention__pre_experiment_metric_stddev,
    avg(metric_sumgreaterthan__retention__vod__metric_result)::double
    as metric_sumgreaterthan__retention__vod__metric_result,
    stddev(metric_sumgreaterthan__retention__vod__metric_result)::double
    as metric_sumgreaterthan__retention__vod__metric_stddev,
    avg(metric_sumgreaterthan__retention__vod__cuped_result)::double
    as metric_sumgreaterthan__retention__vod__cuped_result,
    stddev(metric_sumgreaterthan__retention__vod__cuped_result)::double
    as metric_sumgreaterthan__retention__vod__cuped_stddev,
    avg(metric_sumgreaterthan__retention__vod__metric_covariate)::double
    as metric_sumgreaterthan__retention__vod__pre_experiment_metric_result,
    stddev(metric_sumgreaterthan__retention__vod__metric_covariate)::double
    as metric_sumgreaterthan__retention__vod__pre_experiment_metric_stddev,
    avg(metric_sumgreaterthan__retention__linear__metric_result)::double
    as metric_sumgreaterthan__retention__linear__metric_result,
    stddev(metric_sumgreaterthan__retention__linear__metric_result)::double
    as metric_sumgreaterthan__retention__linear__metric_stddev,
    avg(metric_sumgreaterthan__retention__linear__cuped_result)::double
    as metric_sumgreaterthan__retention__linear__cuped_result,
    stddev(metric_sumgreaterthan__retention__linear__cuped_result)::double
    as metric_sumgreaterthan__retention__linear__cuped_stddev,
    avg(metric_sumgreaterthan__retention__linear__metric_covariate)::double
    as metric_sumgreaterthan__retention__linear__pre_experiment_metric_result,
    stddev(metric_sumgreaterthan__retention__linear__metric_covariate)::double
    as metric_sumgreaterthan__retention__linear__pre_experiment_metric_stddev,
    avg(metric_sumgreaterthan__aha_moment_conversion__metric_result)::double
    as metric_sumgreaterthan__aha_moment_conversion__metric_result,
    stddev(metric_sumgreaterthan__aha_moment_conversion__metric_result)::double
    as metric_sumgreaterthan__aha_moment_conversion__metric_stddev,
    avg(metric_sumgreaterthan__aha_moment_conversion__cuped_result)::double
    as metric_sumgreaterthan__aha_moment_conversion__cuped_result,
    stddev(metric_sumgreaterthan__aha_moment_conversion__cuped_result)::double
    as metric_sumgreaterthan__aha_moment_conversion__cuped_stddev,
    avg(metric_sumgreaterthan__aha_moment_conversion__metric_covariate)::double
    as metric_sumgreaterthan__aha_moment_conversion__pre_experiment_metric_result,
    stddev(metric_sumgreaterthan__aha_moment_conversion__metric_covariate)::double
    as metric_sumgreaterthan__aha_moment_conversion__pre_experiment_metric_stddev,
    avg(metric_sumgreaterthan__retention__new_viewers__metric_result)::double
    as metric_sumgreaterthan__retention__new_viewers__metric_result,
    stddev(metric_sumgreaterthan__retention__new_viewers__metric_result)::double
    as metric_sumgreaterthan__retention__new_viewers__metric_stddev,
    avg(metric_sumgreaterthan__retention__new_viewers__cuped_result)::double
    as metric_sumgreaterthan__retention__new_viewers__cuped_result,
    stddev(metric_sumgreaterthan__retention__new_viewers__cuped_result)::double
    as metric_sumgreaterthan__retention__new_viewers__cuped_stddev,
    avg(metric_sumgreaterthan__retention__new_viewers__metric_covariate)::double
    as metric_sumgreaterthan__retention__new_viewers__pre_experiment_metric_result,
    stddev(metric_sumgreaterthan__retention__new_viewers__metric_covariate)::double
    as metric_sumgreaterthan__retention__new_viewers__pre_experiment_metric_stddev,
    avg(metric_max__conversion__new_visitors__metric_result)::double
    as metric_max__conversion__new_visitors__metric_result,
    stddev(metric_max__conversion__new_visitors__metric_result)::double
    as metric_max__conversion__new_visitors__metric_stddev,
    avg(metric_max__conversion__new_visitors__cuped_result)::double
    as metric_max__conversion__new_visitors__cuped_result,
    stddev(metric_max__conversion__new_visitors__cuped_result)::double
    as metric_max__conversion__new_visitors__cuped_stddev,
    avg(metric_max__conversion__new_visitors__metric_covariate)::double
    as metric_max__conversion__new_visitors__pre_experiment_metric_result,
    stddev(metric_max__conversion__new_visitors__metric_covariate)::double
    as metric_max__conversion__new_visitors__pre_experiment_metric_stddev,
    avg(metric_max__conversion__20min__new_visitors__metric_result)::double
    as metric_max__conversion__20min__new_visitors__metric_result,
    stddev(metric_max__conversion__20min__new_visitors__metric_result)::double
    as metric_max__conversion__20min__new_visitors__metric_stddev,
    avg(metric_max__conversion__20min__new_visitors__cuped_result)::double
    as metric_max__conversion__20min__new_visitors__cuped_result,
    stddev(metric_max__conversion__20min__new_visitors__cuped_result)::double
    as metric_max__conversion__20min__new_visitors__cuped_stddev,
    avg(metric_max__conversion__20min__new_visitors__metric_covariate)::double
    as metric_max__conversion__20min__new_visitors__pre_experiment_metric_result,
    stddev(metric_max__conversion__20min__new_visitors__metric_covariate)::double
    as metric_max__conversion__20min__new_visitors__pre_experiment_metric_stddev,
    avg(metric_max__conversion__5min__new_visitors__metric_result)::double
    as metric_max__conversion__5min__new_visitors__metric_result,
    stddev(metric_max__conversion__5min__new_visitors__metric_result)::double
    as metric_max__conversion__5min__new_visitors__metric_stddev,
    avg(metric_max__conversion__5min__new_visitors__cuped_result)::double
    as metric_max__conversion__5min__new_visitors__cuped_result,
    stddev(metric_max__conversion__5min__new_visitors__cuped_result)::double
    as metric_max__conversion__5min__new_visitors__cuped_stddev,
    avg(metric_max__conversion__5min__new_visitors__metric_covariate)::double
    as metric_max__conversion__5min__new_visitors__pre_experiment_metric_result,
    stddev(metric_max__conversion__5min__new_visitors__metric_covariate)::double
    as metric_max__conversion__5min__new_visitors__pre_experiment_metric_stddev,
    avg(metric_max__conversion__linear__new_visitors__metric_result)::double
    as metric_max__conversion__linear__new_visitors__metric_result,
    stddev(metric_max__conversion__linear__new_visitors__metric_result)::double
    as metric_max__conversion__linear__new_visitors__metric_stddev,
    avg(metric_max__conversion__linear__new_visitors__cuped_result)::double
    as metric_max__conversion__linear__new_visitors__cuped_result,
    stddev(metric_max__conversion__linear__new_visitors__cuped_result)::double
    as metric_max__conversion__linear__new_visitors__cuped_stddev,
    avg(metric_max__conversion__linear__new_visitors__metric_covariate)::double
    as metric_max__conversion__linear__new_visitors__pre_experiment_metric_result,
    stddev(metric_max__conversion__linear__new_visitors__metric_covariate)::double
    as metric_max__conversion__linear__new_visitors__pre_experiment_metric_stddev,
    avg(metric_max__conversion__linear_5min__new_visitors__metric_result)::double
    as metric_max__conversion__linear_5min__new_visitors__metric_result,
    stddev(metric_max__conversion__linear_5min__new_visitors__metric_result)::double
    as metric_max__conversion__linear_5min__new_visitors__metric_stddev,
    avg(metric_max__conversion__linear_5min__new_visitors__cuped_result)::double
    as metric_max__conversion__linear_5min__new_visitors__cuped_result,
    stddev(metric_max__conversion__linear_5min__new_visitors__cuped_result)::double
    as metric_max__conversion__linear_5min__new_visitors__cuped_stddev,
    avg(metric_max__conversion__linear_5min__new_visitors__metric_covariate)::double
    as metric_max__conversion__linear_5min__new_visitors__pre_experiment_metric_result,
    stddev(metric_max__conversion__linear_5min__new_visitors__metric_covariate)::double
    as metric_max__conversion__linear_5min__new_visitors__pre_experiment_metric_stddev,
    avg(metric_max__conversion__vod__new_visitors__metric_result)::double
    as metric_max__conversion__vod__new_visitors__metric_result,
    stddev(metric_max__conversion__vod__new_visitors__metric_result)::double
    as metric_max__conversion__vod__new_visitors__metric_stddev,
    avg(metric_max__conversion__vod__new_visitors__cuped_result)::double
    as metric_max__conversion__vod__new_visitors__cuped_result,
    stddev(metric_max__conversion__vod__new_visitors__cuped_result)::double
    as metric_max__conversion__vod__new_visitors__cuped_stddev,
    avg(metric_max__conversion__vod__new_visitors__metric_covariate)::double
    as metric_max__conversion__vod__new_visitors__pre_experiment_metric_result,
    stddev(metric_max__conversion__vod__new_visitors__metric_covariate)::double
    as metric_max__conversion__vod__new_visitors__pre_experiment_metric_stddev,
    avg(metric_max__conversion__vod_5min__new_visitors__metric_result)::double
    as metric_max__conversion__vod_5min__new_visitors__metric_result,
    stddev(metric_max__conversion__vod_5min__new_visitors__metric_result)::double
    as metric_max__conversion__vod_5min__new_visitors__metric_stddev,
    avg(metric_max__conversion__vod_5min__new_visitors__cuped_result)::double
    as metric_max__conversion__vod_5min__new_visitors__cuped_result,
    stddev(metric_max__conversion__vod_5min__new_visitors__cuped_result)::double
    as metric_max__conversion__vod_5min__new_visitors__cuped_stddev,
    avg(metric_max__conversion__vod_5min__new_visitors__metric_covariate)::double
    as metric_max__conversion__vod_5min__new_visitors__pre_experiment_metric_result,
    stddev(metric_max__conversion__vod_5min__new_visitors__metric_covariate)::double
    as metric_max__conversion__vod_5min__new_visitors__pre_experiment_metric_stddev,
    avg(metric_max__registration__did_activate__new_visitors__metric_result)::double
    as metric_max__registration__did_activate__new_visitors__metric_result,
    stddev(metric_max__registration__did_activate__new_visitors__metric_result)::double
    as metric_max__registration__did_activate__new_visitors__metric_stddev,
    avg(metric_max__registration__did_activate__new_visitors__cuped_result)::double
    as metric_max__registration__did_activate__new_visitors__cuped_result,
    stddev(metric_max__registration__did_activate__new_visitors__cuped_result)::double
    as metric_max__registration__did_activate__new_visitors__cuped_stddev,
    avg(metric_max__registration__did_activate__new_visitors__metric_covariate)::double
    as metric_max__registration__did_activate__new_visitors__pre_experiment_metric_result,
    stddev(metric_max__registration__did_activate__new_visitors__metric_covariate)::double
    as metric_max__registration__did_activate__new_visitors__pre_experiment_metric_stddev,
    avg(metric_max__registration__did_authenticate__new_visitors__metric_result)::double
    as metric_max__registration__did_authenticate__new_visitors__metric_result,
    stddev(metric_max__registration__did_authenticate__new_visitors__metric_result)::double
    as metric_max__registration__did_authenticate__new_visitors__metric_stddev,
    avg(metric_max__registration__did_authenticate__new_visitors__cuped_result)::double
    as metric_max__registration__did_authenticate__new_visitors__cuped_result,
    stddev(metric_max__registration__did_authenticate__new_visitors__cuped_result)::double
    as metric_max__registration__did_authenticate__new_visitors__cuped_stddev,
    avg(metric_max__registration__did_authenticate__new_visitors__metric_covariate)::double
    as metric_max__registration__did_authenticate__new_visitors__pre_experiment_metric_result,
    stddev(metric_max__registration__did_authenticate__new_visitors__metric_covariate)::double
    as metric_max__registration__did_authenticate__new_visitors__pre_experiment_metric_stddev,
    avg(metric_max__registration__did_signup__new_visitors__metric_result)::double
    as metric_max__registration__did_signup__new_visitors__metric_result,
    stddev(metric_max__registration__did_signup__new_visitors__metric_result)::double
    as metric_max__registration__did_signup__new_visitors__metric_stddev,
    avg(metric_max__registration__did_signup__new_visitors__cuped_result)::double
    as metric_max__registration__did_signup__new_visitors__cuped_result,
    stddev(metric_max__registration__did_signup__new_visitors__cuped_result)::double
    as metric_max__registration__did_signup__new_visitors__cuped_stddev,
    avg(metric_max__registration__did_signup__new_visitors__metric_covariate)::double
    as metric_max__registration__did_signup__new_visitors__pre_experiment_metric_result,
    stddev(metric_max__registration__did_signup__new_visitors__metric_covariate)::double
    as metric_max__registration__did_signup__new_visitors__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__capped__new_visitors__metric_result)::double
    as metric_sum__tvt__capped__new_visitors__metric_result,
    stddev(metric_sum__tvt__capped__new_visitors__metric_result)::double
    as metric_sum__tvt__capped__new_visitors__metric_stddev,
    avg(metric_sum__tvt__capped__new_visitors__cuped_result)::double
    as metric_sum__tvt__capped__new_visitors__cuped_result,
    stddev(metric_sum__tvt__capped__new_visitors__cuped_result)::double
    as metric_sum__tvt__capped__new_visitors__cuped_stddev,
    avg(metric_sum__tvt__capped__new_visitors__metric_covariate)::double
    as metric_sum__tvt__capped__new_visitors__pre_experiment_metric_result,
    stddev(metric_sum__tvt__capped__new_visitors__metric_covariate)::double
    as metric_sum__tvt__capped__new_visitors__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__linear_capped__new_visitors__metric_result)::double
    as metric_sum__tvt__linear_capped__new_visitors__metric_result,
    stddev(metric_sum__tvt__linear_capped__new_visitors__metric_result)::double
    as metric_sum__tvt__linear_capped__new_visitors__metric_stddev,
    avg(metric_sum__tvt__linear_capped__new_visitors__cuped_result)::double
    as metric_sum__tvt__linear_capped__new_visitors__cuped_result,
    stddev(metric_sum__tvt__linear_capped__new_visitors__cuped_result)::double
    as metric_sum__tvt__linear_capped__new_visitors__cuped_stddev,
    avg(metric_sum__tvt__linear_capped__new_visitors__metric_covariate)::double
    as metric_sum__tvt__linear_capped__new_visitors__pre_experiment_metric_result,
    stddev(metric_sum__tvt__linear_capped__new_visitors__metric_covariate)::double
    as metric_sum__tvt__linear_capped__new_visitors__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__vod_capped__new_visitors__metric_result)::double
    as metric_sum__tvt__vod_capped__new_visitors__metric_result,
    stddev(metric_sum__tvt__vod_capped__new_visitors__metric_result)::double
    as metric_sum__tvt__vod_capped__new_visitors__metric_stddev,
    avg(metric_sum__tvt__vod_capped__new_visitors__cuped_result)::double
    as metric_sum__tvt__vod_capped__new_visitors__cuped_result,
    stddev(metric_sum__tvt__vod_capped__new_visitors__cuped_result)::double
    as metric_sum__tvt__vod_capped__new_visitors__cuped_stddev,
    avg(metric_sum__tvt__vod_capped__new_visitors__metric_covariate)::double
    as metric_sum__tvt__vod_capped__new_visitors__pre_experiment_metric_result,
    stddev(metric_sum__tvt__vod_capped__new_visitors__metric_covariate)::double
    as metric_sum__tvt__vod_capped__new_visitors__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__vod_nap_capped__new_visitors__metric_result)::double
    as metric_sum__tvt__vod_nap_capped__new_visitors__metric_result,
    stddev(metric_sum__tvt__vod_nap_capped__new_visitors__metric_result)::double
    as metric_sum__tvt__vod_nap_capped__new_visitors__metric_stddev,
    avg(metric_sum__tvt__vod_nap_capped__new_visitors__cuped_result)::double
    as metric_sum__tvt__vod_nap_capped__new_visitors__cuped_result,
    stddev(metric_sum__tvt__vod_nap_capped__new_visitors__cuped_result)::double
    as metric_sum__tvt__vod_nap_capped__new_visitors__cuped_stddev,
    avg(metric_sum__tvt__vod_nap_capped__new_visitors__metric_covariate)::double
    as metric_sum__tvt__vod_nap_capped__new_visitors__pre_experiment_metric_result,
    stddev(metric_sum__tvt__vod_nap_capped__new_visitors__metric_covariate)::double
    as metric_sum__tvt__vod_nap_capped__new_visitors__pre_experiment_metric_stddev,
    avg(metric_sumgreaterthan__aha_moment_conversion__new_visitors__metric_result)::double
    as metric_sumgreaterthan__aha_moment_conversion__new_visitors__metric_result,
    stddev(metric_sumgreaterthan__aha_moment_conversion__new_visitors__metric_result)::double
    as metric_sumgreaterthan__aha_moment_conversion__new_visitors__metric_stddev,
    avg(metric_sumgreaterthan__aha_moment_conversion__new_visitors__cuped_result)::double
    as metric_sumgreaterthan__aha_moment_conversion__new_visitors__cuped_result,
    stddev(metric_sumgreaterthan__aha_moment_conversion__new_visitors__cuped_result)::double
    as metric_sumgreaterthan__aha_moment_conversion__new_visitors__cuped_stddev,
    avg(metric_sumgreaterthan__aha_moment_conversion__new_visitors__metric_covariate)::double
    as metric_sumgreaterthan__aha_moment_conversion__new_visitors__pre_experiment_metric_result,
    stddev(metric_sumgreaterthan__aha_moment_conversion__new_visitors__metric_covariate)::double
    as metric_sumgreaterthan__aha_moment_conversion__new_visitors__pre_experiment_metric_stddev,
    avg(metric_max__conversion__20min__new_visitors_d1__metric_result)::double
    as metric_max__conversion__20min__new_visitors_d1__metric_result,
    stddev(metric_max__conversion__20min__new_visitors_d1__metric_result)::double
    as metric_max__conversion__20min__new_visitors_d1__metric_stddev,
    avg(metric_max__conversion__20min__new_visitors_d1__cuped_result)::double
    as metric_max__conversion__20min__new_visitors_d1__cuped_result,
    stddev(metric_max__conversion__20min__new_visitors_d1__cuped_result)::double
    as metric_max__conversion__20min__new_visitors_d1__cuped_stddev,
    avg(metric_max__conversion__20min__new_visitors_d1__metric_covariate)::double
    as metric_max__conversion__20min__new_visitors_d1__pre_experiment_metric_result,
    stddev(metric_max__conversion__20min__new_visitors_d1__metric_covariate)::double
    as metric_max__conversion__20min__new_visitors_d1__pre_experiment_metric_stddev,
    avg(metric_max__conversion__5min__new_visitors_d1__metric_result)::double
    as metric_max__conversion__5min__new_visitors_d1__metric_result,
    stddev(metric_max__conversion__5min__new_visitors_d1__metric_result)::double
    as metric_max__conversion__5min__new_visitors_d1__metric_stddev,
    avg(metric_max__conversion__5min__new_visitors_d1__cuped_result)::double
    as metric_max__conversion__5min__new_visitors_d1__cuped_result,
    stddev(metric_max__conversion__5min__new_visitors_d1__cuped_result)::double
    as metric_max__conversion__5min__new_visitors_d1__cuped_stddev,
    avg(metric_max__conversion__5min__new_visitors_d1__metric_covariate)::double
    as metric_max__conversion__5min__new_visitors_d1__pre_experiment_metric_result,
    stddev(metric_max__conversion__5min__new_visitors_d1__metric_covariate)::double
    as metric_max__conversion__5min__new_visitors_d1__pre_experiment_metric_stddev,
    avg(metric_max__conversion__homepage_5min__new_visitors_d1__metric_result)::double
    as metric_max__conversion__homepage_5min__new_visitors_d1__metric_result,
    stddev(metric_max__conversion__homepage_5min__new_visitors_d1__metric_result)::double
    as metric_max__conversion__homepage_5min__new_visitors_d1__metric_stddev,
    avg(metric_max__conversion__homepage_5min__new_visitors_d1__cuped_result)::double
    as metric_max__conversion__homepage_5min__new_visitors_d1__cuped_result,
    stddev(metric_max__conversion__homepage_5min__new_visitors_d1__cuped_result)::double
    as metric_max__conversion__homepage_5min__new_visitors_d1__cuped_stddev,
    avg(metric_max__conversion__homepage_5min__new_visitors_d1__metric_covariate)::double
    as metric_max__conversion__homepage_5min__new_visitors_d1__pre_experiment_metric_result,
    stddev(metric_max__conversion__homepage_5min__new_visitors_d1__metric_covariate)::double
    as metric_max__conversion__homepage_5min__new_visitors_d1__pre_experiment_metric_stddev,
    avg(metric_max__conversion__linear_5min__new_visitors_d1__metric_result)::double
    as metric_max__conversion__linear_5min__new_visitors_d1__metric_result,
    stddev(metric_max__conversion__linear_5min__new_visitors_d1__metric_result)::double
    as metric_max__conversion__linear_5min__new_visitors_d1__metric_stddev,
    avg(metric_max__conversion__linear_5min__new_visitors_d1__cuped_result)::double
    as metric_max__conversion__linear_5min__new_visitors_d1__cuped_result,
    stddev(metric_max__conversion__linear_5min__new_visitors_d1__cuped_result)::double
    as metric_max__conversion__linear_5min__new_visitors_d1__cuped_stddev,
    avg(metric_max__conversion__linear_5min__new_visitors_d1__metric_covariate)::double
    as metric_max__conversion__linear_5min__new_visitors_d1__pre_experiment_metric_result,
    stddev(metric_max__conversion__linear_5min__new_visitors_d1__metric_covariate)::double
    as metric_max__conversion__linear_5min__new_visitors_d1__pre_experiment_metric_stddev,
    avg(metric_max__conversion__movie_5min__new_visitors_d1__metric_result)::double
    as metric_max__conversion__movie_5min__new_visitors_d1__metric_result,
    stddev(metric_max__conversion__movie_5min__new_visitors_d1__metric_result)::double
    as metric_max__conversion__movie_5min__new_visitors_d1__metric_stddev,
    avg(metric_max__conversion__movie_5min__new_visitors_d1__cuped_result)::double
    as metric_max__conversion__movie_5min__new_visitors_d1__cuped_result,
    stddev(metric_max__conversion__movie_5min__new_visitors_d1__cuped_result)::double
    as metric_max__conversion__movie_5min__new_visitors_d1__cuped_stddev,
    avg(metric_max__conversion__movie_5min__new_visitors_d1__metric_covariate)::double
    as metric_max__conversion__movie_5min__new_visitors_d1__pre_experiment_metric_result,
    stddev(metric_max__conversion__movie_5min__new_visitors_d1__metric_covariate)::double
    as metric_max__conversion__movie_5min__new_visitors_d1__pre_experiment_metric_stddev,
    avg(metric_max__conversion__search_5min__new_visitors_d1__metric_result)::double
    as metric_max__conversion__search_5min__new_visitors_d1__metric_result,
    stddev(metric_max__conversion__search_5min__new_visitors_d1__metric_result)::double
    as metric_max__conversion__search_5min__new_visitors_d1__metric_stddev,
    avg(metric_max__conversion__search_5min__new_visitors_d1__cuped_result)::double
    as metric_max__conversion__search_5min__new_visitors_d1__cuped_result,
    stddev(metric_max__conversion__search_5min__new_visitors_d1__cuped_result)::double
    as metric_max__conversion__search_5min__new_visitors_d1__cuped_stddev,
    avg(metric_max__conversion__search_5min__new_visitors_d1__metric_covariate)::double
    as metric_max__conversion__search_5min__new_visitors_d1__pre_experiment_metric_result,
    stddev(metric_max__conversion__search_5min__new_visitors_d1__metric_covariate)::double
    as metric_max__conversion__search_5min__new_visitors_d1__pre_experiment_metric_stddev,
    avg(metric_max__conversion__series_5min__new_visitors_d1__metric_result)::double
    as metric_max__conversion__series_5min__new_visitors_d1__metric_result,
    stddev(metric_max__conversion__series_5min__new_visitors_d1__metric_result)::double
    as metric_max__conversion__series_5min__new_visitors_d1__metric_stddev,
    avg(metric_max__conversion__series_5min__new_visitors_d1__cuped_result)::double
    as metric_max__conversion__series_5min__new_visitors_d1__cuped_result,
    stddev(metric_max__conversion__series_5min__new_visitors_d1__cuped_result)::double
    as metric_max__conversion__series_5min__new_visitors_d1__cuped_stddev,
    avg(metric_max__conversion__series_5min__new_visitors_d1__metric_covariate)::double
    as metric_max__conversion__series_5min__new_visitors_d1__pre_experiment_metric_result,
    stddev(metric_max__conversion__series_5min__new_visitors_d1__metric_covariate)::double
    as metric_max__conversion__series_5min__new_visitors_d1__pre_experiment_metric_stddev,
    avg(metric_max__registration__did_authenticate__new_visitors_d1__metric_result)::double
    as metric_max__registration__did_authenticate__new_visitors_d1__metric_result,
    stddev(metric_max__registration__did_authenticate__new_visitors_d1__metric_result)::double
    as metric_max__registration__did_authenticate__new_visitors_d1__metric_stddev,
    avg(metric_max__registration__did_authenticate__new_visitors_d1__cuped_result)::double
    as metric_max__registration__did_authenticate__new_visitors_d1__cuped_result,
    stddev(metric_max__registration__did_authenticate__new_visitors_d1__cuped_result)::double
    as metric_max__registration__did_authenticate__new_visitors_d1__cuped_stddev,
    avg(metric_max__registration__did_authenticate__new_visitors_d1__metric_covariate)::double
    as metric_max__registration__did_authenticate__new_visitors_d1__pre_experiment_metric_result,
    stddev(metric_max__registration__did_authenticate__new_visitors_d1__metric_covariate)::double
    as metric_max__registration__did_authenticate__new_visitors_d1__pre_experiment_metric_stddev,
    avg(metric_sum__add_to_queue__new_visitors_d1__metric_result)::double
    as metric_sum__add_to_queue__new_visitors_d1__metric_result,
    stddev(metric_sum__add_to_queue__new_visitors_d1__metric_result)::double
    as metric_sum__add_to_queue__new_visitors_d1__metric_stddev,
    avg(metric_sum__add_to_queue__new_visitors_d1__cuped_result)::double
    as metric_sum__add_to_queue__new_visitors_d1__cuped_result,
    stddev(metric_sum__add_to_queue__new_visitors_d1__cuped_result)::double
    as metric_sum__add_to_queue__new_visitors_d1__cuped_stddev,
    avg(metric_sum__add_to_queue__new_visitors_d1__metric_covariate)::double
    as metric_sum__add_to_queue__new_visitors_d1__pre_experiment_metric_result,
    stddev(metric_sum__add_to_queue__new_visitors_d1__metric_covariate)::double
    as metric_sum__add_to_queue__new_visitors_d1__pre_experiment_metric_stddev,
    avg(metric_sum__device_reactions__new_visitors_d1__metric_result)::double
    as metric_sum__device_reactions__new_visitors_d1__metric_result,
    stddev(metric_sum__device_reactions__new_visitors_d1__metric_result)::double
    as metric_sum__device_reactions__new_visitors_d1__metric_stddev,
    avg(metric_sum__device_reactions__new_visitors_d1__cuped_result)::double
    as metric_sum__device_reactions__new_visitors_d1__cuped_result,
    stddev(metric_sum__device_reactions__new_visitors_d1__cuped_result)::double
    as metric_sum__device_reactions__new_visitors_d1__cuped_stddev,
    avg(metric_sum__device_reactions__new_visitors_d1__metric_covariate)::double
    as metric_sum__device_reactions__new_visitors_d1__pre_experiment_metric_result,
    stddev(metric_sum__device_reactions__new_visitors_d1__metric_covariate)::double
    as metric_sum__device_reactions__new_visitors_d1__pre_experiment_metric_stddev,
    avg(metric_sum__revenue__gross__new_visitors_d1__metric_result)::double
    as metric_sum__revenue__gross__new_visitors_d1__metric_result,
    stddev(metric_sum__revenue__gross__new_visitors_d1__metric_result)::double
    as metric_sum__revenue__gross__new_visitors_d1__metric_stddev,
    avg(metric_sum__revenue__gross__new_visitors_d1__cuped_result)::double
    as metric_sum__revenue__gross__new_visitors_d1__cuped_result,
    stddev(metric_sum__revenue__gross__new_visitors_d1__cuped_result)::double
    as metric_sum__revenue__gross__new_visitors_d1__cuped_stddev,
    avg(metric_sum__revenue__gross__new_visitors_d1__metric_covariate)::double
    as metric_sum__revenue__gross__new_visitors_d1__pre_experiment_metric_result,
    stddev(metric_sum__revenue__gross__new_visitors_d1__metric_covariate)::double
    as metric_sum__revenue__gross__new_visitors_d1__pre_experiment_metric_stddev,
    avg(metric_sum__revenue__gross_unbudgeted__new_visitors_d1__metric_result)::double
    as metric_sum__revenue__gross_unbudgeted__new_visitors_d1__metric_result,
    stddev(metric_sum__revenue__gross_unbudgeted__new_visitors_d1__metric_result)::double
    as metric_sum__revenue__gross_unbudgeted__new_visitors_d1__metric_stddev,
    avg(metric_sum__revenue__gross_unbudgeted__new_visitors_d1__cuped_result)::double
    as metric_sum__revenue__gross_unbudgeted__new_visitors_d1__cuped_result,
    stddev(metric_sum__revenue__gross_unbudgeted__new_visitors_d1__cuped_result)::double
    as metric_sum__revenue__gross_unbudgeted__new_visitors_d1__cuped_stddev,
    avg(metric_sum__revenue__gross_unbudgeted__new_visitors_d1__metric_covariate)::double
    as metric_sum__revenue__gross_unbudgeted__new_visitors_d1__pre_experiment_metric_result,
    stddev(metric_sum__revenue__gross_unbudgeted__new_visitors_d1__metric_covariate)::double
    as metric_sum__revenue__gross_unbudgeted__new_visitors_d1__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__capped__new_visitors_d1__metric_result)::double
    as metric_sum__tvt__capped__new_visitors_d1__metric_result,
    stddev(metric_sum__tvt__capped__new_visitors_d1__metric_result)::double
    as metric_sum__tvt__capped__new_visitors_d1__metric_stddev,
    avg(metric_sum__tvt__capped__new_visitors_d1__cuped_result)::double
    as metric_sum__tvt__capped__new_visitors_d1__cuped_result,
    stddev(metric_sum__tvt__capped__new_visitors_d1__cuped_result)::double
    as metric_sum__tvt__capped__new_visitors_d1__cuped_stddev,
    avg(metric_sum__tvt__capped__new_visitors_d1__metric_covariate)::double
    as metric_sum__tvt__capped__new_visitors_d1__pre_experiment_metric_result,
    stddev(metric_sum__tvt__capped__new_visitors_d1__metric_covariate)::double
    as metric_sum__tvt__capped__new_visitors_d1__pre_experiment_metric_stddev,
    avg(metric_max__conversion__new_visitors_d2__metric_result)::double
    as metric_max__conversion__new_visitors_d2__metric_result,
    stddev(metric_max__conversion__new_visitors_d2__metric_result)::double
    as metric_max__conversion__new_visitors_d2__metric_stddev,
    avg(metric_max__conversion__new_visitors_d2__cuped_result)::double
    as metric_max__conversion__new_visitors_d2__cuped_result,
    stddev(metric_max__conversion__new_visitors_d2__cuped_result)::double
    as metric_max__conversion__new_visitors_d2__cuped_stddev,
    avg(metric_max__conversion__new_visitors_d2__metric_covariate)::double
    as metric_max__conversion__new_visitors_d2__pre_experiment_metric_result,
    stddev(metric_max__conversion__new_visitors_d2__metric_covariate)::double
    as metric_max__conversion__new_visitors_d2__pre_experiment_metric_stddev,
    avg(metric_max__conversion__5min__new_visitors_d2__metric_result)::double
    as metric_max__conversion__5min__new_visitors_d2__metric_result,
    stddev(metric_max__conversion__5min__new_visitors_d2__metric_result)::double
    as metric_max__conversion__5min__new_visitors_d2__metric_stddev,
    avg(metric_max__conversion__5min__new_visitors_d2__cuped_result)::double
    as metric_max__conversion__5min__new_visitors_d2__cuped_result,
    stddev(metric_max__conversion__5min__new_visitors_d2__cuped_result)::double
    as metric_max__conversion__5min__new_visitors_d2__cuped_stddev,
    avg(metric_max__conversion__5min__new_visitors_d2__metric_covariate)::double
    as metric_max__conversion__5min__new_visitors_d2__pre_experiment_metric_result,
    stddev(metric_max__conversion__5min__new_visitors_d2__metric_covariate)::double
    as metric_max__conversion__5min__new_visitors_d2__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__capped__new_visitors_d2__metric_result)::double
    as metric_sum__tvt__capped__new_visitors_d2__metric_result,
    stddev(metric_sum__tvt__capped__new_visitors_d2__metric_result)::double
    as metric_sum__tvt__capped__new_visitors_d2__metric_stddev,
    avg(metric_sum__tvt__capped__new_visitors_d2__cuped_result)::double
    as metric_sum__tvt__capped__new_visitors_d2__cuped_result,
    stddev(metric_sum__tvt__capped__new_visitors_d2__cuped_result)::double
    as metric_sum__tvt__capped__new_visitors_d2__cuped_stddev,
    avg(metric_sum__tvt__capped__new_visitors_d2__metric_covariate)::double
    as metric_sum__tvt__capped__new_visitors_d2__pre_experiment_metric_result,
    stddev(metric_sum__tvt__capped__new_visitors_d2__metric_covariate)::double
    as metric_sum__tvt__capped__new_visitors_d2__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__capped_non_us__new_visitors_non_us__metric_result)::double
    as metric_sum__tvt__capped_non_us__new_visitors_non_us__metric_result,
    stddev(metric_sum__tvt__capped_non_us__new_visitors_non_us__metric_result)::double
    as metric_sum__tvt__capped_non_us__new_visitors_non_us__metric_stddev,
    avg(metric_sum__tvt__capped_non_us__new_visitors_non_us__cuped_result)::double
    as metric_sum__tvt__capped_non_us__new_visitors_non_us__cuped_result,
    stddev(metric_sum__tvt__capped_non_us__new_visitors_non_us__cuped_result)::double
    as metric_sum__tvt__capped_non_us__new_visitors_non_us__cuped_stddev,
    avg(metric_sum__tvt__capped_non_us__new_visitors_non_us__metric_covariate)::double
    as metric_sum__tvt__capped_non_us__new_visitors_non_us__pre_experiment_metric_result,
    stddev(metric_sum__tvt__capped_non_us__new_visitors_non_us__metric_covariate)::double
    as metric_sum__tvt__capped_non_us__new_visitors_non_us__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__viewers__metric_result)::double as metric_sum__tvt__viewers__metric_result,
    stddev(metric_sum__tvt__viewers__metric_result)::double as metric_sum__tvt__viewers__metric_stddev,
    avg(metric_sum__tvt__viewers__cuped_result)::double as metric_sum__tvt__viewers__cuped_result,
    stddev(metric_sum__tvt__viewers__cuped_result)::double as metric_sum__tvt__viewers__cuped_stddev,
    avg(metric_sum__tvt__viewers__metric_covariate)::double as metric_sum__tvt__viewers__pre_experiment_metric_result,
    stddev(metric_sum__tvt__viewers__metric_covariate)::double
    as metric_sum__tvt__viewers__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__capped__viewers__metric_result)::double as metric_sum__tvt__capped__viewers__metric_result,
    stddev(metric_sum__tvt__capped__viewers__metric_result)::double as metric_sum__tvt__capped__viewers__metric_stddev,
    avg(metric_sum__tvt__capped__viewers__cuped_result)::double as metric_sum__tvt__capped__viewers__cuped_result,
    stddev(metric_sum__tvt__capped__viewers__cuped_result)::double as metric_sum__tvt__capped__viewers__cuped_stddev,
    avg(metric_sum__tvt__capped__viewers__metric_covariate)::double
    as metric_sum__tvt__capped__viewers__pre_experiment_metric_result,
    stddev(metric_sum__tvt__capped__viewers__metric_covariate)::double
    as metric_sum__tvt__capped__viewers__pre_experiment_metric_stddev,
    avg(metric_sumgreaterthan__retention__viewers__metric_result)::double
    as metric_sumgreaterthan__retention__viewers__metric_result,
    stddev(metric_sumgreaterthan__retention__viewers__metric_result)::double
    as metric_sumgreaterthan__retention__viewers__metric_stddev,
    avg(metric_sumgreaterthan__retention__viewers__cuped_result)::double
    as metric_sumgreaterthan__retention__viewers__cuped_result,
    stddev(metric_sumgreaterthan__retention__viewers__cuped_result)::double
    as metric_sumgreaterthan__retention__viewers__cuped_stddev,
    avg(metric_sumgreaterthan__retention__viewers__metric_covariate)::double
    as metric_sumgreaterthan__retention__viewers__pre_experiment_metric_result,
    stddev(metric_sumgreaterthan__retention__viewers__metric_covariate)::double
    as metric_sumgreaterthan__retention__viewers__pre_experiment_metric_stddev,
    avg(metric_sumgreaterthan__retention__linear__viewers_linear__metric_result)::double
    as metric_sumgreaterthan__retention__linear__viewers_linear__metric_result,
    stddev(metric_sumgreaterthan__retention__linear__viewers_linear__metric_result)::double
    as metric_sumgreaterthan__retention__linear__viewers_linear__metric_stddev,
    avg(metric_sumgreaterthan__retention__linear__viewers_linear__cuped_result)::double
    as metric_sumgreaterthan__retention__linear__viewers_linear__cuped_result,
    stddev(metric_sumgreaterthan__retention__linear__viewers_linear__cuped_result)::double
    as metric_sumgreaterthan__retention__linear__viewers_linear__cuped_stddev,
    avg(metric_sumgreaterthan__retention__linear__viewers_linear__metric_covariate)::double
    as metric_sumgreaterthan__retention__linear__viewers_linear__pre_experiment_metric_result,
    stddev(metric_sumgreaterthan__retention__linear__viewers_linear__metric_covariate)::double
    as metric_sumgreaterthan__retention__linear__viewers_linear__pre_experiment_metric_stddev,
    avg(metric_sum__view__vod_daily_active__viewers_vod__metric_result)::double
    as metric_sum__view__vod_daily_active__viewers_vod__metric_result,
    stddev(metric_sum__view__vod_daily_active__viewers_vod__metric_result)::double
    as metric_sum__view__vod_daily_active__viewers_vod__metric_stddev,
    avg(metric_sum__view__vod_daily_active__viewers_vod__cuped_result)::double
    as metric_sum__view__vod_daily_active__viewers_vod__cuped_result,
    stddev(metric_sum__view__vod_daily_active__viewers_vod__cuped_result)::double
    as metric_sum__view__vod_daily_active__viewers_vod__cuped_stddev,
    avg(metric_sum__view__vod_daily_active__viewers_vod__metric_covariate)::double
    as metric_sum__view__vod_daily_active__viewers_vod__pre_experiment_metric_result,
    stddev(metric_sum__view__vod_daily_active__viewers_vod__metric_covariate)::double
    as metric_sum__view__vod_daily_active__viewers_vod__pre_experiment_metric_stddev,
    avg(metric_sumgreaterthan__retention__vod__viewers_vod__metric_result)::double
    as metric_sumgreaterthan__retention__vod__viewers_vod__metric_result,
    stddev(metric_sumgreaterthan__retention__vod__viewers_vod__metric_result)::double
    as metric_sumgreaterthan__retention__vod__viewers_vod__metric_stddev,
    avg(metric_sumgreaterthan__retention__vod__viewers_vod__cuped_result)::double
    as metric_sumgreaterthan__retention__vod__viewers_vod__cuped_result,
    stddev(metric_sumgreaterthan__retention__vod__viewers_vod__cuped_result)::double
    as metric_sumgreaterthan__retention__vod__viewers_vod__cuped_stddev,
    avg(metric_sumgreaterthan__retention__vod__viewers_vod__metric_covariate)::double
    as metric_sumgreaterthan__retention__vod__viewers_vod__pre_experiment_metric_result,
    stddev(metric_sumgreaterthan__retention__vod__viewers_vod__metric_covariate)::double
    as metric_sumgreaterthan__retention__vod__viewers_vod__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__capped_ca__visitors_ca__metric_result)::double
    as metric_sum__tvt__capped_ca__visitors_ca__metric_result,
    stddev(metric_sum__tvt__capped_ca__visitors_ca__metric_result)::double
    as metric_sum__tvt__capped_ca__visitors_ca__metric_stddev,
    avg(metric_sum__tvt__capped_ca__visitors_ca__cuped_result)::double
    as metric_sum__tvt__capped_ca__visitors_ca__cuped_result,
    stddev(metric_sum__tvt__capped_ca__visitors_ca__cuped_result)::double
    as metric_sum__tvt__capped_ca__visitors_ca__cuped_stddev,
    avg(metric_sum__tvt__capped_ca__visitors_ca__metric_covariate)::double
    as metric_sum__tvt__capped_ca__visitors_ca__pre_experiment_metric_result,
    stddev(metric_sum__tvt__capped_ca__visitors_ca__metric_covariate)::double
    as metric_sum__tvt__capped_ca__visitors_ca__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__capped_mx__visitors_mx__metric_result)::double
    as metric_sum__tvt__capped_mx__visitors_mx__metric_result,
    stddev(metric_sum__tvt__capped_mx__visitors_mx__metric_result)::double
    as metric_sum__tvt__capped_mx__visitors_mx__metric_stddev,
    avg(metric_sum__tvt__capped_mx__visitors_mx__cuped_result)::double
    as metric_sum__tvt__capped_mx__visitors_mx__cuped_result,
    stddev(metric_sum__tvt__capped_mx__visitors_mx__cuped_result)::double
    as metric_sum__tvt__capped_mx__visitors_mx__cuped_stddev,
    avg(metric_sum__tvt__capped_mx__visitors_mx__metric_covariate)::double
    as metric_sum__tvt__capped_mx__visitors_mx__pre_experiment_metric_result,
    stddev(metric_sum__tvt__capped_mx__visitors_mx__metric_covariate)::double
    as metric_sum__tvt__capped_mx__visitors_mx__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__capped_non_us__visitors_non_us__metric_result)::double
    as metric_sum__tvt__capped_non_us__visitors_non_us__metric_result,
    stddev(metric_sum__tvt__capped_non_us__visitors_non_us__metric_result)::double
    as metric_sum__tvt__capped_non_us__visitors_non_us__metric_stddev,
    avg(metric_sum__tvt__capped_non_us__visitors_non_us__cuped_result)::double
    as metric_sum__tvt__capped_non_us__visitors_non_us__cuped_result,
    stddev(metric_sum__tvt__capped_non_us__visitors_non_us__cuped_result)::double
    as metric_sum__tvt__capped_non_us__visitors_non_us__cuped_stddev,
    avg(metric_sum__tvt__capped_non_us__visitors_non_us__metric_covariate)::double
    as metric_sum__tvt__capped_non_us__visitors_non_us__pre_experiment_metric_result,
    stddev(metric_sum__tvt__capped_non_us__visitors_non_us__metric_covariate)::double
    as metric_sum__tvt__capped_non_us__visitors_non_us__pre_experiment_metric_stddev,
    avg(metric_sum__tvt__capped_us__visitors_us__metric_result)::double
    as metric_sum__tvt__capped_us__visitors_us__metric_result,
    stddev(metric_sum__tvt__capped_us__visitors_us__metric_result)::double
    as metric_sum__tvt__capped_us__visitors_us__metric_stddev,
    avg(metric_sum__tvt__capped_us__visitors_us__cuped_result)::double
    as metric_sum__tvt__capped_us__visitors_us__cuped_result,
    stddev(metric_sum__tvt__capped_us__visitors_us__cuped_result)::double
    as metric_sum__tvt__capped_us__visitors_us__cuped_stddev,
    avg(metric_sum__tvt__capped_us__visitors_us__metric_covariate)::double
    as metric_sum__tvt__capped_us__visitors_us__pre_experiment_metric_result,
    stddev(metric_sum__tvt__capped_us__visitors_us__metric_covariate)::double
    as metric_sum__tvt__capped_us__visitors_us__pre_experiment_metric_stddev

-- [[ TABLE: experiment_metrics_wide; CTE: main; LOOP: metrics; END ]]
from combined_cuped_data

group by _id, experiment__name, experiment__parameter_value, platform


